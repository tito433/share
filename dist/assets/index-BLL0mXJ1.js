(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Mf(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Le={},Ei=[],Un=()=>{},t1=()=>!1,Tc=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Of=n=>n.startsWith("onUpdate:"),Mt=Object.assign,Nf=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},n1=Object.prototype.hasOwnProperty,Oe=(n,e)=>n1.call(n,e),pe=Array.isArray,Ti=n=>wc(n)==="[object Map]",J_=n=>wc(n)==="[object Set]",_e=n=>typeof n=="function",tt=n=>typeof n=="string",ps=n=>typeof n=="symbol",je=n=>n!==null&&typeof n=="object",Q_=n=>(je(n)||_e(n))&&_e(n.then)&&_e(n.catch),Y_=Object.prototype.toString,wc=n=>Y_.call(n),r1=n=>wc(n).slice(8,-1),X_=n=>wc(n)==="[object Object]",Df=n=>tt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Ro=Mf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bc=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},s1=/-(\w)/g,vn=bc(n=>n.replace(s1,(e,t)=>t?t.toUpperCase():"")),i1=/\B([A-Z])/g,Gs=bc(n=>n.replace(i1,"-$1").toLowerCase()),Ic=bc(n=>n.charAt(0).toUpperCase()+n.slice(1)),Mu=bc(n=>n?`on${Ic(n)}`:""),jr=(n,e)=>!Object.is(n,e),pl=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Z_=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Ih=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let lm;const Sc=()=>lm||(lm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Vf(n){if(pe(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=tt(r)?c1(r):Vf(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(tt(n)||je(n))return n}const o1=/;(?![^(]*\))/g,a1=/:([^]+)/,l1=/\/\*[^]*?\*\//g;function c1(n){const e={};return n.replace(l1,"").split(o1).forEach(t=>{if(t){const r=t.split(a1);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Ac(n){let e="";if(tt(n))e=n;else if(pe(n))for(let t=0;t<n.length;t++){const r=Ac(n[t]);r&&(e+=r+" ")}else if(je(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const u1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",h1=Mf(u1);function e0(n){return!!n||n===""}const t0=n=>!!(n&&n.__v_isRef===!0),Hr=n=>tt(n)?n:n==null?"":pe(n)||je(n)&&(n.toString===Y_||!_e(n.toString))?t0(n)?Hr(n.value):JSON.stringify(n,n0,2):String(n),n0=(n,e)=>t0(e)?n0(n,e.value):Ti(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[Ou(r,i)+" =>"]=s,t),{})}:J_(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Ou(t))}:ps(e)?Ou(e):je(e)&&!pe(e)&&!X_(e)?String(e):e,Ou=(n,e="")=>{var t;return ps(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wt;class f1{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wt,!e&&Wt&&(this.index=(Wt.scopes||(Wt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Wt;try{return Wt=this,e()}finally{Wt=t}}}on(){++this._on===1&&(this.prevScope=Wt,Wt=this)}off(){this._on>0&&--this._on===0&&(Wt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function d1(){return Wt}let Be;const Nu=new WeakSet;class r0{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wt&&Wt.active&&Wt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Nu.has(this)&&(Nu.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||i0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cm(this),o0(this);const e=Be,t=An;Be=this,An=!0;try{return this.fn()}finally{a0(this),Be=e,An=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Bf(e);this.deps=this.depsTail=void 0,cm(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Nu.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Sh(this)&&this.run()}get dirty(){return Sh(this)}}let s0=0,xo,Po;function i0(n,e=!1){if(n.flags|=8,e){n.next=Po,Po=n;return}n.next=xo,xo=n}function Lf(){s0++}function Ff(){if(--s0>0)return;if(Po){let e=Po;for(Po=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;xo;){let e=xo;for(xo=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function o0(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function a0(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),Bf(r),p1(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function Sh(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(l0(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function l0(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Go)||(n.globalVersion=Go,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Sh(n))))return;n.flags|=2;const e=n.dep,t=Be,r=An;Be=n,An=!0;try{o0(n);const s=n.fn(n._value);(e.version===0||jr(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{Be=t,An=r,a0(n),n.flags&=-3}}function Bf(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Bf(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function p1(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let An=!0;const c0=[];function fr(){c0.push(An),An=!1}function dr(){const n=c0.pop();An=n===void 0?!0:n}function cm(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Be;Be=void 0;try{e()}finally{Be=t}}}let Go=0;class m1{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Cc{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Be||!An||Be===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Be)t=this.activeLink=new m1(Be,this),Be.deps?(t.prevDep=Be.depsTail,Be.depsTail.nextDep=t,Be.depsTail=t):Be.deps=Be.depsTail=t,u0(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Be.depsTail,t.nextDep=void 0,Be.depsTail.nextDep=t,Be.depsTail=t,Be.deps===t&&(Be.deps=r)}return t}trigger(e){this.version++,Go++,this.notify(e)}notify(e){Lf();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Ff()}}}function u0(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)u0(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Ah=new WeakMap,Ms=Symbol(""),Ch=Symbol(""),Jo=Symbol("");function kt(n,e,t){if(An&&Be){let r=Ah.get(n);r||Ah.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new Cc),s.map=r,s.key=t),s.track()}}function sr(n,e,t,r,s,i){const o=Ah.get(n);if(!o){Go++;return}const a=l=>{l&&l.trigger()};if(Lf(),e==="clear")o.forEach(a);else{const l=pe(n),c=l&&Df(t);if(l&&t==="length"){const h=Number(r);o.forEach((f,d)=>{(d==="length"||d===Jo||!ps(d)&&d>=h)&&a(f)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(Jo)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Ms)),Ti(n)&&a(o.get(Ch)));break;case"delete":l||(a(o.get(Ms)),Ti(n)&&a(o.get(Ch)));break;case"set":Ti(n)&&a(o.get(Ms));break}}Ff()}function ii(n){const e=Me(n);return e===n?e:(kt(e,"iterate",Jo),yn(n)?e:e.map(mt))}function kc(n){return kt(n=Me(n),"iterate",Jo),n}const g1={__proto__:null,[Symbol.iterator](){return Du(this,Symbol.iterator,mt)},concat(...n){return ii(this).concat(...n.map(e=>pe(e)?ii(e):e))},entries(){return Du(this,"entries",n=>(n[1]=mt(n[1]),n))},every(n,e){return Zn(this,"every",n,e,void 0,arguments)},filter(n,e){return Zn(this,"filter",n,e,t=>t.map(mt),arguments)},find(n,e){return Zn(this,"find",n,e,mt,arguments)},findIndex(n,e){return Zn(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Zn(this,"findLast",n,e,mt,arguments)},findLastIndex(n,e){return Zn(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Zn(this,"forEach",n,e,void 0,arguments)},includes(...n){return Vu(this,"includes",n)},indexOf(...n){return Vu(this,"indexOf",n)},join(n){return ii(this).join(n)},lastIndexOf(...n){return Vu(this,"lastIndexOf",n)},map(n,e){return Zn(this,"map",n,e,void 0,arguments)},pop(){return yo(this,"pop")},push(...n){return yo(this,"push",n)},reduce(n,...e){return um(this,"reduce",n,e)},reduceRight(n,...e){return um(this,"reduceRight",n,e)},shift(){return yo(this,"shift")},some(n,e){return Zn(this,"some",n,e,void 0,arguments)},splice(...n){return yo(this,"splice",n)},toReversed(){return ii(this).toReversed()},toSorted(n){return ii(this).toSorted(n)},toSpliced(...n){return ii(this).toSpliced(...n)},unshift(...n){return yo(this,"unshift",n)},values(){return Du(this,"values",mt)}};function Du(n,e,t){const r=kc(n),s=r[e]();return r!==n&&!yn(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const y1=Array.prototype;function Zn(n,e,t,r,s,i){const o=kc(n),a=o!==n&&!yn(n),l=o[e];if(l!==y1[e]){const f=l.apply(n,i);return a?mt(f):f}let c=t;o!==n&&(a?c=function(f,d){return t.call(this,mt(f),d,n)}:t.length>2&&(c=function(f,d){return t.call(this,f,d,n)}));const h=l.call(o,c,r);return a&&s?s(h):h}function um(n,e,t,r){const s=kc(n);let i=t;return s!==n&&(yn(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,mt(a),l,n)}),s[e](i,...r)}function Vu(n,e,t){const r=Me(n);kt(r,"iterate",Jo);const s=r[e](...t);return(s===-1||s===!1)&&zf(t[0])?(t[0]=Me(t[0]),r[e](...t)):s}function yo(n,e,t=[]){fr(),Lf();const r=Me(n)[e].apply(n,t);return Ff(),dr(),r}const _1=Mf("__proto__,__v_isRef,__isVue"),h0=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(ps));function v1(n){ps(n)||(n=String(n));const e=Me(this);return kt(e,"has",n),e.hasOwnProperty(n)}class f0{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?R1:g0:i?m0:p0).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=pe(e);if(!s){let l;if(o&&(l=g1[t]))return l;if(t==="hasOwnProperty")return v1}const a=Reflect.get(e,t,Pt(e)?e:r);return(ps(t)?h0.has(t):_1(t))||(s||kt(e,"get",t),i)?a:Pt(a)?o&&Df(t)?a:a.value:je(a)?s?_0(a):Rc(a):a}}class d0 extends f0{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=ns(i);if(!yn(r)&&!ns(r)&&(i=Me(i),r=Me(r)),!pe(e)&&Pt(i)&&!Pt(r))return l?!1:(i.value=r,!0)}const o=pe(e)&&Df(t)?Number(t)<e.length:Oe(e,t),a=Reflect.set(e,t,r,Pt(e)?e:s);return e===Me(s)&&(o?jr(r,i)&&sr(e,"set",t,r):sr(e,"add",t,r)),a}deleteProperty(e,t){const r=Oe(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&sr(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!ps(t)||!h0.has(t))&&kt(e,"has",t),r}ownKeys(e){return kt(e,"iterate",pe(e)?"length":Ms),Reflect.ownKeys(e)}}class E1 extends f0{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const T1=new d0,w1=new E1,b1=new d0(!0);const kh=n=>n,Xa=n=>Reflect.getPrototypeOf(n);function I1(n,e,t){return function(...r){const s=this.__v_raw,i=Me(s),o=Ti(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),h=t?kh:e?Ol:mt;return!e&&kt(i,"iterate",l?Ch:Ms),{next(){const{value:f,done:d}=c.next();return d?{value:f,done:d}:{value:a?[h(f[0]),h(f[1])]:h(f),done:d}},[Symbol.iterator](){return this}}}}function Za(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function S1(n,e){const t={get(s){const i=this.__v_raw,o=Me(i),a=Me(s);n||(jr(s,a)&&kt(o,"get",s),kt(o,"get",a));const{has:l}=Xa(o),c=e?kh:n?Ol:mt;if(l.call(o,s))return c(i.get(s));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&kt(Me(s),"iterate",Ms),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=Me(i),a=Me(s);return n||(jr(s,a)&&kt(o,"has",s),kt(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=Me(a),c=e?kh:n?Ol:mt;return!n&&kt(l,"iterate",Ms),a.forEach((h,f)=>s.call(i,c(h),c(f),o))}};return Mt(t,n?{add:Za("add"),set:Za("set"),delete:Za("delete"),clear:Za("clear")}:{add(s){!e&&!yn(s)&&!ns(s)&&(s=Me(s));const i=Me(this);return Xa(i).has.call(i,s)||(i.add(s),sr(i,"add",s,s)),this},set(s,i){!e&&!yn(i)&&!ns(i)&&(i=Me(i));const o=Me(this),{has:a,get:l}=Xa(o);let c=a.call(o,s);c||(s=Me(s),c=a.call(o,s));const h=l.call(o,s);return o.set(s,i),c?jr(i,h)&&sr(o,"set",s,i):sr(o,"add",s,i),this},delete(s){const i=Me(this),{has:o,get:a}=Xa(i);let l=o.call(i,s);l||(s=Me(s),l=o.call(i,s)),a&&a.call(i,s);const c=i.delete(s);return l&&sr(i,"delete",s,void 0),c},clear(){const s=Me(this),i=s.size!==0,o=s.clear();return i&&sr(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=I1(s,n,e)}),t}function Uf(n,e){const t=S1(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(Oe(t,s)&&s in r?t:r,s,i)}const A1={get:Uf(!1,!1)},C1={get:Uf(!1,!0)},k1={get:Uf(!0,!1)};const p0=new WeakMap,m0=new WeakMap,g0=new WeakMap,R1=new WeakMap;function x1(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function P1(n){return n.__v_skip||!Object.isExtensible(n)?0:x1(r1(n))}function Rc(n){return ns(n)?n:$f(n,!1,T1,A1,p0)}function y0(n){return $f(n,!1,b1,C1,m0)}function _0(n){return $f(n,!0,w1,k1,g0)}function $f(n,e,t,r,s){if(!je(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=P1(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function wi(n){return ns(n)?wi(n.__v_raw):!!(n&&n.__v_isReactive)}function ns(n){return!!(n&&n.__v_isReadonly)}function yn(n){return!!(n&&n.__v_isShallow)}function zf(n){return n?!!n.__v_raw:!1}function Me(n){const e=n&&n.__v_raw;return e?Me(e):n}function v0(n){return!Oe(n,"__v_skip")&&Object.isExtensible(n)&&Z_(n,"__v_skip",!0),n}const mt=n=>je(n)?Rc(n):n,Ol=n=>je(n)?_0(n):n;function Pt(n){return n?n.__v_isRef===!0:!1}function Qt(n){return T0(n,!1)}function E0(n){return T0(n,!0)}function T0(n,e){return Pt(n)?n:new M1(n,e)}class M1{constructor(e,t){this.dep=new Cc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Me(e),this._value=t?e:mt(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||yn(e)||ns(e);e=r?e:Me(e),jr(e,t)&&(this._rawValue=e,this._value=r?e:mt(e),this.dep.trigger())}}function $n(n){return Pt(n)?n.value:n}const O1={get:(n,e,t)=>e==="__v_raw"?n:$n(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return Pt(s)&&!Pt(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function w0(n){return wi(n)?n:new Proxy(n,O1)}class N1{constructor(e){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new Cc,{get:r,set:s}=e(t.track.bind(t),t.trigger.bind(t));this._get=r,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}}function D1(n){return new N1(n)}class V1{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Cc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Go-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Be!==this)return i0(this,!0),!0}get value(){const e=this.dep.track();return l0(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function L1(n,e,t=!1){let r,s;return _e(n)?r=n:(r=n.get,s=n.set),new V1(r,s,t)}const el={},Nl=new WeakMap;let Is;function F1(n,e=!1,t=Is){if(t){let r=Nl.get(t);r||Nl.set(t,r=[]),r.push(n)}}function B1(n,e,t=Le){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,c=U=>s?U:yn(U)||s===!1||s===0?ir(U,1):ir(U);let h,f,d,m,y=!1,_=!1;if(Pt(n)?(f=()=>n.value,y=yn(n)):wi(n)?(f=()=>c(n),y=!0):pe(n)?(_=!0,y=n.some(U=>wi(U)||yn(U)),f=()=>n.map(U=>{if(Pt(U))return U.value;if(wi(U))return c(U);if(_e(U))return l?l(U,2):U()})):_e(n)?e?f=l?()=>l(n,2):n:f=()=>{if(d){fr();try{d()}finally{dr()}}const U=Is;Is=h;try{return l?l(n,3,[m]):n(m)}finally{Is=U}}:f=Un,e&&s){const U=f,X=s===!0?1/0:s;f=()=>ir(U(),X)}const E=d1(),k=()=>{h.stop(),E&&E.active&&Nf(E.effects,h)};if(i&&e){const U=e;e=(...X)=>{U(...X),k()}}let O=_?new Array(n.length).fill(el):el;const D=U=>{if(!(!(h.flags&1)||!h.dirty&&!U))if(e){const X=h.run();if(s||y||(_?X.some((Z,A)=>jr(Z,O[A])):jr(X,O))){d&&d();const Z=Is;Is=h;try{const A=[X,O===el?void 0:_&&O[0]===el?[]:O,m];O=X,l?l(e,3,A):e(...A)}finally{Is=Z}}}else h.run()};return a&&a(D),h=new r0(f),h.scheduler=o?()=>o(D,!1):D,m=U=>F1(U,!1,h),d=h.onStop=()=>{const U=Nl.get(h);if(U){if(l)l(U,4);else for(const X of U)X();Nl.delete(h)}},e?r?D(!0):O=h.run():o?o(D.bind(null,!0),!0):h.run(),k.pause=h.pause.bind(h),k.resume=h.resume.bind(h),k.stop=k,k}function ir(n,e=1/0,t){if(e<=0||!je(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Pt(n))ir(n.value,e,t);else if(pe(n))for(let r=0;r<n.length;r++)ir(n[r],e,t);else if(J_(n)||Ti(n))n.forEach(r=>{ir(r,e,t)});else if(X_(n)){for(const r in n)ir(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&ir(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ea(n,e,t,r){try{return r?n(...r):n()}catch(s){xc(s,e,t)}}function Wn(n,e,t,r){if(_e(n)){const s=Ea(n,e,t,r);return s&&Q_(s)&&s.catch(i=>{xc(i,e,t)}),s}if(pe(n)){const s=[];for(let i=0;i<n.length;i++)s.push(Wn(n[i],e,t,r));return s}}function xc(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Le;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const h=a.ec;if(h){for(let f=0;f<h.length;f++)if(h[f](n,l,c)===!1)return}a=a.parent}if(i){fr(),Ea(i,null,10,[n,l,c]),dr();return}}U1(n,t,s,r,o)}function U1(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const Ft=[];let Dn=-1;const bi=[];let Rr=null,li=0;const b0=Promise.resolve();let Dl=null;function jf(n){const e=Dl||b0;return n?e.then(this?n.bind(this):n):e}function $1(n){let e=Dn+1,t=Ft.length;for(;e<t;){const r=e+t>>>1,s=Ft[r],i=Qo(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function Hf(n){if(!(n.flags&1)){const e=Qo(n),t=Ft[Ft.length-1];!t||!(n.flags&2)&&e>=Qo(t)?Ft.push(n):Ft.splice($1(e),0,n),n.flags|=1,I0()}}function I0(){Dl||(Dl=b0.then(A0))}function z1(n){pe(n)?bi.push(...n):Rr&&n.id===-1?Rr.splice(li+1,0,n):n.flags&1||(bi.push(n),n.flags|=1),I0()}function hm(n,e,t=Dn+1){for(;t<Ft.length;t++){const r=Ft[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Ft.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function S0(n){if(bi.length){const e=[...new Set(bi)].sort((t,r)=>Qo(t)-Qo(r));if(bi.length=0,Rr){Rr.push(...e);return}for(Rr=e,li=0;li<Rr.length;li++){const t=Rr[li];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Rr=null,li=0}}const Qo=n=>n.id==null?n.flags&2?-1:1/0:n.id;function A0(n){try{for(Dn=0;Dn<Ft.length;Dn++){const e=Ft[Dn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ea(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Dn<Ft.length;Dn++){const e=Ft[Dn];e&&(e.flags&=-2)}Dn=-1,Ft.length=0,S0(),Dl=null,(Ft.length||bi.length)&&A0()}}let Yt=null,C0=null;function Vl(n){const e=Yt;return Yt=n,C0=n&&n.type.__scopeId||null,e}function Pi(n,e=Yt,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&wm(-1);const i=Vl(e);let o;try{o=n(...s)}finally{Vl(i),r._d&&wm(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function fm(n,e){if(Yt===null)return n;const t=Lc(Yt),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Le]=e[s];i&&(_e(i)&&(i={mounted:i,updated:i}),i.deep&&ir(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function ws(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(fr(),Wn(l,t,8,[n.el,a,n,e]),dr())}}const j1=Symbol("_vte"),H1=n=>n.__isTeleport;function qf(n,e){n.shapeFlag&6&&n.component?(n.transition=e,qf(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Pc(n,e){return _e(n)?Mt({name:n.name},e,{setup:n}):n}function k0(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Ll(n,e,t,r,s=!1){if(pe(n)){n.forEach((y,_)=>Ll(y,e&&(pe(e)?e[_]:e),t,r,s));return}if(Mo(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Ll(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?Lc(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,h=a.refs===Le?a.refs={}:a.refs,f=a.setupState,d=Me(f),m=f===Le?()=>!1:y=>Oe(d,y);if(c!=null&&c!==l&&(tt(c)?(h[c]=null,m(c)&&(f[c]=null)):Pt(c)&&(c.value=null)),_e(l))Ea(l,a,12,[o,h]);else{const y=tt(l),_=Pt(l);if(y||_){const E=()=>{if(n.f){const k=y?m(l)?f[l]:h[l]:l.value;s?pe(k)&&Nf(k,i):pe(k)?k.includes(i)||k.push(i):y?(h[l]=[i],m(l)&&(f[l]=h[l])):(l.value=[i],n.k&&(h[n.k]=l.value))}else y?(h[l]=o,m(l)&&(f[l]=o)):_&&(l.value=o,n.k&&(h[n.k]=o))};o?(E.id=-1,rn(E,t)):E()}}}Sc().requestIdleCallback;Sc().cancelIdleCallback;const Mo=n=>!!n.type.__asyncLoader,R0=n=>n.type.__isKeepAlive;function q1(n,e){x0(n,"a",e)}function W1(n,e){x0(n,"da",e)}function x0(n,e,t=_t){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Mc(e,r,t),t){let s=t.parent;for(;s&&s.parent;)R0(s.parent.vnode)&&K1(r,e,t,s),s=s.parent}}function K1(n,e,t,r){const s=Mc(e,n,r,!0);P0(()=>{Nf(r[e],s)},t)}function Mc(n,e,t=_t,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{fr();const a=wa(t),l=Wn(e,t,n,o);return a(),dr(),l});return r?s.unshift(i):s.push(i),i}}const vr=n=>(e,t=_t)=>{(!Xo||n==="sp")&&Mc(n,(...r)=>e(...r),t)},G1=vr("bm"),Oc=vr("m"),J1=vr("bu"),Q1=vr("u"),Nc=vr("bum"),P0=vr("um"),Y1=vr("sp"),X1=vr("rtg"),Z1=vr("rtc");function eI(n,e=_t){Mc("ec",n,e)}const tI="components";function Ta(n,e){return rI(tI,n,!0,e)||n}const nI=Symbol.for("v-ndc");function rI(n,e,t=!0,r=!1){const s=Yt||_t;if(s){const i=s.type;{const a=qI(i,!1);if(a&&(a===e||a===vn(e)||a===Ic(vn(e))))return i}const o=dm(s[n]||i[n],e)||dm(s.appContext[n],e);return!o&&r?i:o}}function dm(n,e){return n&&(n[e]||n[vn(e)]||n[Ic(vn(e))])}function Rh(n,e,t,r){let s;const i=t,o=pe(n);if(o||tt(n)){const a=o&&wi(n);let l=!1,c=!1;a&&(l=!yn(n),c=ns(n),n=kc(n)),s=new Array(n.length);for(let h=0,f=n.length;h<f;h++)s[h]=e(l?c?Ol(mt(n[h])):mt(n[h]):n[h],h,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i)}else if(je(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=e(n[h],h,l,i)}}else s=[];return s}const xh=n=>n?Y0(n)?Lc(n):xh(n.parent):null,Oo=Mt(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>xh(n.parent),$root:n=>xh(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>O0(n),$forceUpdate:n=>n.f||(n.f=()=>{Hf(n.update)}),$nextTick:n=>n.n||(n.n=jf.bind(n.proxy)),$watch:n=>SI.bind(n)}),Lu=(n,e)=>n!==Le&&!n.__isScriptSetup&&Oe(n,e),sI={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Lu(r,e))return o[e]=1,r[e];if(s!==Le&&Oe(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&Oe(c,e))return o[e]=3,i[e];if(t!==Le&&Oe(t,e))return o[e]=4,t[e];Ph&&(o[e]=0)}}const h=Oo[e];let f,d;if(h)return e==="$attrs"&&kt(n.attrs,"get",""),h(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==Le&&Oe(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,Oe(d,e))return d[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Lu(s,e)?(s[e]=t,!0):r!==Le&&Oe(r,e)?(r[e]=t,!0):Oe(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==Le&&Oe(n,o)||Lu(e,o)||(a=i[0])&&Oe(a,o)||Oe(r,o)||Oe(Oo,o)||Oe(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Oe(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function pm(n){return pe(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Ph=!0;function iI(n){const e=O0(n),t=n.proxy,r=n.ctx;Ph=!1,e.beforeCreate&&mm(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:f,mounted:d,beforeUpdate:m,updated:y,activated:_,deactivated:E,beforeDestroy:k,beforeUnmount:O,destroyed:D,unmounted:U,render:X,renderTracked:Z,renderTriggered:A,errorCaptured:T,serverPrefetch:w,expose:C,inheritAttrs:R,components:P,directives:S,filters:Dt}=e;if(c&&oI(c,r,null),o)for(const Ae in o){const be=o[Ae];_e(be)&&(r[Ae]=be.bind(t))}if(s){const Ae=s.call(t,t);je(Ae)&&(n.data=Rc(Ae))}if(Ph=!0,i)for(const Ae in i){const be=i[Ae],tn=_e(be)?be.bind(t,t):_e(be.get)?be.get.bind(t,t):Un,En=!_e(be)&&_e(be.set)?be.set.bind(t):Un,un=Jt({get:tn,set:En});Object.defineProperty(r,Ae,{enumerable:!0,configurable:!0,get:()=>un.value,set:He=>un.value=He})}if(a)for(const Ae in a)M0(a[Ae],r,t,Ae);if(l){const Ae=_e(l)?l.call(t):l;Reflect.ownKeys(Ae).forEach(be=>{ml(be,Ae[be])})}h&&mm(h,n,"c");function Ye(Ae,be){pe(be)?be.forEach(tn=>Ae(tn.bind(t))):be&&Ae(be.bind(t))}if(Ye(G1,f),Ye(Oc,d),Ye(J1,m),Ye(Q1,y),Ye(q1,_),Ye(W1,E),Ye(eI,T),Ye(Z1,Z),Ye(X1,A),Ye(Nc,O),Ye(P0,U),Ye(Y1,w),pe(C))if(C.length){const Ae=n.exposed||(n.exposed={});C.forEach(be=>{Object.defineProperty(Ae,be,{get:()=>t[be],set:tn=>t[be]=tn})})}else n.exposed||(n.exposed={});X&&n.render===Un&&(n.render=X),R!=null&&(n.inheritAttrs=R),P&&(n.components=P),S&&(n.directives=S),w&&k0(n)}function oI(n,e,t=Un){pe(n)&&(n=Mh(n));for(const r in n){const s=n[r];let i;je(s)?"default"in s?i=Cn(s.from||r,s.default,!0):i=Cn(s.from||r):i=Cn(s),Pt(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function mm(n,e,t){Wn(pe(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function M0(n,e,t,r){let s=r.includes(".")?q0(t,r):()=>t[r];if(tt(n)){const i=e[n];_e(i)&&No(s,i)}else if(_e(n))No(s,n.bind(t));else if(je(n))if(pe(n))n.forEach(i=>M0(i,e,t,r));else{const i=_e(n.handler)?n.handler.bind(t):e[n.handler];_e(i)&&No(s,i,n)}}function O0(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>Fl(l,c,o,!0)),Fl(l,e,o)),je(e)&&i.set(e,l),l}function Fl(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Fl(n,i,t,!0),s&&s.forEach(o=>Fl(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=aI[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const aI={data:gm,props:ym,emits:ym,methods:To,computed:To,beforeCreate:Lt,created:Lt,beforeMount:Lt,mounted:Lt,beforeUpdate:Lt,updated:Lt,beforeDestroy:Lt,beforeUnmount:Lt,destroyed:Lt,unmounted:Lt,activated:Lt,deactivated:Lt,errorCaptured:Lt,serverPrefetch:Lt,components:To,directives:To,watch:cI,provide:gm,inject:lI};function gm(n,e){return e?n?function(){return Mt(_e(n)?n.call(this,this):n,_e(e)?e.call(this,this):e)}:e:n}function lI(n,e){return To(Mh(n),Mh(e))}function Mh(n){if(pe(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Lt(n,e){return n?[...new Set([].concat(n,e))]:e}function To(n,e){return n?Mt(Object.create(null),n,e):e}function ym(n,e){return n?pe(n)&&pe(e)?[...new Set([...n,...e])]:Mt(Object.create(null),pm(n),pm(e??{})):e}function cI(n,e){if(!n)return e;if(!e)return n;const t=Mt(Object.create(null),n);for(const r in e)t[r]=Lt(n[r],e[r]);return t}function N0(){return{app:null,config:{isNativeTag:t1,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uI=0;function hI(n,e){return function(r,s=null){_e(r)||(r=Mt({},r)),s!=null&&!je(s)&&(s=null);const i=N0(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:uI++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:KI,get config(){return i.config},set config(h){},use(h,...f){return o.has(h)||(h&&_e(h.install)?(o.add(h),h.install(c,...f)):_e(h)&&(o.add(h),h(c,...f))),c},mixin(h){return i.mixins.includes(h)||i.mixins.push(h),c},component(h,f){return f?(i.components[h]=f,c):i.components[h]},directive(h,f){return f?(i.directives[h]=f,c):i.directives[h]},mount(h,f,d){if(!l){const m=c._ceVNode||We(r,s);return m.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),n(m,h,d),l=!0,c._container=h,h.__vue_app__=c,Lc(m.component)}},onUnmount(h){a.push(h)},unmount(){l&&(Wn(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(h,f){return i.provides[h]=f,c},runWithContext(h){const f=Ii;Ii=c;try{return h()}finally{Ii=f}}};return c}}let Ii=null;function ml(n,e){if(_t){let t=_t.provides;const r=_t.parent&&_t.parent.provides;r===t&&(t=_t.provides=Object.create(r)),t[n]=e}}function Cn(n,e,t=!1){const r=_t||Yt;if(r||Ii){let s=Ii?Ii._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&_e(e)?e.call(r&&r.proxy):e}}const D0={},V0=()=>Object.create(D0),L0=n=>Object.getPrototypeOf(n)===D0;function fI(n,e,t,r=!1){const s={},i=V0();n.propsDefaults=Object.create(null),F0(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:y0(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function dI(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=Me(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let f=0;f<h.length;f++){let d=h[f];if(Dc(n.emitsOptions,d))continue;const m=e[d];if(l)if(Oe(i,d))m!==i[d]&&(i[d]=m,c=!0);else{const y=vn(d);s[y]=Oh(l,a,y,m,n,!1)}else m!==i[d]&&(i[d]=m,c=!0)}}}else{F0(n,e,s,i)&&(c=!0);let h;for(const f in a)(!e||!Oe(e,f)&&((h=Gs(f))===f||!Oe(e,h)))&&(l?t&&(t[f]!==void 0||t[h]!==void 0)&&(s[f]=Oh(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!Oe(e,f))&&(delete i[f],c=!0)}c&&sr(n.attrs,"set","")}function F0(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Ro(l))continue;const c=e[l];let h;s&&Oe(s,h=vn(l))?!i||!i.includes(h)?t[h]=c:(a||(a={}))[h]=c:Dc(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=Me(t),c=a||Le;for(let h=0;h<i.length;h++){const f=i[h];t[f]=Oh(s,l,f,c[f],n,!Oe(c,f))}}return o}function Oh(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=Oe(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&_e(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const h=wa(s);r=c[t]=l.call(null,e),h()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Gs(t))&&(r=!0))}return r}const pI=new WeakMap;function B0(n,e,t=!1){const r=t?pI:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!_e(n)){const h=f=>{l=!0;const[d,m]=B0(f,e,!0);Mt(o,d),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!i&&!l)return je(n)&&r.set(n,Ei),Ei;if(pe(i))for(let h=0;h<i.length;h++){const f=vn(i[h]);_m(f)&&(o[f]=Le)}else if(i)for(const h in i){const f=vn(h);if(_m(f)){const d=i[h],m=o[f]=pe(d)||_e(d)?{type:d}:Mt({},d),y=m.type;let _=!1,E=!0;if(pe(y))for(let k=0;k<y.length;++k){const O=y[k],D=_e(O)&&O.name;if(D==="Boolean"){_=!0;break}else D==="String"&&(E=!1)}else _=_e(y)&&y.name==="Boolean";m[0]=_,m[1]=E,(_||Oe(m,"default"))&&a.push(f)}}const c=[o,a];return je(n)&&r.set(n,c),c}function _m(n){return n[0]!=="$"&&!Ro(n)}const Wf=n=>n[0]==="_"||n==="$stable",Kf=n=>pe(n)?n.map(Fn):[Fn(n)],mI=(n,e,t)=>{if(e._n)return e;const r=Pi((...s)=>Kf(e(...s)),t);return r._c=!1,r},U0=(n,e,t)=>{const r=n._ctx;for(const s in n){if(Wf(s))continue;const i=n[s];if(_e(i))e[s]=mI(s,i,r);else if(i!=null){const o=Kf(i);e[s]=()=>o}}},$0=(n,e)=>{const t=Kf(e);n.slots.default=()=>t},z0=(n,e,t)=>{for(const r in e)(t||!Wf(r))&&(n[r]=e[r])},gI=(n,e,t)=>{const r=n.slots=V0();if(n.vnode.shapeFlag&32){const s=e._;s?(z0(r,e,t),t&&Z_(r,"_",s,!0)):U0(e,r)}else e&&$0(n,e)},yI=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=Le;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:z0(s,e,t):(i=!e.$stable,U0(e,s)),o=e}else e&&($0(n,e),o={default:1});if(i)for(const a in s)!Wf(a)&&o[a]==null&&delete s[a]},rn=MI;function _I(n){return vI(n)}function vI(n,e){const t=Sc();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:f,nextSibling:d,setScopeId:m=Un,insertStaticContent:y}=n,_=(b,I,x,L=null,$=null,F=null,J=void 0,W=null,q=!!I.dynamicChildren)=>{if(b===I)return;b&&!_o(b,I)&&(L=V(b),He(b,$,F,!0),b=null),I.patchFlag===-2&&(q=!1,I.dynamicChildren=null);const{type:H,ref:oe,shapeFlag:G}=I;switch(H){case Vc:E(b,I,x,L);break;case rs:k(b,I,x,L);break;case Bu:b==null&&O(I,x,L,J);break;case Gt:P(b,I,x,L,$,F,J,W,q);break;default:G&1?X(b,I,x,L,$,F,J,W,q):G&6?S(b,I,x,L,$,F,J,W,q):(G&64||G&128)&&H.process(b,I,x,L,$,F,J,W,q,se)}oe!=null&&$&&Ll(oe,b&&b.ref,F,I||b,!I)},E=(b,I,x,L)=>{if(b==null)r(I.el=a(I.children),x,L);else{const $=I.el=b.el;I.children!==b.children&&c($,I.children)}},k=(b,I,x,L)=>{b==null?r(I.el=l(I.children||""),x,L):I.el=b.el},O=(b,I,x,L)=>{[b.el,b.anchor]=y(b.children,I,x,L,b.el,b.anchor)},D=({el:b,anchor:I},x,L)=>{let $;for(;b&&b!==I;)$=d(b),r(b,x,L),b=$;r(I,x,L)},U=({el:b,anchor:I})=>{let x;for(;b&&b!==I;)x=d(b),s(b),b=x;s(I)},X=(b,I,x,L,$,F,J,W,q)=>{I.type==="svg"?J="svg":I.type==="math"&&(J="mathml"),b==null?Z(I,x,L,$,F,J,W,q):w(b,I,$,F,J,W,q)},Z=(b,I,x,L,$,F,J,W)=>{let q,H;const{props:oe,shapeFlag:G,transition:ie,dirs:he}=b;if(q=b.el=o(b.type,F,oe&&oe.is,oe),G&8?h(q,b.children):G&16&&T(b.children,q,null,L,$,Fu(b,F),J,W),he&&ws(b,null,L,"created"),A(q,b,b.scopeId,J,L),oe){for(const ve in oe)ve!=="value"&&!Ro(ve)&&i(q,ve,null,oe[ve],F,L);"value"in oe&&i(q,"value",null,oe.value,F),(H=oe.onVnodeBeforeMount)&&Nn(H,L,b)}he&&ws(b,null,L,"beforeMount");const ce=EI($,ie);ce&&ie.beforeEnter(q),r(q,I,x),((H=oe&&oe.onVnodeMounted)||ce||he)&&rn(()=>{H&&Nn(H,L,b),ce&&ie.enter(q),he&&ws(b,null,L,"mounted")},$)},A=(b,I,x,L,$)=>{if(x&&m(b,x),L)for(let F=0;F<L.length;F++)m(b,L[F]);if($){let F=$.subTree;if(I===F||K0(F.type)&&(F.ssContent===I||F.ssFallback===I)){const J=$.vnode;A(b,J,J.scopeId,J.slotScopeIds,$.parent)}}},T=(b,I,x,L,$,F,J,W,q=0)=>{for(let H=q;H<b.length;H++){const oe=b[H]=W?xr(b[H]):Fn(b[H]);_(null,oe,I,x,L,$,F,J,W)}},w=(b,I,x,L,$,F,J)=>{const W=I.el=b.el;let{patchFlag:q,dynamicChildren:H,dirs:oe}=I;q|=b.patchFlag&16;const G=b.props||Le,ie=I.props||Le;let he;if(x&&bs(x,!1),(he=ie.onVnodeBeforeUpdate)&&Nn(he,x,I,b),oe&&ws(I,b,x,"beforeUpdate"),x&&bs(x,!0),(G.innerHTML&&ie.innerHTML==null||G.textContent&&ie.textContent==null)&&h(W,""),H?C(b.dynamicChildren,H,W,x,L,Fu(I,$),F):J||be(b,I,W,null,x,L,Fu(I,$),F,!1),q>0){if(q&16)R(W,G,ie,x,$);else if(q&2&&G.class!==ie.class&&i(W,"class",null,ie.class,$),q&4&&i(W,"style",G.style,ie.style,$),q&8){const ce=I.dynamicProps;for(let ve=0;ve<ce.length;ve++){const Ce=ce[ve],Tt=G[Ce],ut=ie[Ce];(ut!==Tt||Ce==="value")&&i(W,Ce,Tt,ut,$,x)}}q&1&&b.children!==I.children&&h(W,I.children)}else!J&&H==null&&R(W,G,ie,x,$);((he=ie.onVnodeUpdated)||oe)&&rn(()=>{he&&Nn(he,x,I,b),oe&&ws(I,b,x,"updated")},L)},C=(b,I,x,L,$,F,J)=>{for(let W=0;W<I.length;W++){const q=b[W],H=I[W],oe=q.el&&(q.type===Gt||!_o(q,H)||q.shapeFlag&198)?f(q.el):x;_(q,H,oe,null,L,$,F,J,!0)}},R=(b,I,x,L,$)=>{if(I!==x){if(I!==Le)for(const F in I)!Ro(F)&&!(F in x)&&i(b,F,I[F],null,$,L);for(const F in x){if(Ro(F))continue;const J=x[F],W=I[F];J!==W&&F!=="value"&&i(b,F,W,J,$,L)}"value"in x&&i(b,"value",I.value,x.value,$)}},P=(b,I,x,L,$,F,J,W,q)=>{const H=I.el=b?b.el:a(""),oe=I.anchor=b?b.anchor:a("");let{patchFlag:G,dynamicChildren:ie,slotScopeIds:he}=I;he&&(W=W?W.concat(he):he),b==null?(r(H,x,L),r(oe,x,L),T(I.children||[],x,oe,$,F,J,W,q)):G>0&&G&64&&ie&&b.dynamicChildren?(C(b.dynamicChildren,ie,x,$,F,J,W),(I.key!=null||$&&I===$.subTree)&&j0(b,I,!0)):be(b,I,x,oe,$,F,J,W,q)},S=(b,I,x,L,$,F,J,W,q)=>{I.slotScopeIds=W,b==null?I.shapeFlag&512?$.ctx.activate(I,x,L,J,q):Dt(I,x,L,$,F,J,q):cn(b,I,q)},Dt=(b,I,x,L,$,F,J)=>{const W=b.component=BI(b,L,$);if(R0(b)&&(W.ctx.renderer=se),$I(W,!1,J),W.asyncDep){if($&&$.registerDep(W,Ye,J),!b.el){const q=W.subTree=We(rs);k(null,q,I,x)}}else Ye(W,b,I,x,$,F,J)},cn=(b,I,x)=>{const L=I.component=b.component;if(xI(b,I,x))if(L.asyncDep&&!L.asyncResolved){Ae(L,I,x);return}else L.next=I,L.update();else I.el=b.el,L.vnode=I},Ye=(b,I,x,L,$,F,J)=>{const W=()=>{if(b.isMounted){let{next:G,bu:ie,u:he,parent:ce,vnode:ve}=b;{const wt=H0(b);if(wt){G&&(G.el=ve.el,Ae(b,G,J)),wt.asyncDep.then(()=>{b.isUnmounted||W()});return}}let Ce=G,Tt;bs(b,!1),G?(G.el=ve.el,Ae(b,G,J)):G=ve,ie&&pl(ie),(Tt=G.props&&G.props.onVnodeBeforeUpdate)&&Nn(Tt,ce,G,ve),bs(b,!0);const ut=Em(b),hn=b.subTree;b.subTree=ut,_(hn,ut,f(hn.el),V(hn),b,$,F),G.el=ut.el,Ce===null&&PI(b,ut.el),he&&rn(he,$),(Tt=G.props&&G.props.onVnodeUpdated)&&rn(()=>Nn(Tt,ce,G,ve),$)}else{let G;const{el:ie,props:he}=I,{bm:ce,m:ve,parent:Ce,root:Tt,type:ut}=b,hn=Mo(I);bs(b,!1),ce&&pl(ce),!hn&&(G=he&&he.onVnodeBeforeMount)&&Nn(G,Ce,I),bs(b,!0);{Tt.ce&&Tt.ce._injectChildStyle(ut);const wt=b.subTree=Em(b);_(null,wt,x,L,b,$,F),I.el=wt.el}if(ve&&rn(ve,$),!hn&&(G=he&&he.onVnodeMounted)){const wt=I;rn(()=>Nn(G,Ce,wt),$)}(I.shapeFlag&256||Ce&&Mo(Ce.vnode)&&Ce.vnode.shapeFlag&256)&&b.a&&rn(b.a,$),b.isMounted=!0,I=x=L=null}};b.scope.on();const q=b.effect=new r0(W);b.scope.off();const H=b.update=q.run.bind(q),oe=b.job=q.runIfDirty.bind(q);oe.i=b,oe.id=b.uid,q.scheduler=()=>Hf(oe),bs(b,!0),H()},Ae=(b,I,x)=>{I.component=b;const L=b.vnode.props;b.vnode=I,b.next=null,dI(b,I.props,L,x),yI(b,I.children,x),fr(),hm(b),dr()},be=(b,I,x,L,$,F,J,W,q=!1)=>{const H=b&&b.children,oe=b?b.shapeFlag:0,G=I.children,{patchFlag:ie,shapeFlag:he}=I;if(ie>0){if(ie&128){En(H,G,x,L,$,F,J,W,q);return}else if(ie&256){tn(H,G,x,L,$,F,J,W,q);return}}he&8?(oe&16&&qt(H,$,F),G!==H&&h(x,G)):oe&16?he&16?En(H,G,x,L,$,F,J,W,q):qt(H,$,F,!0):(oe&8&&h(x,""),he&16&&T(G,x,L,$,F,J,W,q))},tn=(b,I,x,L,$,F,J,W,q)=>{b=b||Ei,I=I||Ei;const H=b.length,oe=I.length,G=Math.min(H,oe);let ie;for(ie=0;ie<G;ie++){const he=I[ie]=q?xr(I[ie]):Fn(I[ie]);_(b[ie],he,x,null,$,F,J,W,q)}H>oe?qt(b,$,F,!0,!1,G):T(I,x,L,$,F,J,W,q,G)},En=(b,I,x,L,$,F,J,W,q)=>{let H=0;const oe=I.length;let G=b.length-1,ie=oe-1;for(;H<=G&&H<=ie;){const he=b[H],ce=I[H]=q?xr(I[H]):Fn(I[H]);if(_o(he,ce))_(he,ce,x,null,$,F,J,W,q);else break;H++}for(;H<=G&&H<=ie;){const he=b[G],ce=I[ie]=q?xr(I[ie]):Fn(I[ie]);if(_o(he,ce))_(he,ce,x,null,$,F,J,W,q);else break;G--,ie--}if(H>G){if(H<=ie){const he=ie+1,ce=he<oe?I[he].el:L;for(;H<=ie;)_(null,I[H]=q?xr(I[H]):Fn(I[H]),x,ce,$,F,J,W,q),H++}}else if(H>ie)for(;H<=G;)He(b[H],$,F,!0),H++;else{const he=H,ce=H,ve=new Map;for(H=ce;H<=ie;H++){const ht=I[H]=q?xr(I[H]):Fn(I[H]);ht.key!=null&&ve.set(ht.key,H)}let Ce,Tt=0;const ut=ie-ce+1;let hn=!1,wt=0;const wr=new Array(ut);for(H=0;H<ut;H++)wr[H]=0;for(H=he;H<=G;H++){const ht=b[H];if(Tt>=ut){He(ht,$,F,!0);continue}let fn;if(ht.key!=null)fn=ve.get(ht.key);else for(Ce=ce;Ce<=ie;Ce++)if(wr[Ce-ce]===0&&_o(ht,I[Ce])){fn=Ce;break}fn===void 0?He(ht,$,F,!0):(wr[fn-ce]=H+1,fn>=wt?wt=fn:hn=!0,_(ht,I[fn],x,null,$,F,J,W,q),Tt++)}const ro=hn?TI(wr):Ei;for(Ce=ro.length-1,H=ut-1;H>=0;H--){const ht=ce+H,fn=I[ht],Va=ht+1<oe?I[ht+1].el:L;wr[H]===0?_(null,fn,x,Va,$,F,J,W,q):hn&&(Ce<0||H!==ro[Ce]?un(fn,x,Va,2):Ce--)}}},un=(b,I,x,L,$=null)=>{const{el:F,type:J,transition:W,children:q,shapeFlag:H}=b;if(H&6){un(b.component.subTree,I,x,L);return}if(H&128){b.suspense.move(I,x,L);return}if(H&64){J.move(b,I,x,se);return}if(J===Gt){r(F,I,x);for(let G=0;G<q.length;G++)un(q[G],I,x,L);r(b.anchor,I,x);return}if(J===Bu){D(b,I,x);return}if(L!==2&&H&1&&W)if(L===0)W.beforeEnter(F),r(F,I,x),rn(()=>W.enter(F),$);else{const{leave:G,delayLeave:ie,afterLeave:he}=W,ce=()=>{b.ctx.isUnmounted?s(F):r(F,I,x)},ve=()=>{G(F,()=>{ce(),he&&he()})};ie?ie(F,ce,ve):ve()}else r(F,I,x)},He=(b,I,x,L=!1,$=!1)=>{const{type:F,props:J,ref:W,children:q,dynamicChildren:H,shapeFlag:oe,patchFlag:G,dirs:ie,cacheIndex:he}=b;if(G===-2&&($=!1),W!=null&&(fr(),Ll(W,null,x,b,!0),dr()),he!=null&&(I.renderCache[he]=void 0),oe&256){I.ctx.deactivate(b);return}const ce=oe&1&&ie,ve=!Mo(b);let Ce;if(ve&&(Ce=J&&J.onVnodeBeforeUnmount)&&Nn(Ce,I,b),oe&6)On(b.component,x,L);else{if(oe&128){b.suspense.unmount(x,L);return}ce&&ws(b,null,I,"beforeUnmount"),oe&64?b.type.remove(b,I,x,se,L):H&&!H.hasOnce&&(F!==Gt||G>0&&G&64)?qt(H,I,x,!1,!0):(F===Gt&&G&384||!$&&oe&16)&&qt(q,I,x),L&&qe(b)}(ve&&(Ce=J&&J.onVnodeUnmounted)||ce)&&rn(()=>{Ce&&Nn(Ce,I,b),ce&&ws(b,null,I,"unmounted")},x)},qe=b=>{const{type:I,el:x,anchor:L,transition:$}=b;if(I===Gt){Tr(x,L);return}if(I===Bu){U(b);return}const F=()=>{s(x),$&&!$.persisted&&$.afterLeave&&$.afterLeave()};if(b.shapeFlag&1&&$&&!$.persisted){const{leave:J,delayLeave:W}=$,q=()=>J(x,F);W?W(b.el,F,q):q()}else F()},Tr=(b,I)=>{let x;for(;b!==I;)x=d(b),s(b),b=x;s(I)},On=(b,I,x)=>{const{bum:L,scope:$,job:F,subTree:J,um:W,m:q,a:H,parent:oe,slots:{__:G}}=b;vm(q),vm(H),L&&pl(L),oe&&pe(G)&&G.forEach(ie=>{oe.renderCache[ie]=void 0}),$.stop(),F&&(F.flags|=8,He(J,b,I,x)),W&&rn(W,I),rn(()=>{b.isUnmounted=!0},I),I&&I.pendingBranch&&!I.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===I.pendingId&&(I.deps--,I.deps===0&&I.resolve())},qt=(b,I,x,L=!1,$=!1,F=0)=>{for(let J=F;J<b.length;J++)He(b[J],I,x,L,$)},V=b=>{if(b.shapeFlag&6)return V(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const I=d(b.anchor||b.el),x=I&&I[j1];return x?d(x):I};let ee=!1;const Q=(b,I,x)=>{b==null?I._vnode&&He(I._vnode,null,null,!0):_(I._vnode||null,b,I,null,null,null,x),I._vnode=b,ee||(ee=!0,hm(),S0(),ee=!1)},se={p:_,um:He,m:un,r:qe,mt:Dt,mc:T,pc:be,pbc:C,n:V,o:n};return{render:Q,hydrate:void 0,createApp:hI(Q)}}function Fu({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function bs({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function EI(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function j0(n,e,t=!1){const r=n.children,s=e.children;if(pe(r)&&pe(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=xr(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&j0(o,a)),a.type===Vc&&(a.el=o.el),a.type===rs&&!a.el&&(a.el=o.el)}}function TI(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function H0(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:H0(e)}function vm(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const wI=Symbol.for("v-scx"),bI=()=>Cn(wI);function II(n,e){return Gf(n,null,e)}function No(n,e,t){return Gf(n,e,t)}function Gf(n,e,t=Le){const{immediate:r,deep:s,flush:i,once:o}=t,a=Mt({},t),l=e&&r||!e&&i!=="post";let c;if(Xo){if(i==="sync"){const m=bI();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=Un,m.resume=Un,m.pause=Un,m}}const h=_t;a.call=(m,y,_)=>Wn(m,h,y,_);let f=!1;i==="post"?a.scheduler=m=>{rn(m,h&&h.suspense)}:i!=="sync"&&(f=!0,a.scheduler=(m,y)=>{y?m():Hf(m)}),a.augmentJob=m=>{e&&(m.flags|=4),f&&(m.flags|=2,h&&(m.id=h.uid,m.i=h))};const d=B1(n,e,a);return Xo&&(c?c.push(d):l&&d()),d}function SI(n,e,t){const r=this.proxy,s=tt(n)?n.includes(".")?q0(r,n):()=>r[n]:n.bind(r,r);let i;_e(e)?i=e:(i=e.handler,t=e);const o=wa(this),a=Gf(s,i.bind(r),t);return o(),a}function q0(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const AI=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${vn(e)}Modifiers`]||n[`${Gs(e)}Modifiers`];function CI(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Le;let s=t;const i=e.startsWith("update:"),o=i&&AI(r,e.slice(7));o&&(o.trim&&(s=t.map(h=>tt(h)?h.trim():h)),o.number&&(s=t.map(Ih)));let a,l=r[a=Mu(e)]||r[a=Mu(vn(e))];!l&&i&&(l=r[a=Mu(Gs(e))]),l&&Wn(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Wn(c,n,6,s)}}function W0(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!_e(n)){const l=c=>{const h=W0(c,e,!0);h&&(a=!0,Mt(o,h))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(je(n)&&r.set(n,null),null):(pe(i)?i.forEach(l=>o[l]=null):Mt(o,i),je(n)&&r.set(n,o),o)}function Dc(n,e){return!n||!Tc(e)?!1:(e=e.slice(2).replace(/Once$/,""),Oe(n,e[0].toLowerCase()+e.slice(1))||Oe(n,Gs(e))||Oe(n,e))}function Em(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:f,data:d,setupState:m,ctx:y,inheritAttrs:_}=n,E=Vl(n);let k,O;try{if(t.shapeFlag&4){const U=s||r,X=U;k=Fn(c.call(X,U,h,f,m,d,y)),O=a}else{const U=e;k=Fn(U.length>1?U(f,{attrs:a,slots:o,emit:l}):U(f,null)),O=e.props?a:kI(a)}}catch(U){Do.length=0,xc(U,n,1),k=We(rs)}let D=k;if(O&&_!==!1){const U=Object.keys(O),{shapeFlag:X}=D;U.length&&X&7&&(i&&U.some(Of)&&(O=RI(O,i)),D=Mi(D,O,!1,!0))}return t.dirs&&(D=Mi(D,null,!1,!0),D.dirs=D.dirs?D.dirs.concat(t.dirs):t.dirs),t.transition&&qf(D,t.transition),k=D,Vl(E),k}const kI=n=>{let e;for(const t in n)(t==="class"||t==="style"||Tc(t))&&((e||(e={}))[t]=n[t]);return e},RI=(n,e)=>{const t={};for(const r in n)(!Of(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function xI(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?Tm(r,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let f=0;f<h.length;f++){const d=h[f];if(o[d]!==r[d]&&!Dc(c,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Tm(r,o,c):!0:!!o;return!1}function Tm(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Dc(t,i))return!0}return!1}function PI({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const K0=n=>n.__isSuspense;function MI(n,e){e&&e.pendingBranch?pe(n)?e.effects.push(...n):e.effects.push(n):z1(n)}const Gt=Symbol.for("v-fgt"),Vc=Symbol.for("v-txt"),rs=Symbol.for("v-cmt"),Bu=Symbol.for("v-stc"),Do=[];let on=null;function De(n=!1){Do.push(on=n?null:[])}function OI(){Do.pop(),on=Do[Do.length-1]||null}let Yo=1;function wm(n,e=!1){Yo+=n,n<0&&on&&e&&(on.hasOnce=!0)}function G0(n){return n.dynamicChildren=Yo>0?on||Ei:null,OI(),Yo>0&&on&&on.push(n),n}function ze(n,e,t,r,s,i){return G0(fe(n,e,t,r,s,i,!0))}function Jf(n,e,t,r,s){return G0(We(n,e,t,r,s,!0))}function Bl(n){return n?n.__v_isVNode===!0:!1}function _o(n,e){return n.type===e.type&&n.key===e.key}const J0=({key:n})=>n??null,gl=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?tt(n)||Pt(n)||_e(n)?{i:Yt,r:n,k:e,f:!!t}:n:null);function fe(n,e=null,t=null,r=0,s=null,i=n===Gt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&J0(e),ref:e&&gl(e),scopeId:C0,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Yt};return a?(Qf(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=tt(t)?8:16),Yo>0&&!o&&on&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&on.push(l),l}const We=NI;function NI(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===nI)&&(n=rs),Bl(n)){const a=Mi(n,e,!0);return t&&Qf(a,t),Yo>0&&!i&&on&&(a.shapeFlag&6?on[on.indexOf(n)]=a:on.push(a)),a.patchFlag=-2,a}if(WI(n)&&(n=n.__vccOpts),e){e=DI(e);let{class:a,style:l}=e;a&&!tt(a)&&(e.class=Ac(a)),je(l)&&(zf(l)&&!pe(l)&&(l=Mt({},l)),e.style=Vf(l))}const o=tt(n)?1:K0(n)?128:H1(n)?64:je(n)?4:_e(n)?2:0;return fe(n,e,t,r,s,o,i,!0)}function DI(n){return n?zf(n)||L0(n)?Mt({},n):n:null}function Mi(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?VI(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&J0(c),ref:e&&e.ref?t&&i?pe(i)?i.concat(gl(e)):[i,gl(e)]:gl(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Gt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Mi(n.ssContent),ssFallback:n.ssFallback&&Mi(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&qf(h,l.clone(h)),h}function kn(n=" ",e=0){return We(Vc,null,n,e)}function Q0(n="",e=!1){return e?(De(),Jf(rs,null,n)):We(rs,null,n)}function Fn(n){return n==null||typeof n=="boolean"?We(rs):pe(n)?We(Gt,null,n.slice()):Bl(n)?xr(n):We(Vc,null,String(n))}function xr(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Mi(n)}function Qf(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(pe(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Qf(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!L0(e)?e._ctx=Yt:s===3&&Yt&&(Yt.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else _e(e)?(e={default:e,_ctx:Yt},t=32):(e=String(e),r&64?(t=16,e=[kn(e)]):t=8);n.children=e,n.shapeFlag|=t}function VI(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Ac([e.class,r.class]));else if(s==="style")e.style=Vf([e.style,r.style]);else if(Tc(s)){const i=e[s],o=r[s];o&&i!==o&&!(pe(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Nn(n,e,t,r=null){Wn(n,e,7,[t,r])}const LI=N0();let FI=0;function BI(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||LI,i={uid:FI++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new f1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:B0(r,s),emitsOptions:W0(r,s),emit:null,emitted:null,propsDefaults:Le,inheritAttrs:r.inheritAttrs,ctx:Le,data:Le,props:Le,attrs:Le,slots:Le,refs:Le,setupState:Le,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=CI.bind(null,i),n.ce&&n.ce(i),i}let _t=null;const UI=()=>_t||Yt;let Ul,Nh;{const n=Sc(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Ul=e("__VUE_INSTANCE_SETTERS__",t=>_t=t),Nh=e("__VUE_SSR_SETTERS__",t=>Xo=t)}const wa=n=>{const e=_t;return Ul(n),n.scope.on(),()=>{n.scope.off(),Ul(e)}},bm=()=>{_t&&_t.scope.off(),Ul(null)};function Y0(n){return n.vnode.shapeFlag&4}let Xo=!1;function $I(n,e=!1,t=!1){e&&Nh(e);const{props:r,children:s}=n.vnode,i=Y0(n);fI(n,r,i,e),gI(n,s,t||e);const o=i?zI(n,e):void 0;return e&&Nh(!1),o}function zI(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,sI);const{setup:r}=t;if(r){fr();const s=n.setupContext=r.length>1?HI(n):null,i=wa(n),o=Ea(r,n,0,[n.props,s]),a=Q_(o);if(dr(),i(),(a||n.sp)&&!Mo(n)&&k0(n),a){if(o.then(bm,bm),e)return o.then(l=>{Im(n,l)}).catch(l=>{xc(l,n,0)});n.asyncDep=o}else Im(n,o)}else X0(n)}function Im(n,e,t){_e(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:je(e)&&(n.setupState=w0(e)),X0(n)}function X0(n,e,t){const r=n.type;n.render||(n.render=r.render||Un);{const s=wa(n);fr();try{iI(n)}finally{dr(),s()}}}const jI={get(n,e){return kt(n,"get",""),n[e]}};function HI(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,jI),slots:n.slots,emit:n.emit,expose:e}}function Lc(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(w0(v0(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Oo)return Oo[t](n)},has(e,t){return t in e||t in Oo}})):n.proxy}function qI(n,e=!0){return _e(n)?n.displayName||n.name:n.name||e&&n.__name}function WI(n){return _e(n)&&"__vccOpts"in n}const Jt=(n,e)=>L1(n,e,Xo);function Yf(n,e,t){const r=arguments.length;return r===2?je(e)&&!pe(e)?Bl(e)?We(n,null,[e]):We(n,e):We(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Bl(t)&&(t=[t]),We(n,e,t))}const KI="3.5.16";/**
* @vue/runtime-dom v3.5.16
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Dh;const Sm=typeof window<"u"&&window.trustedTypes;if(Sm)try{Dh=Sm.createPolicy("vue",{createHTML:n=>n})}catch{}const Z0=Dh?n=>Dh.createHTML(n):n=>n,GI="http://www.w3.org/2000/svg",JI="http://www.w3.org/1998/Math/MathML",nr=typeof document<"u"?document:null,Am=nr&&nr.createElement("template"),QI={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?nr.createElementNS(GI,n):e==="mathml"?nr.createElementNS(JI,n):t?nr.createElement(n,{is:t}):nr.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>nr.createTextNode(n),createComment:n=>nr.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>nr.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{Am.innerHTML=Z0(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=Am.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},YI=Symbol("_vtc");function XI(n,e,t){const r=n[YI];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Cm=Symbol("_vod"),ZI=Symbol("_vsh"),eS=Symbol(""),tS=/(^|;)\s*display\s*:/;function nS(n,e,t){const r=n.style,s=tt(t);let i=!1;if(t&&!s){if(e)if(tt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&yl(r,a,"")}else for(const o in e)t[o]==null&&yl(r,o,"");for(const o in t)o==="display"&&(i=!0),yl(r,o,t[o])}else if(s){if(e!==t){const o=r[eS];o&&(t+=";"+o),r.cssText=t,i=tS.test(t)}}else e&&n.removeAttribute("style");Cm in n&&(n[Cm]=i?r.display:"",n[ZI]&&(r.display="none"))}const km=/\s*!important$/;function yl(n,e,t){if(pe(t))t.forEach(r=>yl(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=rS(n,e);km.test(t)?n.setProperty(Gs(r),t.replace(km,""),"important"):n[r]=t}}const Rm=["Webkit","Moz","ms"],Uu={};function rS(n,e){const t=Uu[e];if(t)return t;let r=vn(e);if(r!=="filter"&&r in n)return Uu[e]=r;r=Ic(r);for(let s=0;s<Rm.length;s++){const i=Rm[s]+r;if(i in n)return Uu[e]=i}return e}const xm="http://www.w3.org/1999/xlink";function Pm(n,e,t,r,s,i=h1(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(xm,e.slice(6,e.length)):n.setAttributeNS(xm,e,t):t==null||i&&!e0(t)?n.removeAttribute(e):n.setAttribute(e,i?"":ps(t)?String(t):t)}function Mm(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?Z0(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=e0(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function ci(n,e,t,r){n.addEventListener(e,t,r)}function sS(n,e,t,r){n.removeEventListener(e,t,r)}const Om=Symbol("_vei");function iS(n,e,t,r,s=null){const i=n[Om]||(n[Om]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=oS(e);if(r){const c=i[e]=cS(r,s);ci(n,a,c,l)}else o&&(sS(n,a,o,l),i[e]=void 0)}}const Nm=/(?:Once|Passive|Capture)$/;function oS(n){let e;if(Nm.test(n)){e={};let r;for(;r=n.match(Nm);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Gs(n.slice(2)),e]}let $u=0;const aS=Promise.resolve(),lS=()=>$u||(aS.then(()=>$u=0),$u=Date.now());function cS(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Wn(uS(r,t.value),e,5,[r])};return t.value=n,t.attached=lS(),t}function uS(n,e){if(pe(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Dm=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,hS=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?XI(n,r,o):e==="style"?nS(n,t,r):Tc(e)?Of(e)||iS(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):fS(n,e,r,o))?(Mm(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Pm(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!tt(r))?Mm(n,vn(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Pm(n,e,r,o))};function fS(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Dm(e)&&_e(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Dm(e)&&tt(t)?!1:e in n}const Vm=n=>{const e=n.props["onUpdate:modelValue"]||!1;return pe(e)?t=>pl(e,t):e};function dS(n){n.target.composing=!0}function Lm(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const zu=Symbol("_assign"),Fm={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[zu]=Vm(s);const i=r||s.props&&s.props.type==="number";ci(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=Ih(a)),n[zu](a)}),t&&ci(n,"change",()=>{n.value=n.value.trim()}),e||(ci(n,"compositionstart",dS),ci(n,"compositionend",Lm),ci(n,"change",Lm))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[zu]=Vm(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?Ih(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},pS=["ctrl","shift","alt","meta"],mS={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>pS.some(t=>n[`${t}Key`]&&!e.includes(t))},Bm=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=mS[e[o]];if(a&&a(s,e))return}return n(s,...i)})},gS=Mt({patchProp:hS},QI);let Um;function yS(){return Um||(Um=_I(gS))}const _S=(...n)=>{const e=yS().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=ES(r);if(!s)return;const i=e._component;!_e(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,vS(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function vS(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function ES(n){return tt(n)?document.querySelector(n):n}const Mn=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},TS={};function wS(n,e){const t=Ta("router-view");return De(),Jf(t)}const bS=Mn(TS,[["render",wS]]);/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const ui=typeof document<"u";function ev(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function IS(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&ev(n.default)}const Pe=Object.assign;function ju(n,e){const t={};for(const r in e){const s=e[r];t[r]=Rn(s)?s.map(n):n(s)}return t}const Vo=()=>{},Rn=Array.isArray,tv=/#/g,SS=/&/g,AS=/\//g,CS=/=/g,kS=/\?/g,nv=/\+/g,RS=/%5B/g,xS=/%5D/g,rv=/%5E/g,PS=/%60/g,sv=/%7B/g,MS=/%7C/g,iv=/%7D/g,OS=/%20/g;function Xf(n){return encodeURI(""+n).replace(MS,"|").replace(RS,"[").replace(xS,"]")}function NS(n){return Xf(n).replace(sv,"{").replace(iv,"}").replace(rv,"^")}function Vh(n){return Xf(n).replace(nv,"%2B").replace(OS,"+").replace(tv,"%23").replace(SS,"%26").replace(PS,"`").replace(sv,"{").replace(iv,"}").replace(rv,"^")}function DS(n){return Vh(n).replace(CS,"%3D")}function VS(n){return Xf(n).replace(tv,"%23").replace(kS,"%3F")}function LS(n){return n==null?"":VS(n).replace(AS,"%2F")}function Zo(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const FS=/\/$/,BS=n=>n.replace(FS,"");function Hu(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=jS(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Zo(o)}}function US(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function $m(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function $S(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&Oi(e.matched[r],t.matched[s])&&ov(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Oi(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function ov(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!zS(n[t],e[t]))return!1;return!0}function zS(n,e){return Rn(n)?zm(n,e):Rn(e)?zm(e,n):n===e}function zm(n,e){return Rn(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function jS(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const Ar={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ea;(function(n){n.pop="pop",n.push="push"})(ea||(ea={}));var Lo;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Lo||(Lo={}));function HS(n){if(!n)if(ui){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),BS(n)}const qS=/^[^#]+#/;function WS(n,e){return n.replace(qS,"#")+e}function KS(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Fc=()=>({left:window.scrollX,top:window.scrollY});function GS(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=KS(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function jm(n,e){return(history.state?history.state.position-e:-1)+n}const Lh=new Map;function JS(n,e){Lh.set(n,e)}function QS(n){const e=Lh.get(n);return Lh.delete(n),e}let YS=()=>location.protocol+"//"+location.host;function av(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),$m(l,"")}return $m(t,n)+r+s}function XS(n,e,t,r){let s=[],i=[],o=null;const a=({state:d})=>{const m=av(n,location),y=t.value,_=e.value;let E=0;if(d){if(t.value=m,e.value=d,o&&o===y){o=null;return}E=_?d.position-_.position:0}else r(m);s.forEach(k=>{k(t.value,y,{delta:E,type:ea.pop,direction:E?E>0?Lo.forward:Lo.back:Lo.unknown})})};function l(){o=t.value}function c(d){s.push(d);const m=()=>{const y=s.indexOf(d);y>-1&&s.splice(y,1)};return i.push(m),m}function h(){const{history:d}=window;d.state&&d.replaceState(Pe({},d.state,{scroll:Fc()}),"")}function f(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function Hm(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?Fc():null}}function ZS(n){const{history:e,location:t}=window,r={value:av(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,h){const f=n.indexOf("#"),d=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:YS()+n+l;try{e[h?"replaceState":"pushState"](c,"",d),s.value=c}catch(m){console.error(m),t[h?"replace":"assign"](d)}}function o(l,c){const h=Pe({},e.state,Hm(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,h,!0),r.value=l}function a(l,c){const h=Pe({},s.value,e.state,{forward:l,scroll:Fc()});i(h.current,h,!0);const f=Pe({},Hm(r.value,l,null),{position:h.position+1},c);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function eA(n){n=HS(n);const e=ZS(n),t=XS(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=Pe({location:"",base:n,go:r,createHref:WS.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function tA(n){return typeof n=="string"||n&&typeof n=="object"}function lv(n){return typeof n=="string"||typeof n=="symbol"}const cv=Symbol("");var qm;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(qm||(qm={}));function Ni(n,e){return Pe(new Error,{type:n,[cv]:!0},e)}function er(n,e){return n instanceof Error&&cv in n&&(e==null||!!(n.type&e))}const Wm="[^/]+?",nA={sensitive:!1,strict:!1,start:!0,end:!0},rA=/[.+*?^${}()[\]/\\]/g;function sA(n,e){const t=Pe({},nA,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const h=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const d=c[f];let m=40+(t.sensitive?.25:0);if(d.type===0)f||(s+="/"),s+=d.value.replace(rA,"\\$&"),m+=40;else if(d.type===1){const{value:y,repeatable:_,optional:E,regexp:k}=d;i.push({name:y,repeatable:_,optional:E});const O=k||Wm;if(O!==Wm){m+=10;try{new RegExp(`(${O})`)}catch(U){throw new Error(`Invalid custom RegExp for param "${y}" (${O}): `+U.message)}}let D=_?`((?:${O})(?:/(?:${O}))*)`:`(${O})`;f||(D=E&&c.length<2?`(?:/${D})`:"/"+D),E&&(D+="?"),s+=D,m+=20,E&&(m+=-8),_&&(m+=-20),O===".*"&&(m+=-50)}h.push(m)}r.push(h)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const h=c.match(o),f={};if(!h)return null;for(let d=1;d<h.length;d++){const m=h[d]||"",y=i[d-1];f[y.name]=m&&y.repeatable?m.split("/"):m}return f}function l(c){let h="",f=!1;for(const d of n){(!f||!h.endsWith("/"))&&(h+="/"),f=!1;for(const m of d)if(m.type===0)h+=m.value;else if(m.type===1){const{value:y,repeatable:_,optional:E}=m,k=y in c?c[y]:"";if(Rn(k)&&!_)throw new Error(`Provided param "${y}" is an array but it is not repeatable (* or + modifiers)`);const O=Rn(k)?k.join("/"):k;if(!O)if(E)d.length<2&&(h.endsWith("/")?h=h.slice(0,-1):f=!0);else throw new Error(`Missing required param "${y}"`);h+=O}}return h||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function iA(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function uv(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=iA(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(Km(r))return 1;if(Km(s))return-1}return s.length-r.length}function Km(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const oA={type:0,value:""},aA=/[a-zA-Z0-9_]/;function lA(n){if(!n)return[[]];if(n==="/")return[[oA]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(m){throw new Error(`ERR (${t})/"${c}": ${m}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",h="";function f(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&f(),o()):l===":"?(f(),t=1):d();break;case 4:d(),t=r;break;case 1:l==="("?t=2:aA.test(l)?d():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:t=3:h+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,h="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),s}function cA(n,e,t){const r=sA(lA(n.path),t),s=Pe(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function uA(n,e){const t=[],r=new Map;e=Ym({strict:!1,end:!0,sensitive:!1},e);function s(f){return r.get(f)}function i(f,d,m){const y=!m,_=Jm(f);_.aliasOf=m&&m.record;const E=Ym(e,f),k=[_];if("alias"in f){const U=typeof f.alias=="string"?[f.alias]:f.alias;for(const X of U)k.push(Jm(Pe({},_,{components:m?m.record.components:_.components,path:X,aliasOf:m?m.record:_})))}let O,D;for(const U of k){const{path:X}=U;if(d&&X[0]!=="/"){const Z=d.record.path,A=Z[Z.length-1]==="/"?"":"/";U.path=d.record.path+(X&&A+X)}if(O=cA(U,d,E),m?m.alias.push(O):(D=D||O,D!==O&&D.alias.push(O),y&&f.name&&!Qm(O)&&o(f.name)),hv(O)&&l(O),_.children){const Z=_.children;for(let A=0;A<Z.length;A++)i(Z[A],O,m&&m.children[A])}m=m||O}return D?()=>{o(D)}:Vo}function o(f){if(lv(f)){const d=r.get(f);d&&(r.delete(f),t.splice(t.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=t.indexOf(f);d>-1&&(t.splice(d,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const d=dA(f,t);t.splice(d,0,f),f.record.name&&!Qm(f)&&r.set(f.record.name,f)}function c(f,d){let m,y={},_,E;if("name"in f&&f.name){if(m=r.get(f.name),!m)throw Ni(1,{location:f});E=m.record.name,y=Pe(Gm(d.params,m.keys.filter(D=>!D.optional).concat(m.parent?m.parent.keys.filter(D=>D.optional):[]).map(D=>D.name)),f.params&&Gm(f.params,m.keys.map(D=>D.name))),_=m.stringify(y)}else if(f.path!=null)_=f.path,m=t.find(D=>D.re.test(_)),m&&(y=m.parse(_),E=m.record.name);else{if(m=d.name?r.get(d.name):t.find(D=>D.re.test(d.path)),!m)throw Ni(1,{location:f,currentLocation:d});E=m.record.name,y=Pe({},d.params,f.params),_=m.stringify(y)}const k=[];let O=m;for(;O;)k.unshift(O.record),O=O.parent;return{name:E,path:_,params:y,matched:k,meta:fA(k)}}n.forEach(f=>i(f));function h(){t.length=0,r.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:s}}function Gm(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function Jm(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:hA(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function hA(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function Qm(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function fA(n){return n.reduce((e,t)=>Pe(e,t.meta),{})}function Ym(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function dA(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;uv(n,e[i])<0?r=i:t=i+1}const s=pA(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function pA(n){let e=n;for(;e=e.parent;)if(hv(e)&&uv(n,e)===0)return e}function hv({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function mA(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(nv," "),o=i.indexOf("="),a=Zo(o<0?i:i.slice(0,o)),l=o<0?null:Zo(i.slice(o+1));if(a in e){let c=e[a];Rn(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function Xm(n){let e="";for(let t in n){const r=n[t];if(t=DS(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Rn(r)?r.map(i=>i&&Vh(i)):[r&&Vh(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function gA(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Rn(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const yA=Symbol(""),Zm=Symbol(""),Bc=Symbol(""),Zf=Symbol(""),Fh=Symbol("");function vo(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function Pr(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=d=>{d===!1?l(Ni(4,{from:t,to:e})):d instanceof Error?l(d):tA(d)?l(Ni(2,{from:e,to:d})):(o&&r.enterCallbacks[s]===o&&typeof d=="function"&&o.push(d),a())},h=i(()=>n.call(r&&r.instances[s],e,t,c));let f=Promise.resolve(h);n.length<3&&(f=f.then(c)),f.catch(d=>l(d))})}function qu(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(ev(l)){const h=(l.__vccOpts||l)[e];h&&i.push(Pr(h,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=IS(h)?h.default:h;o.mods[a]=h,o.components[a]=f;const m=(f.__vccOpts||f)[e];return m&&Pr(m,t,r,o,a,s)()}))}}return i}function eg(n){const e=Cn(Bc),t=Cn(Zf),r=Jt(()=>{const l=$n(n.to);return e.resolve(l)}),s=Jt(()=>{const{matched:l}=r.value,{length:c}=l,h=l[c-1],f=t.matched;if(!h||!f.length)return-1;const d=f.findIndex(Oi.bind(null,h));if(d>-1)return d;const m=tg(l[c-2]);return c>1&&tg(h)===m&&f[f.length-1].path!==m?f.findIndex(Oi.bind(null,l[c-2])):d}),i=Jt(()=>s.value>-1&&wA(t.params,r.value.params)),o=Jt(()=>s.value>-1&&s.value===t.matched.length-1&&ov(t.params,r.value.params));function a(l={}){if(TA(l)){const c=e[$n(n.replace)?"replace":"push"]($n(n.to)).catch(Vo);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:Jt(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function _A(n){return n.length===1?n[0]:n}const vA=Pc({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:eg,setup(n,{slots:e}){const t=Rc(eg(n)),{options:r}=Cn(Bc),s=Jt(()=>({[ng(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[ng(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&_A(e.default(t));return n.custom?i:Yf("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),EA=vA;function TA(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function wA(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Rn(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function tg(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const ng=(n,e,t)=>n??e??t,bA=Pc({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Cn(Fh),s=Jt(()=>n.route||r.value),i=Cn(Zm,0),o=Jt(()=>{let c=$n(i);const{matched:h}=s.value;let f;for(;(f=h[c])&&!f.components;)c++;return c}),a=Jt(()=>s.value.matched[o.value]);ml(Zm,Jt(()=>o.value+1)),ml(yA,a),ml(Fh,s);const l=Qt();return No(()=>[l.value,a.value,n.name],([c,h,f],[d,m,y])=>{h&&(h.instances[f]=c,m&&m!==h&&c&&c===d&&(h.leaveGuards.size||(h.leaveGuards=m.leaveGuards),h.updateGuards.size||(h.updateGuards=m.updateGuards))),c&&h&&(!m||!Oi(h,m)||!d)&&(h.enterCallbacks[f]||[]).forEach(_=>_(c))},{flush:"post"}),()=>{const c=s.value,h=n.name,f=a.value,d=f&&f.components[h];if(!d)return rg(t.default,{Component:d,route:c});const m=f.props[h],y=m?m===!0?c.params:typeof m=="function"?m(c):m:null,E=Yf(d,Pe({},y,e,{onVnodeUnmounted:k=>{k.component.isUnmounted&&(f.instances[h]=null)},ref:l}));return rg(t.default,{Component:E,route:c})||E}}});function rg(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const IA=bA;function SA(n){const e=uA(n.routes,n),t=n.parseQuery||mA,r=n.stringifyQuery||Xm,s=n.history,i=vo(),o=vo(),a=vo(),l=E0(Ar);let c=Ar;ui&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=ju.bind(null,V=>""+V),f=ju.bind(null,LS),d=ju.bind(null,Zo);function m(V,ee){let Q,se;return lv(V)?(Q=e.getRecordMatcher(V),se=ee):se=V,e.addRoute(se,Q)}function y(V){const ee=e.getRecordMatcher(V);ee&&e.removeRoute(ee)}function _(){return e.getRoutes().map(V=>V.record)}function E(V){return!!e.getRecordMatcher(V)}function k(V,ee){if(ee=Pe({},ee||l.value),typeof V=="string"){const x=Hu(t,V,ee.path),L=e.resolve({path:x.path},ee),$=s.createHref(x.fullPath);return Pe(x,L,{params:d(L.params),hash:Zo(x.hash),redirectedFrom:void 0,href:$})}let Q;if(V.path!=null)Q=Pe({},V,{path:Hu(t,V.path,ee.path).path});else{const x=Pe({},V.params);for(const L in x)x[L]==null&&delete x[L];Q=Pe({},V,{params:f(x)}),ee.params=f(ee.params)}const se=e.resolve(Q,ee),Re=V.hash||"";se.params=h(d(se.params));const b=US(r,Pe({},V,{hash:NS(Re),path:se.path})),I=s.createHref(b);return Pe({fullPath:b,hash:Re,query:r===Xm?gA(V.query):V.query||{}},se,{redirectedFrom:void 0,href:I})}function O(V){return typeof V=="string"?Hu(t,V,l.value.path):Pe({},V)}function D(V,ee){if(c!==V)return Ni(8,{from:ee,to:V})}function U(V){return A(V)}function X(V){return U(Pe(O(V),{replace:!0}))}function Z(V){const ee=V.matched[V.matched.length-1];if(ee&&ee.redirect){const{redirect:Q}=ee;let se=typeof Q=="function"?Q(V):Q;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=O(se):{path:se},se.params={}),Pe({query:V.query,hash:V.hash,params:se.path!=null?{}:V.params},se)}}function A(V,ee){const Q=c=k(V),se=l.value,Re=V.state,b=V.force,I=V.replace===!0,x=Z(Q);if(x)return A(Pe(O(x),{state:typeof x=="object"?Pe({},Re,x.state):Re,force:b,replace:I}),ee||Q);const L=Q;L.redirectedFrom=ee;let $;return!b&&$S(r,se,Q)&&($=Ni(16,{to:L,from:se}),un(se,se,!0,!1)),($?Promise.resolve($):C(L,se)).catch(F=>er(F)?er(F,2)?F:En(F):be(F,L,se)).then(F=>{if(F){if(er(F,2))return A(Pe({replace:I},O(F.to),{state:typeof F.to=="object"?Pe({},Re,F.to.state):Re,force:b}),ee||L)}else F=P(L,se,!0,I,Re);return R(L,se,F),F})}function T(V,ee){const Q=D(V,ee);return Q?Promise.reject(Q):Promise.resolve()}function w(V){const ee=Tr.values().next().value;return ee&&typeof ee.runWithContext=="function"?ee.runWithContext(V):V()}function C(V,ee){let Q;const[se,Re,b]=AA(V,ee);Q=qu(se.reverse(),"beforeRouteLeave",V,ee);for(const x of se)x.leaveGuards.forEach(L=>{Q.push(Pr(L,V,ee))});const I=T.bind(null,V,ee);return Q.push(I),qt(Q).then(()=>{Q=[];for(const x of i.list())Q.push(Pr(x,V,ee));return Q.push(I),qt(Q)}).then(()=>{Q=qu(Re,"beforeRouteUpdate",V,ee);for(const x of Re)x.updateGuards.forEach(L=>{Q.push(Pr(L,V,ee))});return Q.push(I),qt(Q)}).then(()=>{Q=[];for(const x of b)if(x.beforeEnter)if(Rn(x.beforeEnter))for(const L of x.beforeEnter)Q.push(Pr(L,V,ee));else Q.push(Pr(x.beforeEnter,V,ee));return Q.push(I),qt(Q)}).then(()=>(V.matched.forEach(x=>x.enterCallbacks={}),Q=qu(b,"beforeRouteEnter",V,ee,w),Q.push(I),qt(Q))).then(()=>{Q=[];for(const x of o.list())Q.push(Pr(x,V,ee));return Q.push(I),qt(Q)}).catch(x=>er(x,8)?x:Promise.reject(x))}function R(V,ee,Q){a.list().forEach(se=>w(()=>se(V,ee,Q)))}function P(V,ee,Q,se,Re){const b=D(V,ee);if(b)return b;const I=ee===Ar,x=ui?history.state:{};Q&&(se||I?s.replace(V.fullPath,Pe({scroll:I&&x&&x.scroll},Re)):s.push(V.fullPath,Re)),l.value=V,un(V,ee,Q,I),En()}let S;function Dt(){S||(S=s.listen((V,ee,Q)=>{if(!On.listening)return;const se=k(V),Re=Z(se);if(Re){A(Pe(Re,{replace:!0,force:!0}),se).catch(Vo);return}c=se;const b=l.value;ui&&JS(jm(b.fullPath,Q.delta),Fc()),C(se,b).catch(I=>er(I,12)?I:er(I,2)?(A(Pe(O(I.to),{force:!0}),se).then(x=>{er(x,20)&&!Q.delta&&Q.type===ea.pop&&s.go(-1,!1)}).catch(Vo),Promise.reject()):(Q.delta&&s.go(-Q.delta,!1),be(I,se,b))).then(I=>{I=I||P(se,b,!1),I&&(Q.delta&&!er(I,8)?s.go(-Q.delta,!1):Q.type===ea.pop&&er(I,20)&&s.go(-1,!1)),R(se,b,I)}).catch(Vo)}))}let cn=vo(),Ye=vo(),Ae;function be(V,ee,Q){En(V);const se=Ye.list();return se.length?se.forEach(Re=>Re(V,ee,Q)):console.error(V),Promise.reject(V)}function tn(){return Ae&&l.value!==Ar?Promise.resolve():new Promise((V,ee)=>{cn.add([V,ee])})}function En(V){return Ae||(Ae=!V,Dt(),cn.list().forEach(([ee,Q])=>V?Q(V):ee()),cn.reset()),V}function un(V,ee,Q,se){const{scrollBehavior:Re}=n;if(!ui||!Re)return Promise.resolve();const b=!Q&&QS(jm(V.fullPath,0))||(se||!Q)&&history.state&&history.state.scroll||null;return jf().then(()=>Re(V,ee,b)).then(I=>I&&GS(I)).catch(I=>be(I,V,ee))}const He=V=>s.go(V);let qe;const Tr=new Set,On={currentRoute:l,listening:!0,addRoute:m,removeRoute:y,clearRoutes:e.clearRoutes,hasRoute:E,getRoutes:_,resolve:k,options:n,push:U,replace:X,go:He,back:()=>He(-1),forward:()=>He(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Ye.add,isReady:tn,install(V){const ee=this;V.component("RouterLink",EA),V.component("RouterView",IA),V.config.globalProperties.$router=ee,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>$n(l)}),ui&&!qe&&l.value===Ar&&(qe=!0,U(s.location).catch(Re=>{}));const Q={};for(const Re in Ar)Object.defineProperty(Q,Re,{get:()=>l.value[Re],enumerable:!0});V.provide(Bc,ee),V.provide(Zf,y0(Q)),V.provide(Fh,l);const se=V.unmount;Tr.add(V),V.unmount=function(){Tr.delete(V),Tr.size<1&&(c=Ar,S&&S(),S=null,l.value=Ar,qe=!1,Ae=!1),se()}}};function qt(V){return V.reduce((ee,Q)=>ee.then(()=>w(Q)),Promise.resolve())}return On}function AA(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>Oi(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>Oi(c,l))||s.push(l))}return[t,r,s]}function fv(){return Cn(Bc)}function dv(n){return Cn(Zf)}const CA={};function kA(n,e){const t=Ta("router-link");return De(),ze("header",null,[We(t,{class:"brand",to:{name:"home"}},{default:Pi(()=>e[0]||(e[0]=[fe("svg",{class:"logo",version:"1.1",viewBox:"0 0 123.94 123.94","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg"},[fe("path",{d:"m62.938 14.356c0.758 6.359 6.161 11.294 12.723 11.294 7.083 0 12.827-5.743 12.827-12.826s-5.744-12.824-12.827-12.824c-6.652 0-12.121 5.068-12.759 11.552 0.056 0.522 0.091 1.053 0.091 1.591-1e-3 0.409-0.022 0.812-0.055 1.213z"}),fe("path",{d:"m90.709 33.332c-0.272 1.096-0.817 2.202-1.714 3.252-2.938 3.454-11.688 7.025-21.244 7.025-1.483 0-2.977-0.092-4.458-0.272v22.832c0 0.897-0.108 1.782-0.308 2.649 0.08 0.26 0.167 0.518 0.267 0.769-0.037 0.26-0.061 0.521-0.061 0.79l4e-3 47.678c0 3.25 2.635 5.884 5.885 5.883 3.251 0 5.884-2.635 5.884-5.884l-2e-3 -40.917c0.233 0.012 0.465 0.029 0.701 0.029 0.045 0 0.091-4e-3 0.138-6e-3l-2e-3 40.895c0 3.25 2.633 5.884 5.885 5.884 3.249 0 5.885-2.634 5.885-5.884v-46.86c0.36 0.393 0.788 0.734 1.282 1.004 0.756 0.41 1.57 0.606 2.373 0.606 1.767 0 3.478-0.94 4.379-2.601 10.485-19.276 2.466-30.708-4.894-36.872zm-1.921 28.053v-15.278c2.168 3.779 2.698 8.633 0 15.278z"}),fe("path",{d:"m72.565 26.358c-0.012 2e-3 -0.021 3e-3 -0.032 5e-3 -2.433 0.581-4.792 1.83-6.611 3.588 0.587 0.043 1.18 0.072 1.787 0.072 4.474 0 8.484-1.192 10.438-2.122 0.295-0.513 0.662-0.98 1.079-1.401-0.123-0.033-0.246-0.077-0.369-0.108 0 0-1.887-0.278-3.177-0.288-1.287-9e-3 -3.115 0.254-3.115 0.254z"}),fe("path",{d:"m88.185 35.092c2.134-2.505 1.721-5.403 0.365-7.164-1.679-2.18-4.805-2.587-6.982-0.91-0.678 0.521-1.185 1.182-1.509 1.91-3.228 1.785-13.693 4.734-22.217 0.13-0.166-0.089-0.333-0.166-0.504-0.235-1.577-1.167-3.409-2.012-5.283-2.459-0.011-2e-3 -0.021-3e-3 -0.032-5e-3 0 0-1.618-0.26-3.074-0.255-1.458 4e-3 -3.217 0.29-3.217 0.29-1.603 0.394-3.176 1.072-4.582 1.995-0.173 0.08-0.348 0.146-0.513 0.248-6.298 3.861-25.459 15.614-11.411 41.436 0.901 1.658 2.613 2.601 4.378 2.601 0.803 0 1.621-0.196 2.376-0.606 0.387-0.212 0.73-0.472 1.038-0.761l-0.026 29.681-11.021 7.209c-2.72 1.778-3.481 5.426-1.703 8.145 1.13 1.727 3.012 2.664 4.931 2.664 1.105 0 2.222-0.311 3.215-0.96l4.566-2.986-2e-3 2.994c-2e-3 3.25 2.628 5.886 5.878 5.89h6e-3c3.248 0 5.883-2.631 5.885-5.879l9e-3 -10.708 9.951-6.51c1.661-1.086 2.663-2.935 2.663-4.918l0.026-25.541c0-0.269-0.024-0.533-0.059-0.794 0.456-1.148 0.716-2.398 0.716-3.738v-24.944c2.109 0.385 4.216 0.568 6.27 0.568 9.217-1e-3 17.359-3.447 19.862-6.388zm-52.386 25.544c-2.328-6.087-1.901-10.641 0-14.236v14.236zm13.804 32.096-0.837 0.549 0.016-16.121c0.047 0 0.095 4e-3 0.143 4e-3 0.233 0 0.463-0.018 0.694-0.028l-0.016 15.596z"}),fe("circle",{cx:"48.926",cy:"12.825",r:"12.825"})],-1),fe("h1",null,[kn("Lorem ipsum "),fe("span",{class:"break-sm"}),kn("dolor sit amet")],-1)])),_:1,__:[0]}),We(t,{class:"user",to:{name:"UserPage"}},{default:Pi(()=>e[1]||(e[1]=[fe("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24"},[fe("path",{d:"M12 4a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"})],-1)])),_:1,__:[1]})])}const RA=Mn(CA,[["render",kA],["__scopeId","data-v-8f9f01a0"]]),xA={};function PA(n,e){const t=Ta("RouterLink");return De(),ze("footer",null,[We(t,{to:"/terms"},{default:Pi(()=>e[0]||(e[0]=[kn("Terms and Conditions")])),_:1,__:[0]}),e[2]||(e[2]=kn(" | ")),We(t,{to:"/privacy"},{default:Pi(()=>e[1]||(e[1]=[kn("Privacy Policy")])),_:1,__:[1]})])}const MA=Mn(xA,[["render",PA],["__scopeId","data-v-3ca61304"]]),OA={__name:"DefaultLayout",setup(n){return(e,t)=>{const r=Ta("router-view");return De(),ze(Gt,null,[We(RA),fe("main",null,[We(r)]),We(MA)],64)}}},NA=Mn(OA,[["__scopeId","data-v-0b284dc6"]]),DA={};function VA(n,e){return De(),ze("section",null,e[0]||(e[0]=[fe("h2",null,"About",-1),fe("p",null,"This is a simple shoutout app built with Vue 3 and Firebase.",-1)]))}const LA=Mn(DA,[["render",VA]]);function dt(n){this.content=n}dt.prototype={constructor:dt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new dt(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new dt(t)},addToStart:function(n,e){return new dt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new dt(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new dt(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=dt.from(n),n.size?new dt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=dt.from(n),n.size?new dt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=dt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};dt.from=function(n){if(n instanceof dt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new dt(e)};function pv(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=pv(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function mv(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,h=Math.min(o.text.length,a.text.length);for(;c<h&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=mv(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class j{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let h=a+1;l.nodesBetween(Math.max(0,e-h),Math.min(l.content.size,t-h),r,s+h)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new j(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new j(r,s)}cutByIndex(e,t){return e==t?j.empty:e==0&&t==this.content.length?this:new j(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new j(s,i)}addToStart(e){return new j([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new j(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return pv(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return mv(this,e,t,r)}findIndex(e,t=-1){if(e==0)return tl(0,e);if(e==this.size)return tl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=e)return o==e||t>0?tl(r+1,o):tl(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return j.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new j(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return j.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new j(t||e,r)}static from(e){if(!e)return j.empty;if(e instanceof j)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new j([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}j.empty=new j([],0);const Wu={index:0,offset:0};function tl(n,e){return Wu.index=n,Wu.offset=e,Wu}function $l(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!$l(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!$l(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Fe=class Bh{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&$l(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Bh.none;if(e instanceof Bh)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Fe.none=[];class zl extends Error{}class Y{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=yv(this.content,e+this.openStart,t);return r&&new Y(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Y(gv(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Y.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Y(j.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new Y(e,r,s)}}Y.empty=new Y(j.empty,0,0);function gv(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(gv(i.content,e-s-1,t-s-1)))}function yv(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=yv(o.content,e-i-1,t);return a&&n.replaceChild(s,o.copy(a))}function FA(n,e,t){if(t.openStart>n.depth)throw new zl("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new zl("Inconsistent open depths");return _v(n,e,t,0)}function _v(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=_v(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return Ns(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=BA(t,n);return Ns(i,Ev(n,o,a,e,r))}else return Ns(i,jl(n,e,r))}function vv(n,e){if(!e.type.compatibleContent(n.type))throw new zl("Cannot join "+e.type.name+" onto "+n.type.name)}function Uh(n,e,t){let r=n.node(t);return vv(r,e.node(t)),r}function Os(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Fo(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Os(n.nodeAfter,r),i++));for(let a=i;a<o;a++)Os(s.child(a),r);e&&e.depth==t&&e.textOffset&&Os(e.nodeBefore,r)}function Ns(n,e){return n.type.checkContent(e),n.copy(e)}function Ev(n,e,t,r,s){let i=n.depth>s&&Uh(n,e,s+1),o=r.depth>s&&Uh(t,r,s+1),a=[];return Fo(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(vv(i,o),Os(Ns(i,Ev(n,e,t,r,s+1)),a)):(i&&Os(Ns(i,jl(n,e,s+1)),a),Fo(e,t,s,a),o&&Os(Ns(o,jl(t,r,s+1)),a)),Fo(r,null,s,a),new j(a)}function jl(n,e,t){let r=[];if(Fo(null,n,t,r),n.depth>t){let s=Uh(n,e,t+1);Os(Ns(s,jl(n,e,t+1)),r)}return Fo(e,null,t,r),new j(r)}function BA(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(j.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class ta{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Fe.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Hl(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new ta(t,r,i)}static resolveCached(e,t){let r=sg.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==t)return o}else sg.set(e,r=new UA);let s=r.elts[r.i]=ta.resolve(e,t);return r.i=(r.i+1)%$A,s}}class UA{constructor(){this.elts=[],this.i=0}}const $A=12,sg=new WeakMap;class Hl{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const zA=Object.create(null);let qr=class $h{constructor(e,t,r,s=Fe.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||j.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&$l(this.attrs,t||e.defaultAttrs||zA)&&Fe.sameSet(this.marks,r||Fe.none)}copy(e=null){return e==this.content?this:new $h(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new $h(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return Y.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new Y(c,s.depth-o,i.depth-o)}replace(e,t,r){return FA(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return ta.resolveCached(this,e)}resolveNoCache(e){return ta.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Tv(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=j.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Fe.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Fe.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=j.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};qr.prototype.text=void 0;class ql extends qr{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Tv(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ql(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ql(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Tv(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Bs{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new jA(e,t);if(r.next==null)return Bs.empty;let s=wv(r);r.next&&r.err("Unexpected trailing text");let i=QA(JA(s));return YA(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return j.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:h,next:f}=o.next[c];if(!(h.isText||h.hasRequiredAttrs())&&s.indexOf(f)==-1){s.push(f);let d=i(f,a.concat(h));if(d)return d}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Bs.empty=new Bs(!0);class jA{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function wv(n){let e=[];do e.push(HA(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function HA(n){let e=[];do e.push(qA(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function qA(n){let e=GA(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=WA(n,e);else break;return e}function ig(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function WA(n,e){let t=ig(n),r=t;return n.eat(",")&&(n.next!="}"?r=ig(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function KA(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function GA(n){if(n.eat("(")){let e=wv(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=KA(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function JA(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let h=t();s(i(o.expr,l),h),l=h}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let h=t();r(l,h),s(i(o.expr,l),h),l=h}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function bv(n,e){return e-n}function og(n,e){let t=[];return r(e),t.sort(bv);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function QA(n){let e=Object.create(null);return t(og(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let h=0;h<s.length;h++)s[h][0]==a&&(c=s[h][1]);og(n,l).forEach(h=>{c||s.push([a,c=[]]),c.indexOf(h)==-1&&c.push(h)})})});let i=e[r.join(",")]=new Bs(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(bv);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function YA(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Iv(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function Sv(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function Av(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let i=n[s];i.validate&&i.validate(e[s])}}function Cv(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new ZA(n,r,e[r]);return t}let ag=class kv{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Cv(e,r.attrs),this.defaultAttrs=Iv(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Bs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Sv(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new qr(this,this.computeAttrs(e),j.from(t),Fe.setFrom(r))}createChecked(e=null,t,r){return t=j.from(t),this.checkContent(t),new qr(this,this.computeAttrs(e),t,Fe.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=j.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(j.empty,!0);return i?new qr(this,e,t.append(i),Fe.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Av(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Fe.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new kv(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function XA(n,e,t){let r=t.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${i}`)}}class ZA{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?XA(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Uc{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=Cv(e,s.attrs),this.excluded=null;let i=Iv(this.attrs);this.instance=i?new Fe(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Fe(this,Sv(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new Uc(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Av(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Rv{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=dt.from(e.nodes),t.marks=dt.from(e.marks||{}),this.nodes=ag.compile(this.spec.nodes,this),this.marks=Uc.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Bs.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?lg(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:lg(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof ag){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new ql(r,r.defaultAttrs,e,Fe.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return qr.fromJSON(this,e)}markFromJSON(e){return Fe.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function lg(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function eC(n){return n.tag!=null}function tC(n){return n.style!=null}class Wr{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(eC(s))this.tags.push(s);else if(tC(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new ug(this,t,!1);return r.addAll(e,Fe.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new ug(this,t,!0);return r.addAll(e,Fe.none,t.from,t.to),Y.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(sC(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=hg(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=hg(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Wr(e,Wr.schemaRules(e)))}}const xv={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},nC={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Pv={ol:!0,ul:!0},na=1,zh=2,_l=4;function cg(n,e,t){return e!=null?(e?na:0)|(e==="full"?zh:0):n&&n.whitespace=="pre"?na|zh:t&-5}class nl{constructor(e,t,r,s,i,o){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=Fe.none,this.match=i||(o&_l?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(j.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&na)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=j.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(j.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!xv.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ug{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,i,o=cg(null,t.preserveWhitespace,0)|(r?_l:0);s?i=new nl(s.type,s.attrs,Fe.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new nl(null,null,Fe.none,!0,null,o):i=new nl(e.schema.topNodeType,null,Fe.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,i=s.options&zh?"full":this.localPreserveWS||(s.options&na)>0;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],a=e.previousSibling;(!o||a&&a.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;Pv.hasOwnProperty(o)&&this.parser.normalizeLists&&rC(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:nC.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,h=this.needsBlock;if(xv.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let f=l&&l.skip?t:this.readStyles(e,t);f&&this.addAll(e,f),c&&this.sync(i),this.needsBlock=h}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,s){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(o,t.attrs||null,r,t.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)t=this.enterInner(s[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Fe.none;for(let a of s.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):fg(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,s){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,s)),i}enterInner(e,t,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=cg(e,i,o.options);o.options&_l&&o.content.length==0&&(a|=_l);let l=Fe.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):fg(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new nl(e,t,l,s,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=na)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let h=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!h||h.name!=c&&!h.isInGroup(c))return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function rC(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Pv.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function sC(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function hg(n){let e={};for(let t in n)e[t]=n[t];return e}function fg(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:h}=a.edge(l);if(c==e||i.indexOf(h)<0&&o(h))return!0}};if(o(s.contentMatch))return!0}}class Js{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Ku(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],h=this.serializeMark(c,o.isInline,t);h&&(i.push([c,s]),s.appendChild(h.dom),s=h.contentDOM||h.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=vl(Ku(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&vl(Ku(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return vl(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Js(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=dg(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return dg(e.marks)}}function dg(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Ku(n){return n.document||window.document}const pg=new WeakMap;function iC(n){let e=pg.get(n);return e===void 0&&pg.set(n,e=oC(n)),e}function oC(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function vl(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=iC(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(t=s.slice(0,o),s=s.slice(o+1));let a,l=t?n.createElementNS(t,s):n.createElement(s),c=e[1],h=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){h=2;for(let f in c)if(c[f]!=null){let d=f.indexOf(" ");d>0?l.setAttributeNS(f.slice(0,d),f.slice(d+1),c[f]):l.setAttribute(f,c[f])}}for(let f=h;f<e.length;f++){let d=e[f];if(d===0){if(f<e.length-1||f>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:m,contentDOM:y}=vl(n,d,t,r);if(l.appendChild(m),y){if(a)throw new RangeError("Multiple content holes");a=y}}}return{dom:l,contentDOM:a}}const Mv=65535,Ov=Math.pow(2,16);function aC(n,e){return n+e*Ov}function mg(n){return n&Mv}function lC(n){return(n-(n&Mv))/Ov}const Nv=1,Dv=2,El=4,Vv=8;class jh{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Vv)>0}get deletedBefore(){return(this.delInfo&(Nv|El))>0}get deletedAfter(){return(this.delInfo&(Dv|El))>0}get deletedAcross(){return(this.delInfo&El)>0}}class sn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&sn.empty)return sn.empty}recover(e){let t=0,r=mg(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+lC(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],h=this.ranges[a+o],f=l+c;if(e<=f){let d=c?e==l?-1:e==f?1:t:t,m=l+s+(d<0?0:h);if(r)return m;let y=e==(t<0?l:f)?null:aC(a/3,e-l),_=e==l?Dv:e==f?Nv:El;return(t<0?e!=l:e!=f)&&(_|=Vv),new jh(m,_,y)}s+=h-c}return r?e+s:new jh(e+s,0,null)}touches(e,t){let r=0,s=mg(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],h=l+c;if(e<=h&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],h=this.ranges[s+r];e(a,a+c,l,l+h),i+=h-c}}invert(){return new sn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?sn.empty:new sn(e<0?[0,-e,0]:[0,0,e])}}sn.empty=new sn([]);class ra{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new ra(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new ra;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new jh(e,s,null)}}const Gu=Object.create(null);class Nt{getMap(){return sn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Gu[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Gu)throw new RangeError("Duplicate use of step JSON ID "+e);return Gu[e]=t,t.prototype.jsonID=e,t}}class et{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new et(e,null)}static fail(e){return new et(null,e)}static fromReplace(e,t,r,s){try{return et.ok(e.replace(t,r,s))}catch(i){if(i instanceof zl)return et.fail(i.message);throw i}}}function ed(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(ed(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return j.fromArray(r)}class Br extends Nt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new Y(ed(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return et.fromReplace(e,this.from,this.to,i)}invert(){return new Bn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Br(t.pos,r.pos,this.mark)}merge(e){return e instanceof Br&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Br(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Br(t.from,t.to,e.markFromJSON(t.mark))}}Nt.jsonID("addMark",Br);class Bn extends Nt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new Y(ed(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return et.fromReplace(e,this.from,this.to,r)}invert(){return new Br(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Bn(t.pos,r.pos,this.mark)}merge(e){return e instanceof Bn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Bn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Bn(t.from,t.to,e.markFromJSON(t.mark))}}Nt.jsonID("removeMark",Bn);class Ur extends Nt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return et.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return et.fromReplace(e,this.pos,this.pos+1,new Y(j.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new Ur(this.pos,t.marks[s]);return new Ur(this.pos,this.mark)}}return new Us(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ur(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ur(t.pos,e.markFromJSON(t.mark))}}Nt.jsonID("addNodeMark",Ur);class Us extends Nt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return et.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return et.fromReplace(e,this.pos,this.pos+1,new Y(j.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Ur(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Us(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Us(t.pos,e.markFromJSON(t.mark))}}Nt.jsonID("removeNodeMark",Us);class ot extends Nt{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&Hh(e,this.from,this.to)?et.fail("Structure replace would overwrite content"):et.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new sn([this.from,this.to-this.from,this.slice.size])}invert(e){return new ot(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ot(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof ot)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Y.empty:new Y(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ot(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Y.empty:new Y(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ot(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ot(t.from,t.to,Y.fromJSON(e,t.slice),!!t.structure)}}Nt.jsonID("replace",ot);class at extends Nt{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Hh(e,this.from,this.gapFrom)||Hh(e,this.gapTo,this.to)))return et.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return et.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?et.fromReplace(e,this.from,this.to,r):et.fail("Content does not fit in gap")}getMap(){return new sn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new at(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new at(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new at(t.from,t.to,t.gapFrom,t.gapTo,Y.fromJSON(e,t.slice),t.insert,!!t.structure)}}Nt.jsonID("replaceAround",at);function Hh(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function cC(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,h)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&h.type.allowsMarkType(r.type)){let d=Math.max(c,e),m=Math.min(c+l.nodeSize,t),y=r.addToSet(f);for(let _=0;_<f.length;_++)f[_].isInSet(y)||(o&&o.to==d&&o.mark.eq(f[_])?o.to=m:s.push(o=new Bn(d,m,f[_])));a&&a.to==d?a.to=m:i.push(a=new Br(d,m,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function uC(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof Uc){let c=o.marks,h;for(;h=r.isInSet(c);)(l||(l=[])).push(h),c=h.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let h=0;h<l.length;h++){let f=l[h],d;for(let m=0;m<s.length;m++){let y=s[m];y.step==i-1&&f.eq(s[m].style)&&(d=y)}d?(d.to=c,d.step=i):s.push({style:f,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new Bn(o.from,o.to,o.style)))}function td(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),h=a+c.nodeSize,f=r.matchType(c.type);if(!f)o.push(new ot(a,h,Y.empty));else{r=f;for(let d=0;d<c.marks.length;d++)t.allowsMarkType(c.marks[d].type)||n.step(new Bn(a,h,c.marks[d]));if(s&&c.isText&&t.whitespace!="pre"){let d,m=/\r?\n|\r/g,y;for(;d=m.exec(c.text);)y||(y=new Y(j.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new ot(a+d.index,a+d.index+d[0].length,y))}}a=h}if(!r.validEnd){let l=r.fillBefore(j.empty,!0);n.replace(a,a,new Y(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function hC(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Ji(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!hC(s,i,o))break}return null}function fC(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,h=j.empty,f=0;for(let y=i,_=!1;y>t;y--)_||r.index(y)>0?(_=!0,h=j.from(r.node(y).copy(h)),f++):l--;let d=j.empty,m=0;for(let y=i,_=!1;y>t;y--)_||s.after(y+1)<s.end(y)?(_=!0,d=j.from(s.node(y).copy(d)),m++):c++;n.step(new at(l,c,o,a,new Y(h.append(d),f,m),h.size-f,!0))}function nd(n,e,t=null,r=n){let s=dC(n,e),i=s&&pC(r,e);return i?s.map(gg).concat({type:e,attrs:t}).concat(i.map(gg)):null}function gg(n){return{type:n,attrs:null}}function dC(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function pC(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function mC(n,e,t){let r=j.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=j.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new at(s,i,s,i,new Y(r,0,0),t.length,!0))}function gC(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&yC(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let m=r.whitespace=="pre",y=!!r.contentMatch.matchType(r.schema.linebreakReplacement);m&&!y?c=!1:!m&&y&&(c=!0)}c===!1&&Fv(n,o,a,i),td(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let h=n.mapping.slice(i),f=h.map(a,1),d=h.map(a+o.nodeSize,1);return n.step(new at(f,d,f+1,d-1,new Y(j.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&Lv(n,o,a,i),!1}})}function Lv(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Fv(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function yC(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function _C(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new at(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new Y(j.from(o),0,0),1,!0))}function cr(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,h=t-2;c>i;c--,h--){let f=s.node(c),d=s.index(c);if(f.type.spec.isolating)return!1;let m=f.content.cutByIndex(d,f.childCount),y=r&&r[h+1];y&&(m=m.replaceChild(0,y.type.create(y.attrs)));let _=r&&r[h]||f;if(!f.canReplace(d+1,f.childCount)||!_.type.validContent(m))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function vC(n,e,t=1,r){let s=n.doc.resolve(e),i=j.empty,o=j.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=j.from(s.node(a).copy(i));let h=r&&r[c];o=j.from(h?h.type.create(h.attrs,o):s.node(a).copy(o))}n.step(new ot(e,e,new Y(i.append(o),t,t),!0))}function ms(n,e){let t=n.resolve(e),r=t.index();return Bv(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function EC(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function Bv(n,e){return!!(n&&e&&!n.isLeaf&&EC(n,e))}function $c(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&Bv(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function TC(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(s&&o.inlineContent){let h=o.whitespace=="pre",f=!!o.contentMatch.matchType(s);h&&!f?r=!1:!h&&f&&(r=!0)}let a=n.steps.length;if(r===!1){let h=n.doc.resolve(e+t);Fv(n,h.node(),h.before(),a)}o.inlineContent&&td(n,e+t-1,o,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new ot(c,l.map(e+t,-1),Y.empty,!0)),r===!0){let h=n.doc.resolve(c);Lv(n,h.node(),h.before(),n.steps.length)}return n}function wC(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function Uv(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),h=!1;if(i==1)h=c.canReplace(l,l,s);else{let f=c.contentMatchAt(l).findWrapping(s.firstChild.type);h=f&&c.canReplaceWith(l,l,f[0])}if(h)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function zc(n,e,t=e,r=Y.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return $v(s,i,r)?new ot(e,t,r):new bC(s,i,r).fit()}function $v(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class bC{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=j.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=j.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new Y(i,o,a);return e>-1?new at(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new ot(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Ju(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],h,f=null;if(t==1&&(o?c.matchType(o.type)||(f=c.fillBefore(j.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:f};if(t==2&&o&&(h=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:h};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Ju(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Y(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Ju(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new Y(wo(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new Y(wo(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let _=0;_<i.length;_++)this.openFrontierNode(i[_]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,h=[],{match:f,type:d}=this.frontier[t];if(s){for(let _=0;_<s.childCount;_++)h.push(s.child(_));f=f.matchFragment(s)}let m=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let _=a.child(c),E=f.matchType(_.type);if(!E)break;c++,(c>1||l==0||_.content.size)&&(f=E,h.push(zv(_.mark(d.allowedMarks(_.marks)),c==1?l:0,c==a.childCount?m:-1)))}let y=c==a.childCount;y||(m=-1),this.placed=bo(this.placed,t,j.from(h)),this.frontier[t].match=f,y&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let _=0,E=a;_<m;_++){let k=E.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),E=k.content}this.unplaced=y?e==0?Y.empty:new Y(wo(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new Y(wo(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Qu(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Qu(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],h=Qu(e,a,c,l,!0);if(!h||h.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=bo(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=bo(this.placed,this.depth,j.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(j.empty,!0);t.childCount&&(this.placed=bo(this.placed,this.frontier.length,t))}}function wo(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(wo(n.firstChild.content,e-1,t)))}function bo(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(bo(n.lastChild.content,e-1,t)))}function Ju(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function zv(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,zv(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(j.empty,!0)))),n.copy(r)}function Qu(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!IC(t,i.content,o)?a:null}function IC(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function SC(n){return n.spec.defining||n.spec.definingForContent}function AC(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if($v(s,i,r))return n.step(new ot(e,t,r));let o=Hv(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let d=s.depth,m=s.pos-1;d>0;d--,m--){let y=s.node(d).type.spec;if(y.defining||y.definingAsContext||y.isolating)break;o.indexOf(d)>-1?a=d:s.before(d)==m&&o.splice(1,0,-d)}let l=o.indexOf(a),c=[],h=r.openStart;for(let d=r.content,m=0;;m++){let y=d.firstChild;if(c.push(y),m==r.openStart)break;d=y.content}for(let d=h-1;d>=0;d--){let m=c[d],y=SC(m.type);if(y&&!m.sameMarkup(s.node(Math.abs(a)-1)))h=d;else if(y||!m.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let m=(d+h+1)%(r.openStart+1),y=c[m];if(y)for(let _=0;_<o.length;_++){let E=o[(_+l)%o.length],k=!0;E<0&&(k=!1,E=-E);let O=s.node(E-1),D=s.index(E-1);if(O.canReplaceWith(D,D,y.type,y.marks))return n.replace(s.before(E),k?i.after(E):t,new Y(jv(r.content,0,r.openStart,m),m,r.openEnd))}}let f=n.steps.length;for(let d=o.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let m=o[d];m<0||(e=s.before(m),t=i.after(m))}}function jv(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(jv(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(j.empty,!0))}return n}function CC(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=wC(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new Y(j.from(r),0,0))}function kC(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=Hv(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function Hv(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Si extends Nt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return et.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return et.fromReplace(e,this.pos,this.pos+1,new Y(j.from(s),0,t.isLeaf?0:1))}getMap(){return sn.empty}invert(e){return new Si(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Si(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Si(t.pos,t.attr,t.value)}}Nt.jsonID("attr",Si);class sa extends Nt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return et.ok(r)}getMap(){return sn.empty}invert(e){return new sa(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new sa(t.attr,t.value)}}Nt.jsonID("docAttr",sa);let Di=class extends Error{};Di=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Di.prototype=Object.create(Error.prototype);Di.prototype.constructor=Di;Di.prototype.name="TransformError";class RC{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ra}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Di(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=Y.empty){let s=zc(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new Y(j.from(r),0,0))}delete(e,t){return this.replace(e,t,Y.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return AC(this,e,t,r),this}replaceRangeWith(e,t,r){return CC(this,e,t,r),this}deleteRange(e,t){return kC(this,e,t),this}lift(e,t){return fC(this,e,t),this}join(e,t=1){return TC(this,e,t),this}wrap(e,t){return mC(this,e,t),this}setBlockType(e,t=e,r,s=null){return gC(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return _C(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Si(e,t,r)),this}setDocAttribute(e,t){return this.step(new sa(e,t)),this}addNodeMark(e,t){return this.step(new Ur(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Fe)t.isInSet(r.marks)&&this.step(new Us(e,t));else{let s=r.marks,i,o=[];for(;i=t.isInSet(s);)o.push(new Us(e,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,t=1,r){return vC(this,e,t,r),this}addMark(e,t,r){return cC(this,e,t,r),this}removeMark(e,t,r){return uC(this,e,t,r),this}clearIncompatible(e,t,r){return td(this,e,t,r),this}}const Yu=Object.create(null);class Ee{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new xC(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Y.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],h=e.mapping.slice(i);e.replaceRange(h.map(l.pos),h.map(c.pos),a?Y.empty:t),a==0&&vg(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),h=l.map(a.pos);i?e.deleteRange(c,h):(e.replaceRangeWith(c,h,t),vg(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ge(e):hi(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?hi(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):hi(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new an(e.node(0))}static atStart(e){return hi(e,e,0,0,1)||new an(e)}static atEnd(e){return hi(e,e,e.content.size,e.childCount,-1)||new an(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Yu[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Yu)throw new RangeError("Duplicate use of selection JSON ID "+e);return Yu[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ge.between(this.$anchor,this.$head).getBookmark()}}Ee.prototype.visible=!0;class xC{constructor(e,t){this.$from=e,this.$to=t}}let yg=!1;function _g(n){!yg&&!n.parent.inlineContent&&(yg=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ge extends Ee{constructor(e,t=e){_g(e),_g(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return Ee.near(r);let s=e.resolve(t.map(this.anchor));return new ge(s.parent.inlineContent?s:r,r)}replace(e,t=Y.empty){if(super.replace(e,t),t==Y.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ge&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new jc(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ge(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=Ee.findFrom(t,r,!0)||Ee.findFrom(t,-r,!0);if(i)t=i.$head;else return Ee.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(Ee.findFrom(e,-r,!0)||Ee.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ge(e,t)}}Ee.jsonID("text",ge);class jc{constructor(e,t){this.anchor=e,this.head=t}map(e){return new jc(e.map(this.anchor),e.map(this.head))}resolve(e){return ge.between(e.resolve(this.anchor),e.resolve(this.head))}}class le extends Ee{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?Ee.near(i):new le(i)}content(){return new Y(j.from(this.node),0,0)}eq(e){return e instanceof le&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new rd(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new le(e.resolve(t.anchor))}static create(e,t){return new le(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}le.prototype.visible=!1;Ee.jsonID("node",le);class rd{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new jc(r,r):new rd(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&le.isSelectable(r)?new le(t):Ee.near(t)}}class an extends Ee{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Y.empty){if(t==Y.empty){e.delete(0,e.doc.content.size);let r=Ee.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new an(e)}map(e){return new an(e)}eq(e){return e instanceof an}getBookmark(){return PC}}Ee.jsonID("all",an);const PC={map(){return this},resolve(n){return new an(n)}};function hi(n,e,t,r,s,i=!1){if(e.inlineContent)return ge.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&le.isSelectable(a))return le.create(n,t-(s<0?a.nodeSize:0))}else{let l=hi(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function vg(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof ot||s instanceof at))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,h)=>{o==null&&(o=h)}),n.setSelection(Ee.near(n.doc.resolve(o),t))}const Eg=1,Tg=2,wg=4;class MC extends RC{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Eg)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&Eg)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Tg,this}ensureMarks(e){return Fe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Tg)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Fe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),this.selection.empty||this.setSelection(Ee.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=wg,this}get scrolledIntoView(){return(this.updated&wg)>0}}function bg(n,e){return!e||!n?n:n.bind(e)}class Io{constructor(e,t,r){this.name=e,this.init=bg(t.init,r),this.apply=bg(t.apply,r)}}const OC=[new Io("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Io("selection",{init(n,e){return n.selection||Ee.atStart(e.doc)},apply(n){return n.selection}}),new Io("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Io("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Xu{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=OC.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Io(r.key,r.spec.state,r))})}}class yi{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,h=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(h&&r.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",e),!s){s=[];for(let f=0;f<this.config.plugins.length;f++)s.push(f<o?{state:r,n:t.length}:{state:this,n:0})}t.push(h),r=r.applyInner(h),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new yi(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new MC(this)}static create(e){let t=new Xu(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new yi(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new Xu(this.schema,e.plugins),r=t.fields,s=new yi(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Xu(e.schema,e.plugins),i=new yi(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=qr.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=Ee.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function qv(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=qv(s,e,{})),t[r]=s}return t}class en{constructor(e){this.spec=e,this.props={},e.props&&qv(e.props,this,this.props),this.key=e.key?e.key.key:Wv("plugin")}getState(e){return e[this.key]}}const Zu=Object.create(null);function Wv(n){return n in Zu?n+"$"+ ++Zu[n]:(Zu[n]=0,n+"$")}class Qn{constructor(e="key"){this.key=Wv(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const gt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Vi=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let qh=null;const rr=function(n,e,t){let r=qh||(qh=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},NC=function(){qh=null},$s=function(n,e,t,r){return t&&(Ig(n,e,t,r,-1)||Ig(n,e,t,r,1))},DC=/^(img|br|input|textarea|hr)$/i;function Ig(n,e,t,r,s){for(;;){if(n==t&&e==r)return!0;if(e==(s<0?0:pn(n))){let i=n.parentNode;if(!i||i.nodeType!=1||ba(n)||DC.test(n.nodeName)||n.contentEditable=="false")return!1;e=gt(n)+(s<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.contentEditable=="false")return!1;e=s<0?pn(n):0}else return!1}}function pn(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function VC(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=pn(n)}else if(n.parentNode&&!ba(n))e=gt(n),n=n.parentNode;else return null}}function LC(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!ba(n))e=gt(n)+1,n=n.parentNode;else return null}}function FC(n,e,t){for(let r=e==0,s=e==pn(n);r||s;){if(n==t)return!0;let i=gt(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==pn(n)}}function ba(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Hc=function(n){return n.focusNode&&$s(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function As(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function BC(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function UC(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(pn(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(pn(r.startContainer),r.startOffset)}}}const Kn=typeof navigator<"u"?navigator:null,Sg=typeof document<"u"?document:null,gs=Kn&&Kn.userAgent||"",Wh=/Edge\/(\d+)/.exec(gs),Kv=/MSIE \d/.exec(gs),Kh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(gs),Xt=!!(Kv||Kh||Wh),Kr=Kv?document.documentMode:Kh?+Kh[1]:Wh?+Wh[1]:0,xn=!Xt&&/gecko\/(\d+)/i.test(gs);xn&&+(/Firefox\/(\d+)/.exec(gs)||[0,0])[1];const Gh=!Xt&&/Chrome\/(\d+)/.exec(gs),xt=!!Gh,Gv=Gh?+Gh[1]:0,Bt=!Xt&&!!Kn&&/Apple Computer/.test(Kn.vendor),Li=Bt&&(/Mobile\/\w+/.test(gs)||!!Kn&&Kn.maxTouchPoints>2),dn=Li||(Kn?/Mac/.test(Kn.platform):!1),$C=Kn?/Win/.test(Kn.platform):!1,or=/Android \d/.test(gs),Ia=!!Sg&&"webkitFontSmoothing"in Sg.documentElement.style,zC=Ia?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function jC(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function tr(n,e){return typeof n=="number"?n:n[e]}function HC(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Ag(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=Vi(o);continue}let a=o,l=a==i.body,c=l?jC(i):HC(a),h=0,f=0;if(e.top<c.top+tr(r,"top")?f=-(c.top-e.top+tr(s,"top")):e.bottom>c.bottom-tr(r,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+tr(s,"top")-c.top:e.bottom-c.bottom+tr(s,"bottom")),e.left<c.left+tr(r,"left")?h=-(c.left-e.left+tr(s,"left")):e.right>c.right-tr(r,"right")&&(h=e.right-c.right+tr(s,"right")),h||f)if(l)i.defaultView.scrollBy(h,f);else{let m=a.scrollLeft,y=a.scrollTop;f&&(a.scrollTop+=f),h&&(a.scrollLeft+=h);let _=a.scrollLeft-m,E=a.scrollTop-y;e={left:e.left-_,top:e.top-E,right:e.right-_,bottom:e.bottom-E}}let d=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(d))break;o=d=="absolute"?o.offsetParent:Vi(o)}}function qC(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:Jv(n.dom)}}function Jv(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Vi(r));return e}function WC({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Qv(t,r==0?0:r-e)}function Qv(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let oi=null;function KC(n){if(n.setActive)return n.setActive();if(oi)return n.focus(oi);let e=Jv(n);n.focus(oi==null?{get preventScroll(){return oi={preventScroll:!0},!0}}:void 0),oi||(oi=!1,Qv(e,0))}function Yv(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let h=n.firstChild,f=0;h;h=h.nextSibling,f++){let d;if(h.nodeType==1)d=h.getClientRects();else if(h.nodeType==3)d=rr(h).getClientRects();else continue;for(let m=0;m<d.length;m++){let y=d[m];if(y.top<=o&&y.bottom>=a){o=Math.max(y.bottom,o),a=Math.min(y.top,a);let _=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(_<r){t=h,r=_,s=_&&t.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,h.nodeType==1&&_&&(i=f+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!l&&y.left<=e.left&&y.right>=e.left&&(l=h,c={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!t&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(i=f+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?GC(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:Yv(t,s)}function GC(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=kr(r,1);if(i.top!=i.bottom&&sd(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function sd(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function JC(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function QC(n,e,t){let{node:r,offset:s}=Yv(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function YC(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function Xv(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(sd(e,c))return Xv(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function XC(n,e){let t=n.dom.ownerDocument,r,s=0,i=UC(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!sd(e,c)||(o=Xv(n.dom,e,c),!o))return null}if(Bt)for(let c=o;r&&c;c=Vi(c))c.draggable&&(r=void 0);if(o=JC(o,e),r){if(xn&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let h=r.childNodes[s],f;h.nodeName=="IMG"&&(f=h.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&s++}let c;Ia&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=YC(n,r,s,e))}a==null&&(a=QC(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Cg(n){return n.top<n.bottom||n.left<n.right}function kr(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Cg(r))return r}return Array.prototype.find.call(t,Cg)||n.getBoundingClientRect()}const ZC=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Zv(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=Ia||xn;if(r.nodeType==3)if(o&&(ZC.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=kr(rr(r,s,s),t);if(xn&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=kr(rr(r,s-1,s-1),-1);if(c.top==l.top){let h=kr(rr(r,s,s+1),-1);if(h.top!=l.top)return Eo(h,h.left<c.left)}}return l}else{let l=s,c=s,h=t<0?1:-1;return t<0&&!s?(c++,h=-1):t>=0&&s==r.nodeValue.length?(l--,h=1):t<0?l--:c++,Eo(kr(rr(r,l,c),h),h<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==pn(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return eh(l.getBoundingClientRect(),!1)}if(i==null&&s<pn(r)){let l=r.childNodes[s];if(l.nodeType==1)return eh(l.getBoundingClientRect(),!0)}return eh(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==pn(r))){let l=r.childNodes[s-1],c=l.nodeType==3?rr(l,pn(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Eo(kr(c,1),!1)}if(i==null&&s<pn(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?rr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Eo(kr(c,-1),!0)}return Eo(kr(r.nodeType==3?rr(r):r,-t),t>=0)}function Eo(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function eh(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function eE(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function ek(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return eE(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=Zv(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=rr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let h=l[c];if(h.bottom>h.top+1&&(t=="up"?o.top-h.top>(h.bottom-o.top)*2:h.bottom-o.bottom>(o.bottom-h.top)*2))return!1}}return!0})}const tk=/[\u0590-\u08ac]/;function nk(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return a?!tk.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:eE(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:h,anchorOffset:f}=n.domSelectionRange(),d=a.caretBidiLevel;a.modify("move",t,"character");let m=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:y,focusOffset:_}=n.domSelectionRange(),E=y&&!m.contains(y.nodeType==1?y:y.parentNode)||l==y&&c==_;try{a.collapse(h,f),l&&(l!=h||c!=f)&&a.extend&&a.extend(l,c)}catch{}return d!=null&&(a.caretBidiLevel=d),E}):r.pos==r.start()||r.pos==r.end()}let kg=null,Rg=null,xg=!1;function rk(n,e,t){return kg==e&&Rg==t?xg:(kg=e,Rg=t,xg=t=="up"||t=="down"?ek(n,e,t):nk(n,e,t))}const _n=0,Pg=1,ks=2,Gn=3;class Sa{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=_n,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>gt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof nE){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof tE&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?gt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?gt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let h=o+l.border;if(e>=h&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,h);e=o;for(let f=a;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){s=gt(d.dom)+1;break}e-=d.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let h=a+1;h<this.children.length;h++){let f=this.children[h];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=gt(f.dom);break}t+=f.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let m=0,y=0;m<this.children.length;m++){let _=this.children[m],E=y+_.size;if(i>y&&o<E)return _.setSelection(e-y-_.border,t-y-_.border,r,s);y=E}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),h=r.domSelectionRange(),f=!1;if((xn||Bt)&&e==t){let{node:m,offset:y}=a;if(m.nodeType==3){if(f=!!(y&&m.nodeValue[y-1]==`
`),f&&y==m.nodeValue.length)for(let _=m,E;_;_=_.parentNode){if(E=_.nextSibling){E.nodeName=="BR"&&(a=l={node:E.parentNode,offset:gt(E)+1});break}let k=_.pmViewDesc;if(k&&k.node&&k.node.isBlock)break}}else{let _=m.childNodes[y-1];f=_&&(_.nodeName=="BR"||_.contentEditable=="false")}}if(xn&&h.focusNode&&h.focusNode!=l.node&&h.focusNode.nodeType==1){let m=h.focusNode.childNodes[h.focusOffset];m&&m.contentEditable=="false"&&(s=!0)}if(!(s||f&&Bt)&&$s(a.node,a.offset,h.anchorNode,h.anchorOffset)&&$s(l.node,l.offset,h.focusNode,h.focusOffset))return;let d=!1;if((c.extend||e==t)&&!f){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>t){let y=a;a=l,l=y}let m=document.createRange();m.setEnd(l.node,l.offset),m.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?ks:Pg,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Gn:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?ks:Gn}r=o}this.dirty=ks}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?ks:Pg;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class tE extends Sa{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==_n&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class sk extends Sa{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class zs extends Sa{constructor(e,t,r,s,i){super(e,[],r,s),this.mark=t,this.spec=i}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=Js.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new zs(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Gn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Gn&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=_n){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=_n}}slice(e,t,r){let s=zs.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=Qh(i,t,o,r)),e>0&&(i=Qh(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Gr extends Sa{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),h=c&&c.dom,f=c&&c.contentDOM;if(t.isText){if(!h)h=document.createTextNode(t.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:f}=Js.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),t.type.spec.draggable&&(h.draggable=!0));let d=h;return h=iE(h,r,t),c?l=new ik(e,t,r,s,h,f||null,d,c,i,o+1):t.isText?new qc(e,t,r,s,h,d,i):new Gr(e,t,r,s,h,f||null,d,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>j.empty)}return e}matchesNode(e,t,r){return this.dirty==_n&&e.eq(this.node)&&Wl(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new ak(this,o&&o.node,e);uk(this.node,this.innerDeco,(c,h,f)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!f&&l.syncToMarks(h==this.node.childCount?Fe.none:this.node.child(h).marks,r,e),l.placeWidget(c,e,s)},(c,h,f,d)=>{l.syncToMarks(c.marks,r,e);let m;l.findNodeMatch(c,h,f,d)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(m=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,h,f,m,e)||l.updateNextNode(c,h,f,e,d,s)||l.addNode(c,h,f,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==ks)&&(o&&this.protectLocalComposition(e,o),rE(this.contentDOM,this.children,e),Li&&hk(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ge)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=fk(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new sk(this,i,t,s);e.input.compositionNodes.push(o),this.children=Qh(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==Gn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=_n}updateOuterDeco(e){if(Wl(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=sE(this.dom,this.nodeDOM,Jh(this.outerDeco,this.node,t),Jh(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Mg(n,e,t,r,s){iE(r,e,n);let i=new Gr(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class qc extends Gr{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==Gn||this.dirty!=_n&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=_n||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=_n,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new qc(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Gn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class nE extends Sa{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==_n&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class ik extends Gr{constructor(e,t,r,s,i,o,a,l,c,h){super(e,t,r,s,i,o,a,c,h),this.spec=l}update(e,t,r,s){if(this.dirty==Gn)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function rE(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=Og(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof zs){let l=r?r.previousSibling:n.lastChild;rE(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=Og(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const Bo=function(n){n&&(this.nodeName=n)};Bo.prototype=Object.create(null);const Rs=[new Bo];function Jh(n,e,t){if(n.length==0)return Rs;let r=t?Rs[0]:new Bo,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new Bo(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new Bo(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function sE(n,e,t,r){if(t==Rs&&r==Rs)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=Rs[0]),s=l}ok(s,a||Rs[0],o)}return s}function ok(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function iE(n,e,t){return sE(n,n,Rs,Jh(e,t,n.nodeType!=1))}function Wl(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Og(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class ak{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=lk(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=_n,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=zs.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==Gn&&o.dom==o.contentDOM&&(o.dirty=ks),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Gr){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let h=l.dom,f,d=this.isLocked(h)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Gn&&Wl(t,l.outerDeco));if(!d&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=h&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(l,e,t,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=ks,f.updateChildren(s,o+1),f.dirty=_n),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Wl(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=Gr.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=Gr.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new tE(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof zs;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof qc)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Bt||xt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new nE(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function lk(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof zs)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function ck(n,e){return n.type.side-e.type.side}function uk(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let h=n.child(c);r(h,s,e.forChild(i,h),c),i+=h.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let h,f;for(;o<s.length&&s[o].to==i;){let E=s[o++];E.widget&&(h?(f||(f=[h])).push(E):h=E)}if(h)if(f){f.sort(ck);for(let E=0;E<f.length;E++)t(f[E],c,!!l)}else t(h,c,!!l);let d,m;if(l)m=-1,d=l,l=null;else if(c<n.childCount)m=c,d=n.child(c++);else break;for(let E=0;E<a.length;E++)a[E].to<=i&&a.splice(E--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let y=i+d.nodeSize;if(d.isText){let E=y;o<s.length&&s[o].from<E&&(E=s[o].from);for(let k=0;k<a.length;k++)a[k].to<E&&(E=a[k].to);E<y&&(l=d.cut(E-i),d=d.cut(0,E-i),y=E,m=-1)}else for(;o<s.length&&s[o].to<y;)o++;let _=d.isInline&&!d.isLeaf?a.filter(E=>!E.inline):a.slice();r(d,_,e.forChild(i,d),m),i=y}}function hk(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function fk(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Qh(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,h=a+=l.size;c>=t||h<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),h>t&&i.push(l.slice(t-c,l.size,r)))}return i}function id(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Hc(t)){for(l=o;s&&!s.node;)s=s.parent;let f=s.node;if(s&&f.isAtom&&le.isSelectable(f)&&s.parent&&!(f.isInline&&FC(t.focusNode,t.focusOffset,s.dom))){let d=s.posBefore;c=new le(o==d?a:r.resolve(d))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=o,d=o;for(let m=0;m<t.rangeCount;m++){let y=t.getRangeAt(m);f=Math.min(f,n.docView.posFromDOM(y.startContainer,y.startOffset,1)),d=Math.max(d,n.docView.posFromDOM(y.endContainer,y.endOffset,-1))}if(f<0)return null;[l,o]=d==n.state.selection.anchor?[d,f]:[f,d],a=r.resolve(o)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let h=r.resolve(l);if(!c){let f=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=od(n,h,a,f)}return c}function oE(n){return n.editable?n.hasFocus():lE(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function ur(n,e=!1){let t=n.state.selection;if(aE(n,t),!!oE(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&xt){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&$s(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)pk(n);else{let{anchor:r,head:s}=t,i,o;Ng&&!(t instanceof ge)&&(t.$from.parent.inlineContent||(i=Dg(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=Dg(n,t.to))),n.docView.setSelection(r,s,n,e),Ng&&(i&&Vg(i),o&&Vg(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&dk(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Ng=Bt||xt&&Gv<63;function Dg(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(Bt&&s&&s.contentEditable=="false")return th(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return th(s);if(i)return th(i)}}function th(n){return n.contentEditable="true",Bt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Vg(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function dk(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!oE(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function pk(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setStart(r.parentNode,gt(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&Xt&&Kr<=11&&(r.disabled=!0,r.disabled=!1)}function aE(n,e){if(e instanceof le){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Lg(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Lg(n)}function Lg(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function od(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ge.between(e,t,r)}function Fg(n){return n.editable&&!n.hasFocus()?!1:lE(n)}function lE(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function mk(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return $s(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Yh(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&Ee.findFrom(i,e)}function Mr(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Bg(n,e,t){let r=n.state.selection;if(r instanceof ge)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Mr(n,new ge(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=Yh(n.state,e);return s&&s instanceof le?Mr(n,s):!1}else if(!(dn&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?le.isSelectable(i)?Mr(n,new le(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):Ia?Mr(n,new ge(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof le&&r.node.isInline)return Mr(n,new ge(e>0?r.$to:r.$from));{let s=Yh(n.state,e);return s?Mr(n,s):!1}}}function Kl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Uo(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function ai(n,e){return e<0?gk(n):yk(n)}function gk(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(xn&&t.nodeType==1&&r<Kl(t)&&Uo(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Uo(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(cE(t))break;{let a=t.previousSibling;for(;a&&Uo(a,-1);)s=t.parentNode,i=gt(a),a=a.previousSibling;if(a)t=a,r=Kl(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Xh(n,t,r):s&&Xh(n,s,i)}function yk(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=Kl(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Uo(a,1))i=t,o=++r;else break}else{if(cE(t))break;{let a=t.nextSibling;for(;a&&Uo(a,1);)i=a.parentNode,o=gt(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=Kl(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&Xh(n,i,o)}function cE(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function _k(n,e){for(;n&&e==n.childNodes.length&&!ba(n);)e=gt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function vk(n,e){for(;n&&!e&&!ba(n);)e=gt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Xh(n,e,t){if(e.nodeType!=3){let i,o;(o=_k(e,t))?(e=o,t=0):(i=vk(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Hc(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&ur(n)},50)}function Ug(n,e){let t=n.state.doc.resolve(e);if(!(xt||$C)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function $g(n,e,t){let r=n.state.selection;if(r instanceof ge&&!r.empty||t.indexOf("s")>-1||dn&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Yh(n.state,e);if(o&&o instanceof le)return Mr(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof an?Ee.near(o,e):Ee.findFrom(o,e);return a?Mr(n,a):!1}return!1}function zg(n,e){if(!(n.state.selection instanceof ge))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function jg(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Ek(n){if(!Bt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;jg(n,r,"true"),setTimeout(()=>jg(n,r,"false"),20)}return!1}function Tk(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function wk(n,e){let t=e.keyCode,r=Tk(e);if(t==8||dn&&t==72&&r=="c")return zg(n,-1)||ai(n,-1);if(t==46&&!e.shiftKey||dn&&t==68&&r=="c")return zg(n,1)||ai(n,1);if(t==13||t==27)return!0;if(t==37||dn&&t==66&&r=="c"){let s=t==37?Ug(n,n.state.selection.from)=="ltr"?-1:1:-1;return Bg(n,s,r)||ai(n,s)}else if(t==39||dn&&t==70&&r=="c"){let s=t==39?Ug(n,n.state.selection.from)=="ltr"?1:-1:1;return Bg(n,s,r)||ai(n,s)}else{if(t==38||dn&&t==80&&r=="c")return $g(n,-1,r)||ai(n,-1);if(t==40||dn&&t==78&&r=="c")return Ek(n)||$g(n,1,r)||ai(n,1);if(r==(dn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function ad(n,e){n.someProp("transformCopied",m=>{e=m(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=n.someProp("clipboardSerializer")||Js.fromSchema(n.state.schema),a=mE(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,h,f=0;for(;c&&c.nodeType==1&&(h=pE[c.nodeName.toLowerCase()]);){for(let m=h.length-1;m>=0;m--){let y=a.createElement(h[m]);for(;l.firstChild;)y.appendChild(l.firstChild);l.appendChild(y),f++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",m=>m(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:d,slice:e}}function uE(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",d=>{e=d(e,i||r,n)}),i)return e?new Y(j.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):Y.empty;let f=n.someProp("clipboardTextParser",d=>d(e,s,r,n));if(f)a=f;else{let d=s.marks(),{schema:m}=n.state,y=Js.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(_=>{let E=o.appendChild(document.createElement("p"));_&&E.appendChild(y.serializeNode(m.text(_,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),o=Ak(t),Ia&&Ck(o);let c=o&&o.querySelector("[data-pm-slice]"),h=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let f=+h[3];f>0;f--){let d=o.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;o=d}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Wr.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||h),context:s,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!bk.test(d.parentNode.nodeName)?{ignore:!0}:null}})),h)a=kk(Hg(a,+h[1],+h[2]),h[4]);else if(a=Y.maxOpen(Ik(a.content,s),!0),a.openStart||a.openEnd){let f=0,d=0;for(let m=a.content.firstChild;f<a.openStart&&!m.type.spec.isolating;f++,m=m.firstChild);for(let m=a.content.lastChild;d<a.openEnd&&!m.type.spec.isolating;d++,m=m.lastChild);a=Hg(a,f,d)}return n.someProp("transformPasted",f=>{a=f(a,n)}),a}const bk=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Ik(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&fE(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=dE(o[o.length-1],i.length));let h=hE(a,l);o.push(h),s=s.matchType(h.type),i=l}}),o)return j.from(o)}return n}function hE(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,j.from(n));return n}function fE(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=fE(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(j.from(hE(t,n,s+1))))}}function dE(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,dE(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(j.empty,!0);return n.copy(t.append(r))}function Zh(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=Zh(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(j.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function Hg(n,e,t){return e<n.openStart&&(n=new Y(Zh(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new Y(Zh(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const pE={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let qg=null;function mE(){return qg||(qg=document.implementation.createHTMLDocument("title"))}let nh=null;function Sk(n){let e=window.trustedTypes;return e?(nh||(nh=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),nh.createHTML(n)):n}function Ak(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=mE().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&pE[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=Sk(n),s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function Ck(n){let e=n.querySelectorAll(xt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function kk(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=j.from(l.create(r[a+1],s)),i++,o++}return new Y(s,i,o)}const Ut={},$t={},Rk={touchstart:!0,touchmove:!0};class xk{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Pk(n){for(let e in Ut){let t=Ut[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{Ok(n,r)&&!ld(n,r)&&(n.editable||!(r.type in $t))&&t(n,r)},Rk[e]?{passive:!0}:void 0)}Bt&&n.dom.addEventListener("input",()=>null),ef(n)}function $r(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function Mk(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function ef(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>ld(n,r))})}function ld(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function Ok(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function Nk(n,e){!ld(n,e)&&Ut[e.type]&&(n.editable||!(e.type in $t))&&Ut[e.type](n,e)}$t.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!yE(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(or&&xt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Li&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,As(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||wk(n,t)?t.preventDefault():$r(n,"key")};$t.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};$t.keypress=(n,e)=>{let t=e;if(yE(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||dn&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ge)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode);!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",i=>i(n,r.$from.pos,r.$to.pos,s))&&n.dispatch(n.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function Wc(n){return{left:n.clientX,top:n.clientY}}function Dk(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function cd(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Ai(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function Vk(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&le.isSelectable(r)?(Ai(n,new le(t)),!0):!1}function Lk(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof le&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(le.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Ai(n,le.create(n.state.doc,s)),!0):!1}function Fk(n,e,t,r,s){return cd(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?Lk(n,t):Vk(n,t))}function Bk(n,e,t,r){return cd(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function Uk(n,e,t,r){return cd(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||$k(n,t,r)}function $k(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Ai(n,ge.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Ai(n,ge.create(r,a+1,a+1+o.content.size));else if(le.isSelectable(o))Ai(n,le.create(r,a));else continue;return!0}}function ud(n){return Gl(n)}const gE=dn?"metaKey":"ctrlKey";Ut.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=ud(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&Dk(t,n.input.lastClick)&&!t[gE]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i,button:t.button};let o=n.posAtCoords(Wc(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new zk(n,o,t,!!r)):(i=="doubleClick"?Bk:Uk)(n,o.pos,o.inside,t)?t.preventDefault():$r(n,"pointer"))};class zk{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[gE],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let h=e.state.doc.resolve(t.pos);i=h.parent,o=h.depth?h.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof le&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&xn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),$r(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ur(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Wc(e))),this.updateAllowDefault(e),this.allowDefault||!t?$r(this.view,"pointer"):Fk(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Bt&&this.mightDrag&&!this.mightDrag.node.isAtom||xt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ai(this.view,Ee.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):$r(this.view,"pointer")}move(e){this.updateAllowDefault(e),$r(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ut.touchstart=n=>{n.input.lastTouch=Date.now(),ud(n),$r(n,"pointer")};Ut.touchmove=n=>{n.input.lastTouch=Date.now(),$r(n,"pointer")};Ut.contextmenu=n=>ud(n);function yE(n,e){return n.composing?!0:Bt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const jk=or?5e3:-1;$t.compositionstart=$t.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof ge&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Gl(n,!0),n.markCursor=null;else if(Gl(n,!e.selection.empty),xn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}_E(n,jk)};$t.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,_E(n,20))};function _E(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Gl(n),e))}function vE(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=qk());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function Hk(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=VC(e.focusNode,e.focusOffset),r=LC(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function qk(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Gl(n,e=!1){if(!(or&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),vE(n),e||n.docView&&n.docView.dirty){let t=id(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function Wk(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const ia=Xt&&Kr<15||Li&&zC<604;Ut.copy=$t.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=ia?null:t.clipboardData,o=r.content(),{dom:a,text:l}=ad(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):Wk(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Kk(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function Gk(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?oa(n,r.value,null,s,e):oa(n,r.textContent,r.innerHTML,s,e)},50)}function oa(n,e,t,r,s){let i=uE(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||Y.empty)))return!0;if(!i)return!1;let o=Kk(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function EE(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}$t.paste=(n,e)=>{let t=e;if(n.composing&&!or)return;let r=ia?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&oa(n,EE(r),r.getData("text/html"),s,t)?t.preventDefault():Gk(n,t)};class TE{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Jk=dn?"altKey":"ctrlKey";function wE(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[Jk]}Ut.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(Wc(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof le?s.to-1:s.to))){if(r&&r.mightDrag)o=le.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(o=le.create(n.state.doc,f.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:h}=ad(n,a);(!t.dataTransfer.files.length||!xt||Gv>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(ia?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",ia||t.dataTransfer.setData("text/plain",c),n.dragging=new TE(h,wE(n,t),o)};Ut.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};$t.dragover=$t.dragenter=(n,e)=>e.preventDefault();$t.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(Wc(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",y=>{o=y(o,n)}):o=uE(n,EE(t.dataTransfer),ia?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&wE(n,t));if(n.someProp("handleDrop",y=>y(n,t,o||Y.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?Uv(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:y}=r;y?y.replace(c):c.deleteSelection()}let h=c.mapping.map(l),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,d=c.doc;if(f?c.replaceRangeWith(h,h,o.content.firstChild):c.replaceRange(h,h,o),c.doc.eq(d))return;let m=c.doc.resolve(h);if(f&&le.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new le(m));else{let y=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((_,E,k,O)=>y=O),c.setSelection(od(n,m,c.doc.resolve(y)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Ut.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&ur(n)},20))};Ut.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ut.beforeinput=(n,e)=>{if(xt&&or&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,As(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in $t)Ut[n]=$t[n];function aa(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Jl{constructor(e,t){this.toDOM=e,this.spec=t||Ds,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new gn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Jl&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&aa(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Jr{constructor(e,t){this.attrs=e,this.spec=t||Ds}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new gn(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Jr&&aa(this.attrs,e.attrs)&&aa(this.spec,e.spec)}static is(e){return e.type instanceof Jr}destroy(){}}class hd{constructor(e,t){this.attrs=e,this.spec=t||Ds}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new gn(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof hd&&aa(this.attrs,e.attrs)&&aa(this.spec,e.spec)}destroy(){}}class gn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new gn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new gn(e,e,new Jl(t,r))}static inline(e,t,r,s){return new gn(e,t,new Jr(r,s))}static node(e,t,r,s){return new gn(e,t,new hd(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Jr}get widget(){return this.type instanceof Jl}}const fi=[],Ds={};class nt{constructor(e,t){this.local=e.length?e:fi,this.children=t.length?t:fi}static create(e,t){return t.length?Ql(t,e,0,Ds):At}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==At||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Ds)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?Qk(this.children,o||[],e,t,r,s,i):o?new nt(o.sort(Vs),fi):At}add(e,t){return t.length?this==At?nt.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,h;if(h=IE(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,h,c+1):s.splice(i,0,l,l+a.nodeSize,Ql(h,a,c+1,Ds)),i+=3}});let o=bE(i?SE(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new nt(o.length?this.local.concat(o).sort(Vs):this.local,s||this.children)}remove(e){return e.length==0||this==At?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let h=0,f;h<e.length;h++)(f=e[h])&&f.from>a&&f.to<l&&(e[h]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=At?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new nt(s,r):At}forChild(e,t){if(this==At)return this;if(t.isLeaf)return nt.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof Jr){let c=Math.max(i,l.from)-i,h=Math.min(o,l.to)-i;c<h&&(s||(s=[])).push(l.copy(c,h))}}if(s){let a=new nt(s.sort(Vs),fi);return r?new Nr([a,r]):a}return r||At}eq(e){if(this==e)return!0;if(!(e instanceof nt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return fd(this.localsInner(e))}localsInner(e){if(this==At)return fi;if(e.inlineContent||!this.local.some(Jr.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Jr||t.push(this.local[r]);return t}forEachSet(e){e(this)}}nt.empty=new nt([],[]);nt.removeOverlap=fd;const At=nt.empty;class Nr{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,Ds));return Nr.from(r)}forChild(e,t){if(t.isLeaf)return nt.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=At&&(i instanceof Nr?r=r.concat(i.members):r.push(i))}return Nr.from(r)}eq(e){if(!(e instanceof Nr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?fd(r?t:t.sort(Vs)):fi}static from(e){switch(e.length){case 0:return At;case 1:return e[0];default:return new Nr(e.every(t=>t instanceof nt)?e:e.reduce((t,r)=>t.concat(r instanceof nt?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Qk(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,h=i;c<t.maps.length;c++){let f=0;t.maps[c].forEach((d,m,y,_)=>{let E=_-y-(m-d);for(let k=0;k<a.length;k+=3){let O=a[k+1];if(O<0||d>O+h-f)continue;let D=a[k]+h-f;m>=D?a[k+1]=d<=D?-2:-1:d>=h&&E&&(a[k]+=E,a[k+1]+=E)}f+=E}),h=t.maps[c].map(h,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let h=t.map(n[c]+i),f=h-s;if(f<0||f>=r.content.size){l=!0;continue}let d=t.map(n[c+1]+i,-1),m=d-s,{index:y,offset:_}=r.content.findIndex(f),E=r.maybeChild(y);if(E&&_==f&&_+E.nodeSize==m){let k=a[c+2].mapInner(t,E,h+1,n[c]+i+1,o);k!=At?(a[c]=f,a[c+1]=m,a[c+2]=k):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=Yk(a,n,e,t,s,i,o),h=Ql(c,r,0,o);e=h.local;for(let f=0;f<a.length;f+=3)a[f+1]<0&&(a.splice(f,3),f-=3);for(let f=0,d=0;f<h.children.length;f+=3){let m=h.children[f];for(;d<a.length&&a[d]<m;)d+=3;a.splice(d,0,h.children[f],h.children[f+1],h.children[f+2])}}return new nt(e.sort(Vs),a)}function bE(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new gn(s.from+e,s.to+e,s.type))}return t}function Yk(n,e,t,r,s,i,o){function a(l,c){for(let h=0;h<l.local.length;h++){let f=l.local[h].map(r,s,c);f?t.push(f):o.onRemove&&o.onRemove(l.local[h].spec)}for(let h=0;h<l.children.length;h+=3)a(l.children[h+2],l.children[h]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function IE(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function SE(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Ql(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=IE(n,a,l+t);if(c){i=!0;let h=Ql(c,a,t+l+1,r);h!=At&&s.push(l,l+a.nodeSize,h)}});let o=bE(i?SE(n):n,-t).sort(Vs);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new nt(o,s):At}function Vs(n,e){return n.from-e.from||n.to-e.to}function fd(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),Wg(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),Wg(e,s,r.copy(i.from,r.to)));break}}}return e}function Wg(n,e,t){for(;e<n.length&&Vs(t,n[e])>0;)e++;n.splice(e,0,t)}function rh(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=At&&e.push(r)}),n.cursorWrapper&&e.push(nt.create(n.state.doc,[n.cursorWrapper.deco])),Nr.from(e)}const Xk={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Zk=Xt&&Kr<=11;class eR{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class tR{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new eR,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Xt&&Kr<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),Zk&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Xk)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Fg(this.view)){if(this.suppressingSelectionUpdates)return ur(this.view);if(Xt&&Kr<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&$s(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=Vi(i))t.add(i);for(let i=e.anchorNode;i;i=Vi(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Fg(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let h=0;h<t.length;h++){let f=this.registerMutation(t[h],l);f&&(i=i<0?f.from:Math.min(f.from,i),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(a=!0))}if(xn&&l.length){let h=l.filter(f=>f.nodeName=="BR");if(h.length==2){let[f,d]=h;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of h){let m=d.parentNode;m&&m.nodeName=="LI"&&(!f||sR(e,f)!=m)&&d.remove()}}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Hc(r)&&(c=id(e))&&c.eq(Ee.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,ur(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),nR(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||ur(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let h=0;h<e.addedNodes.length;h++){let f=e.addedNodes[h];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Xt&&Kr<=11&&e.addedNodes.length)for(let h=0;h<e.addedNodes.length;h++){let{previousSibling:f,nextSibling:d}=e.addedNodes[h];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d)}let o=s&&s.parentNode==e.target?gt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?gt(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Kg=new WeakMap,Gg=!1;function nR(n){if(!Kg.has(n)&&(Kg.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=xn,Gg)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Gg=!0}}function Jg(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return $s(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function rR(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return Jg(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?Jg(n,t):null}function sR(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function iR(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,h=l.anchorNode;if(h&&n.dom.contains(h.nodeType==1?h:h.parentNode)&&(c=[{node:h,offset:l.anchorOffset}],Hc(l)||c.push({node:l.focusNode,offset:l.focusOffset})),xt&&n.input.lastKeyCode===8)for(let E=i;E>s;E--){let k=r.childNodes[E-1],O=k.pmViewDesc;if(k.nodeName=="BR"&&!O){i=E;break}if(!O||O.size)break}let f=n.state.doc,d=n.someProp("domParser")||Wr.fromSchema(n.state.schema),m=f.resolve(o),y=null,_=d.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:oR,context:m});if(c&&c[0].pos!=null){let E=c[0].pos,k=c[1]&&c[1].pos;k==null&&(k=E),y={anchor:E+o,head:k+o}}return{doc:_,sel:y,from:o,to:a}}function oR(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Bt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Bt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const aR=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function lR(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let w=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,C=id(n,w);if(C&&!n.state.selection.eq(C)){if(xt&&or&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",P=>P(n,As(13,"Enter"))))return;let R=n.state.tr.setSelection(C);w=="pointer"?R.setMeta("pointer",!0):w=="key"&&R.scrollIntoView(),i&&R.setMeta("composition",i),n.dispatch(R)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=iR(n,e,t),h=n.state.doc,f=h.slice(c.from,c.to),d,m;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,m="end"):(d=n.state.selection.from,m="start"),n.input.lastKeyCode=null;let y=hR(f.content,c.doc.content,c.from,d,m);if(y&&n.input.domChangeCount++,(Li&&n.input.lastIOSEnter>Date.now()-225||or)&&s.some(w=>w.nodeType==1&&!aR.test(w.nodeName))&&(!y||y.endA>=y.endB)&&n.someProp("handleKeyDown",w=>w(n,As(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!y)if(r&&l instanceof ge&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))y={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let w=Qg(n,n.state.doc,c.sel);if(w&&!w.eq(n.state.selection)){let C=n.state.tr.setSelection(w);i&&C.setMeta("composition",i),n.dispatch(C)}}return}n.state.selection.from<n.state.selection.to&&y.start==y.endB&&n.state.selection instanceof ge&&(y.start>n.state.selection.from&&y.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?y.start=n.state.selection.from:y.endA<n.state.selection.to&&y.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(y.endB+=n.state.selection.to-y.endA,y.endA=n.state.selection.to)),Xt&&Kr<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>c.from&&c.doc.textBetween(y.start-c.from-1,y.start-c.from+1)==" "&&(y.start--,y.endA--,y.endB--);let _=c.doc.resolveNoCache(y.start-c.from),E=c.doc.resolveNoCache(y.endB-c.from),k=h.resolve(y.start),O=_.sameParent(E)&&_.parent.inlineContent&&k.end()>=y.endA,D;if((Li&&n.input.lastIOSEnter>Date.now()-225&&(!O||s.some(w=>w.nodeName=="DIV"||w.nodeName=="P"))||!O&&_.pos<c.doc.content.size&&(!_.sameParent(E)||!_.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(_.pos,E.pos,"",""))&&(D=Ee.findFrom(c.doc.resolve(_.pos+1),1,!0))&&D.head>_.pos)&&n.someProp("handleKeyDown",w=>w(n,As(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>y.start&&uR(h,y.start,y.endA,_,E)&&n.someProp("handleKeyDown",w=>w(n,As(8,"Backspace")))){or&&xt&&n.domObserver.suppressSelectionUpdates();return}xt&&y.endB==y.start&&(n.input.lastChromeDelete=Date.now()),or&&!O&&_.start()!=E.start()&&E.parentOffset==0&&_.depth==E.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==y.endA&&(y.endB-=2,E=c.doc.resolveNoCache(y.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(w){return w(n,As(13,"Enter"))})},20));let U=y.start,X=y.endA,Z,A,T;if(O){if(_.pos==E.pos)Xt&&Kr<=11&&_.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>ur(n),20)),Z=n.state.tr.delete(U,X),A=h.resolve(y.start).marksAcross(h.resolve(y.endA));else if(y.endA==y.endB&&(T=cR(_.parent.content.cut(_.parentOffset,E.parentOffset),k.parent.content.cut(k.parentOffset,y.endA-k.start()))))Z=n.state.tr,T.type=="add"?Z.addMark(U,X,T.mark):Z.removeMark(U,X,T.mark);else if(_.parent.child(_.index()).isText&&_.index()==E.index()-(E.textOffset?0:1)){let w=_.parent.textBetween(_.parentOffset,E.parentOffset);if(n.someProp("handleTextInput",C=>C(n,U,X,w)))return;Z=n.state.tr.insertText(w,U,X)}}if(Z||(Z=n.state.tr.replace(U,X,c.doc.slice(y.start-c.from,y.endB-c.from))),c.sel){let w=Qg(n,Z.doc,c.sel);w&&!(xt&&n.composing&&w.empty&&(y.start!=y.endB||n.input.lastChromeDelete<Date.now()-100)&&(w.head==U||w.head==Z.mapping.map(X)-1)||Xt&&w.empty&&w.head==U)&&Z.setSelection(w)}A&&Z.ensureMarks(A),i&&Z.setMeta("composition",i),n.dispatch(Z.scrollIntoView())}function Qg(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:od(n,e.resolve(t.anchor),e.resolve(t.head))}function cR(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let h=0;h<r.length;h++)s=r[h].removeFromSet(s);for(let h=0;h<t.length;h++)i=t[h].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=h=>h.mark(a.addToSet(h.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=h=>h.mark(a.removeFromSet(h.marks));else return null;let c=[];for(let h=0;h<e.childCount;h++)c.push(l(e.child(h)));if(j.from(c).eq(n))return{mark:a,type:o}}function uR(n,e,t,r,s){if(t-e<=s.pos-r.pos||sh(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(sh(i,!0,!0));return!o.parent.isTextblock||o.pos>t||sh(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function sh(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function hR(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&Yg(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&Yg(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function Yg(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class fR{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new xk,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(ny),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=ey(this),Zg(this),this.nodeViews=ty(this),this.docView=Mg(this.state.doc,Xg(this),rh(this),this.dom,this),this.domObserver=new tR(this,(r,s,i,o)=>lR(this,r,s,i,o)),this.domObserver.start(),Pk(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ef(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(ny),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(vE(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let m=ty(this);pR(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&ef(this),this.editable=ey(this),Zg(this);let l=rh(this),c=Xg(this),h=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(e.doc,c,l);(f||!e.selection.eq(s.selection))&&(o=!0);let d=h=="preserve"&&o&&this.dom.style.overflowAnchor==null&&qC(this);if(o){this.domObserver.stop();let m=f&&(Xt||xt)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&dR(s.selection,e.selection);if(f){let y=xt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Hk(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Mg(e.doc,c,l,this.dom,this)),y&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&mk(this))?ur(this,m):(aE(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():d&&WC(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof le){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Ag(this,t.getBoundingClientRect(),e)}else Ag(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new TE(e.slice,e.move,s<0?void 0:le.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(Xt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&KC(this.dom),ur(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return XC(this,e)}coordsAtPos(e,t=1){return Zv(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return rk(this,t||this.state,e)}pasteHTML(e,t){return oa(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return oa(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return ad(this,e)}destroy(){this.docView&&(Mk(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],rh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,NC())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Nk(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Bt&&this.root.nodeType===11&&BC(this.dom.ownerDocument)==this.dom&&rR(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Xg(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[gn.node(0,n.state.doc.content.size,e)]}function Zg(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:gn.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function ey(n){return!n.someProp("editable",e=>e(n.state)===!1)}function dR(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function ty(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function pR(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function ny(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ss={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Yl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mR=typeof navigator<"u"&&/Mac/.test(navigator.platform),gR=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var yt=0;yt<10;yt++)ss[48+yt]=ss[96+yt]=String(yt);for(var yt=1;yt<=24;yt++)ss[yt+111]="F"+yt;for(var yt=65;yt<=90;yt++)ss[yt]=String.fromCharCode(yt+32),Yl[yt]=String.fromCharCode(yt);for(var ih in ss)Yl.hasOwnProperty(ih)||(Yl[ih]=ss[ih]);function yR(n){var e=mR&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||gR&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Yl:ss)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const _R=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),vR=typeof navigator<"u"&&/Win/.test(navigator.platform);function ER(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))_R?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function TR(n){let e=Object.create(null);for(let t in n)e[ER(t)]=n[t];return e}function oh(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function wR(n){return new en({props:{handleKeyDown:AE(n)}})}function AE(n){let e=TR(n);return function(t,r){let s=yR(r),i,o=e[oh(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[oh(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(vR&&r.ctrlKey&&r.altKey)&&(i=ss[r.keyCode])&&i!=s){let a=e[oh(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const dd=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function CE(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const kE=(n,e,t)=>{let r=CE(n,t);if(!r)return!1;let s=pd(r);if(!s){let o=r.blockRange(),a=o&&Ji(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(LE(n,s,e,-1))return!0;if(r.parent.content.size==0&&(Fi(i,"end")||le.isSelectable(i)))for(let o=r.depth;;o--){let a=zc(n.doc,r.before(o),r.after(o),Y.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Fi(i,"end")?Ee.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):le.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},bR=(n,e,t)=>{let r=CE(n,t);if(!r)return!1;let s=pd(r);return s?RE(n,s,e):!1},IR=(n,e,t)=>{let r=PE(n,t);if(!r)return!1;let s=md(r);return s?RE(n,s,e):!1};function RE(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let h=s.lastChild;if(!h)return!1;s=h}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let h=a.firstChild;if(!h)return!1;a=h}let c=zc(n.doc,i,l,Y.empty);if(!c||c.from!=i||c instanceof ot&&c.slice.size>=l-i)return!1;if(t){let h=n.tr.step(c);h.setSelection(ge.create(h.doc,i)),t(h.scrollIntoView())}return!0}function Fi(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const xE=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=pd(r)}let o=i&&i.nodeBefore;return!o||!le.isSelectable(o)?!1:(e&&e(n.tr.setSelection(le.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function pd(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function PE(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const ME=(n,e,t)=>{let r=PE(n,t);if(!r)return!1;let s=md(r);if(!s)return!1;let i=s.nodeAfter;if(LE(n,s,e,1))return!0;if(r.parent.content.size==0&&(Fi(i,"start")||le.isSelectable(i))){let o=zc(n.doc,r.before(),r.after(),Y.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Fi(i,"start")?Ee.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):le.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},OE=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=md(r)}let o=i&&i.nodeAfter;return!o||!le.isSelectable(o)?!1:(e&&e(n.tr.setSelection(le.create(n.doc,i.pos)).scrollIntoView()),!0)};function md(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const SR=(n,e)=>{let t=n.selection,r=t instanceof le,s;if(r){if(t.node.isTextblock||!ms(n.doc,t.from))return!1;s=t.from}else if(s=$c(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(le.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},AR=(n,e)=>{let t=n.selection,r;if(t instanceof le){if(t.node.isTextblock||!ms(n.doc,t.to))return!1;r=t.to}else if(r=$c(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},CR=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&Ji(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},NE=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function gd(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const kR=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=gd(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(Ee.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},DE=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof an||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=gd(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(ge.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},VE=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(cr(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&Ji(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function RR(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof le&&e.selection.node.isBlock)return!r.parentOffset||!cr(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let m=r.depth;;m--)if(r.node(m).isBlock){l=r.end(m)==r.pos+(r.depth-m),c=r.start(m)==r.pos-(r.depth-m),a=gd(r.node(m-1).contentMatchAt(r.indexAfter(m-1))),i.unshift(l&&a?{type:a}:null),o=m;break}else{if(m==1)return!1;i.unshift(null)}let h=e.tr;(e.selection instanceof ge||e.selection instanceof an)&&h.deleteSelection();let f=h.mapping.map(r.pos),d=cr(h.doc,f,i.length,i);if(d||(i[0]=a?{type:a}:null,d=cr(h.doc,f,i.length,i)),!d)return!1;if(h.split(f,i.length,i),!l&&c&&r.node(o).type!=a){let m=h.mapping.map(r.before(o)),y=h.doc.resolve(m);a&&r.node(o-1).canReplaceWith(y.index(),y.index()+1,a)&&h.setNodeMarkup(h.mapping.map(r.before(o)),a)}return t&&t(h.scrollIntoView()),!0}}const xR=RR(),PR=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(le.create(n.doc,s))),!0)};function MR(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||ms(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function LE(n,e,t,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&MR(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(t){let m=e.pos+i.nodeSize,y=j.empty;for(let k=o.length-1;k>=0;k--)y=j.from(o[k].create(null,y));y=j.from(s.copy(y));let _=n.tr.step(new at(e.pos-1,m,e.pos,m,new Y(y,1,0),o.length,!0)),E=_.doc.resolve(m+2*o.length);E.nodeAfter&&E.nodeAfter.type==s.type&&ms(_.doc,E.pos)&&_.join(E.pos),t(_.scrollIntoView())}return!0}let h=i.type.spec.isolating||r>0&&l?null:Ee.findFrom(e,1),f=h&&h.$from.blockRange(h.$to),d=f&&Ji(f);if(d!=null&&d>=e.depth)return t&&t(n.tr.lift(f,d).scrollIntoView()),!0;if(c&&Fi(i,"start",!0)&&Fi(s,"end")){let m=s,y=[];for(;y.push(m),!m.isTextblock;)m=m.lastChild;let _=i,E=1;for(;!_.isTextblock;_=_.firstChild)E++;if(m.canReplace(m.childCount,m.childCount,_.content)){if(t){let k=j.empty;for(let D=y.length-1;D>=0;D--)k=j.from(y[D].copy(k));let O=n.tr.step(new at(e.pos-y.length,e.pos+i.nodeSize,e.pos+E,e.pos+i.nodeSize-E,new Y(k,y.length,0),0,!0));t(O.scrollIntoView())}return!0}}return!1}function FE(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(ge.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const OR=FE(-1),NR=FE(1);function DR(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&nd(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function ry(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let h=t.doc.resolve(c),f=h.index();s=h.parent.canReplaceWith(f,f+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}function yd(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}yd(dd,kE,xE);yd(dd,ME,OE);yd(NE,DE,VE,xR);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function VR(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i);if(!o)return!1;let a=r?t.tr:null;return LR(a,o,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function LR(n,e,t,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new Hl(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Hl(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let a=nd(i,t,r,e);return a?(n&&FR(n,e,a,s,t),!0):!1}function FR(n,e,t,r,s){let i=j.empty;for(let h=t.length-1;h>=0;h--)i=j.from(t[h].type.create(t[h].attrs,i));n.step(new at(e.start-(r?2:0),e.end,e.start,e.end,new Y(i,0,0),t.length,!0));let o=0;for(let h=0;h<t.length;h++)t[h].type==s&&(o=h+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let h=e.startIndex,f=e.endIndex,d=!0;h<f;h++,d=!1)!d&&cr(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(h).nodeSize;return n}function BR(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?UR(e,t,n,i):$R(e,t,i):!0:!1}}function UR(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new at(i-1,o,i,o,new Y(j.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Hl(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=Ji(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return ms(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),e(s.scrollIntoView()),!0}function $R(n,e,t){let r=n.tr,s=t.parent;for(let m=t.end,y=t.endIndex-1,_=t.startIndex;y>_;y--)m-=s.child(y).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),h=i.index(-1);if(!c.canReplace(h+(a?0:1),h+1,o.content.append(l?j.empty:j.from(s))))return!1;let f=i.pos,d=f+o.nodeSize;return r.step(new at(f-(a?1:0),d+(l?1:0),f+1,d-1,new Y((a?j.empty:j.from(s.copy(j.empty))).append(l?j.empty:j.from(s.copy(j.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function zR(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,h=j.from(c?n.create():null),f=new Y(j.from(n.create(null,j.from(a.type.create(null,h)))),c?3:1,0),d=i.start,m=i.end;t(e.tr.step(new at(d-(c?3:1),m,d,m,f,1,!0)).scrollIntoView())}return!0}}function Kc(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}class Gc{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...h)=>{const f=l(...h)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,c=e||i.tr,h=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(d=>d===!0)),f={...Object.fromEntries(Object.entries(r).map(([d,m])=>[d,(..._)=>{const E=this.buildProps(c,t),k=m(..._)(E);return a.push(k),f}])),run:h};return f}createCan(e){const{rawCommands:t,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...h)=>c(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:Kc({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...h)=>c(...h)(a)]))}};return a}}class jR{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}once(e,t){const r=(...s)=>{this.off(e,r),t.apply(this,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function re(n,e,t){return n.config[e]===void 0&&n.parent?re(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?re(n.parent,e,t):null}):n.config[e]}function Jc(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function BE(n){const e=[],{nodeExtensions:t,markExtensions:r}=Jc(n),s=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=re(o,"addGlobalAttributes",a);if(!l)return;l().forEach(h=>{h.types.forEach(f=>{Object.entries(h.attributes).forEach(([d,m])=>{e.push({type:f,name:d,attribute:{...i,...m}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=re(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([h,f])=>{const d={...i,...f};typeof(d==null?void 0:d.default)=="function"&&(d.default=d.default()),d!=null&&d.isRequired&&(d==null?void 0:d.default)===void 0&&delete d.default,e.push({type:o.name,name:h,attribute:d})})}),e}function ct(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function zt(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(h=>!l.includes(h));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=i?i.split(";").map(h=>h.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(h=>h.trim()).filter(Boolean):[],c=new Map;l.forEach(h=>{const[f,d]=h.split(":").map(m=>m.trim());c.set(f,d)}),a.forEach(h=>{const[f,d]=h.split(":").map(m=>m.trim());c.set(f,d)}),r[s]=Array.from(c.entries()).map(([h,f])=>`${h}: ${f}`).join("; ")}else r[s]=i}),r},{})}function tf(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>zt(t,r),{})}function UE(n){return typeof n=="function"}function Te(n,e=void 0,...t){return UE(n)?e?n.bind(e)(...t):n(...t):n}function HR(n={}){return Object.keys(n).length===0&&n.constructor===Object}function qR(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function sy(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):qR(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function iy(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&HR(t)?!1:t!=null))}function WR(n,e){var t;const r=BE(n),{nodeExtensions:s,markExtensions:i}=Jc(n),o=(t=s.find(c=>re(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(s.map(c=>{const h=r.filter(k=>k.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},d=n.reduce((k,O)=>{const D=re(O,"extendNodeSchema",f);return{...k,...D?D(c):{}}},{}),m=iy({...d,content:Te(re(c,"content",f)),marks:Te(re(c,"marks",f)),group:Te(re(c,"group",f)),inline:Te(re(c,"inline",f)),atom:Te(re(c,"atom",f)),selectable:Te(re(c,"selectable",f)),draggable:Te(re(c,"draggable",f)),code:Te(re(c,"code",f)),whitespace:Te(re(c,"whitespace",f)),linebreakReplacement:Te(re(c,"linebreakReplacement",f)),defining:Te(re(c,"defining",f)),isolating:Te(re(c,"isolating",f)),attrs:Object.fromEntries(h.map(k=>{var O;return[k.name,{default:(O=k==null?void 0:k.attribute)===null||O===void 0?void 0:O.default}]}))}),y=Te(re(c,"parseHTML",f));y&&(m.parseDOM=y.map(k=>sy(k,h)));const _=re(c,"renderHTML",f);_&&(m.toDOM=k=>_({node:k,HTMLAttributes:tf(k,h)}));const E=re(c,"renderText",f);return E&&(m.toText=E),[c.name,m]})),l=Object.fromEntries(i.map(c=>{const h=r.filter(E=>E.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},d=n.reduce((E,k)=>{const O=re(k,"extendMarkSchema",f);return{...E,...O?O(c):{}}},{}),m=iy({...d,inclusive:Te(re(c,"inclusive",f)),excludes:Te(re(c,"excludes",f)),group:Te(re(c,"group",f)),spanning:Te(re(c,"spanning",f)),code:Te(re(c,"code",f)),attrs:Object.fromEntries(h.map(E=>{var k;return[E.name,{default:(k=E==null?void 0:E.attribute)===null||k===void 0?void 0:k.default}]}))}),y=Te(re(c,"parseHTML",f));y&&(m.parseDOM=y.map(E=>sy(E,h)));const _=re(c,"renderHTML",f);return _&&(m.toDOM=E=>_({mark:E,HTMLAttributes:tf(E,h)})),[c.name,m]}));return new Rv({topNode:o,nodes:a,marks:l})}function ah(n,e){return e.nodes[n]||e.marks[n]||null}function oy(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function _d(n,e){const t=Js.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}const KR=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const h=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?h:h.slice(0,Math.max(0,r-i))}),t};function vd(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Qc{constructor(e){this.find=e.find,this.handler=e.handler}}const GR=(n,e)=>{if(vd(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function rl(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(d=>d.type.spec.code))return!1;let h=!1;const f=KR(c)+i;return o.forEach(d=>{if(h)return;const m=GR(f,d.find);if(!m)return;const y=l.state.tr,_=Kc({state:l.state,transaction:y}),E={from:r-(m[0].length-i.length),to:s},{commands:k,chain:O,can:D}=new Gc({editor:t,state:_});d.handler({state:_,range:E,match:m,commands:k,chain:O,can:D})===null||!y.steps.length||(y.setMeta(a,{transform:y,from:r,to:s,text:i}),l.dispatch(y),h=!0)}),h}function JR(n){const{editor:e,rules:t}=n,r=new en({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:h}=l;typeof h=="string"?h=h:h=_d(j.from(h),o.schema);const{from:f}=l,d=f+h.length;rl({editor:e,from:f,to:d,text:h,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return rl({editor:e,from:i,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&rl({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?rl({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function QR(n){return Object.prototype.toString.call(n).slice(8,-1)}function sl(n){return QR(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Yc(n,e){const t={...n};return sl(n)&&sl(e)&&Object.keys(e).forEach(r=>{sl(e[r])&&sl(n[r])?t[r]=Yc(n[r],e[r]):t[r]=e[r]}),t}class is{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Te(re(this,"addOptions",{name:this.name}))),this.storage=Te(re(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new is(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Yc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new is(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Te(re(t,"addOptions",{name:t.name})),t.storage=Te(re(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}function YR(n){return typeof n=="number"}class XR{constructor(e){this.find=e.find,this.handler=e.handler}}const ZR=(n,e,t)=>{if(vd(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function ex(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:h}=new Gc({editor:e,state:t}),f=[];return t.doc.nodesBetween(r,s,(m,y)=>{if(!m.isTextblock||m.type.spec.code)return;const _=Math.max(r,y),E=Math.min(s,y+m.content.size),k=m.textBetween(_-y,E-y,void 0,"");ZR(k,i.find,o).forEach(D=>{if(D.index===void 0)return;const U=_+D.index+1,X=U+D[0].length,Z={from:t.tr.mapping.map(U),to:t.tr.mapping.map(X)},A=i.handler({state:t,range:Z,match:D,commands:l,chain:c,can:h,pasteEvent:o,dropEvent:a});f.push(A)})}),f.every(m=>m!==null)}let il=null;const tx=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function nx(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:h,from:f,to:d,rule:m,pasteEvt:y})=>{const _=h.tr,E=Kc({state:h,transaction:_});if(!(!ex({editor:e,state:E,from:Math.max(f-1,0),to:d.b-1,rule:m,pasteEvent:y,dropEvent:a})||!_.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,_}};return t.map(h=>new en({view(f){const d=y=>{var _;r=!((_=f.dom.parentElement)===null||_===void 0)&&_.contains(y.target)?f.dom.parentElement:null,r&&(il=e)},m=()=>{il&&(il=null)};return window.addEventListener("dragstart",d),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",d),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(f,d)=>{if(i=r===f.dom.parentElement,a=d,!i){const m=il;m&&setTimeout(()=>{const y=m.state.selection;y&&m.commands.deleteRange({from:y.from,to:y.to})},10)}return!1},paste:(f,d)=>{var m;const y=(m=d.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return o=d,s=!!(y!=null&&y.includes("data-pm-slice")),!1}}},appendTransaction:(f,d,m)=>{const y=f[0],_=y.getMeta("uiEvent")==="paste"&&!s,E=y.getMeta("uiEvent")==="drop"&&!i,k=y.getMeta("applyPasteRules"),O=!!k;if(!_&&!E&&!O)return;if(O){let{text:X}=k;typeof X=="string"?X=X:X=_d(j.from(X),m.schema);const{from:Z}=k,A=Z+X.length,T=tx(X);return l({rule:h,state:m,from:Z,to:{b:A},pasteEvt:T})}const D=d.doc.content.findDiffStart(m.doc.content),U=d.doc.content.findDiffEnd(m.doc.content);if(!(!YR(D)||!U||D===U.b))return l({rule:h,state:m,from:D,to:U,pasteEvt:o})}}))}function rx(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class _i{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=_i.resolve(e),this.schema=WR(this.extensions,t),this.setupExtensions()}static resolve(e){const t=_i.sort(_i.flatten(e)),r=rx(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=re(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=re(r,"priority")||100,o=re(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:ah(t.name,this.schema)},s=re(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=_i.sort([...this.extensions].reverse()),r=[],s=[],i=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:ah(o.name,this.schema)},l=[],c=re(o,"addKeyboardShortcuts",a);let h={};if(o.type==="mark"&&re(o,"exitable",a)&&(h.ArrowRight=()=>is.handleExit({editor:e,mark:o})),c){const _=Object.fromEntries(Object.entries(c()).map(([E,k])=>[E,()=>k({editor:e})]));h={...h,..._}}const f=wR(h);l.push(f);const d=re(o,"addInputRules",a);oy(o,e.options.enableInputRules)&&d&&r.push(...d());const m=re(o,"addPasteRules",a);oy(o,e.options.enablePasteRules)&&m&&s.push(...m());const y=re(o,"addProseMirrorPlugins",a);if(y){const _=y();l.push(..._)}return l}).flat();return[JR({editor:e,rules:r}),...nx({editor:e,rules:s}),...i]}get attributes(){return BE(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Jc(this.extensions);return Object.fromEntries(t.filter(r=>!!re(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:ct(r.name,this.schema)},o=re(r,"addNodeView",i);if(!o)return[];const a=(l,c,h,f,d)=>{const m=tf(l,s);return o()({node:l,view:c,getPos:h,decorations:f,innerDecorations:d,editor:e,extension:r,HTMLAttributes:m})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:ah(e.name,this.schema)};e.type==="mark"&&(!((t=Te(re(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=re(e,"onBeforeCreate",r),i=re(e,"onCreate",r),o=re(e,"onUpdate",r),a=re(e,"onSelectionUpdate",r),l=re(e,"onTransaction",r),c=re(e,"onFocus",r),h=re(e,"onBlur",r),f=re(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),h&&this.editor.on("blur",h),f&&this.editor.on("destroy",f)})}}class jt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Te(re(this,"addOptions",{name:this.name}))),this.storage=Te(re(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new jt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Yc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new jt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Te(re(t,"addOptions",{name:t.name})),t.storage=Te(re(t,"addStorage",{name:t.name,options:t.options})),t}}function $E(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="";return n.nodesBetween(r,s,(l,c,h,f)=>{var d;l.isBlock&&c>r&&(a+=i);const m=o==null?void 0:o[l.type.name];if(m)return h&&(a+=m({node:l,pos:c,parent:h,index:f,range:e})),!1;l.isText&&(a+=(d=l==null?void 0:l.text)===null||d===void 0?void 0:d.slice(Math.max(r,c)-c,s-c))}),a}function zE(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const sx=jt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new en({key:new Qn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(h=>h.$from.pos)),a=Math.max(...i.map(h=>h.$to.pos)),l=zE(t);return $E(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),ix=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),ox=(n=!1)=>({commands:e})=>e.setContent("",n),ax=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:h}=e,f=c.resolve(h.map(l)),d=c.resolve(h.map(l+a.nodeSize)),m=f.blockRange(d);if(!m)return;const y=Ji(m);if(a.type.isTextblock){const{defaultType:_}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(m.start,_)}(y||y===0)&&e.lift(m,y)})}),!0},lx=n=>e=>n(e),cx=()=>({state:n,dispatch:e})=>DE(n,e),ux=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new ge(r.doc.resolve(o-1))),!0},hx=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},fx=n=>({tr:e,state:t,dispatch:r})=>{const s=ct(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},dx=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},px=()=>({state:n,dispatch:e})=>dd(n,e),mx=()=>({commands:n})=>n.keyboardShortcut("Enter"),gx=()=>({state:n,dispatch:e})=>kR(n,e);function Xl(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:vd(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function jE(n,e,t={}){return n.find(r=>r.type===e&&Xl(Object.fromEntries(Object.keys(t).map(s=>[s,r.attrs[s]])),t))}function ay(n,e,t={}){return!!jE(n,e,t)}function Ed(n,e,t){var r;if(!n||!e)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(h=>h.type===e))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(h=>h.type===e)||(t=t||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!jE([...s.node.marks],e,t)))return;let o=s.index,a=n.start()+s.offset,l=o+1,c=a+s.node.nodeSize;for(;o>0&&ay([...n.parent.child(o-1).marks],e,t);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&ay([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function ys(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const yx=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=ys(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:h}=a;if(s){const f=Ed(l,i,e);if(f&&f.from<=c&&f.to>=h){const d=ge.create(o,f.from,f.to);t.setSelection(d)}}return!0},_x=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function HE(n){return n instanceof ge}function xs(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function qE(n,e=null){if(!e)return null;const t=Ee.atStart(n),r=Ee.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?ge.create(n,xs(0,s,i),xs(n.content.size,s,i)):ge.create(n,xs(e,s,i),xs(e,s,i))}function vx(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Td(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Ex=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(Td()||vx())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!HE(t.state.selection))return o(),!0;const a=qE(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},Tx=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),wx=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),WE=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&WE(r)}return n};function ol(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return WE(t)}function Zl(n,e,t){if(n instanceof qr||n instanceof j)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return j.fromArray(n.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(n);return t.errorOnInvalidContent&&o.check(),o}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),Zl("",e,t)}if(s){if(t.errorOnInvalidContent){let o=!1,a="";const l=new Rv({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?Wr.fromSchema(l).parseSlice(ol(n),t.parseOptions):Wr.fromSchema(l).parse(ol(n),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=Wr.fromSchema(e);return t.slice?i.parseSlice(ol(n),t.parseOptions).content:i.parse(ol(n),t.parseOptions)}return Zl("",e,t)}function bx(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof ot||s instanceof at))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,h)=>{o===0&&(o=h)}),n.setSelection(Ee.near(n.doc.resolve(o),t))}const Ix=n=>!("type"in n),Sx=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;try{a=Zl(e,i.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(o=t.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(y){return i.emit("contentError",{editor:i,error:y,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},h=!0,f=!0;if((Ix(a)?a:[a]).forEach(y=>{y.check(),h=h?y.isText&&y.marks.length===0:!1,f=f?y.isBlock:!1}),l===c&&f){const{parent:y}=r.doc.resolve(l);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(l-=1,c+=1)}let m;if(h){if(Array.isArray(e))m=e.map(y=>y.text||"").join("");else if(e instanceof j){let y="";e.forEach(_=>{_.text&&(y+=_.text)}),m=y}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,l,c)}else m=a,r.replaceWith(l,c,m);t.updateSelection&&bx(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:m}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:m})}return!0},Ax=()=>({state:n,dispatch:e})=>SR(n,e),Cx=()=>({state:n,dispatch:e})=>AR(n,e),kx=()=>({state:n,dispatch:e})=>kE(n,e),Rx=()=>({state:n,dispatch:e})=>ME(n,e),xx=()=>({state:n,dispatch:e,tr:t})=>{try{const r=$c(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},Px=()=>({state:n,dispatch:e,tr:t})=>{try{const r=$c(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},Mx=()=>({state:n,dispatch:e})=>bR(n,e),Ox=()=>({state:n,dispatch:e})=>IR(n,e);function KE(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Nx(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Td()||KE()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const Dx=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=Nx(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const h=c.map(r.mapping);h&&s&&r.maybeStep(h)}),!0};function la(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?ct(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(f,d)=>{if(f.isText)return;const m=Math.max(r,d),y=Math.min(s,d+f.nodeSize);a.push({node:f,from:m,to:y})});const l=s-r,c=a.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>Xl(f.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((f,d)=>f+d.to-d.from,0)>=l}const Vx=(n,e={})=>({state:t,dispatch:r})=>{const s=ct(n,t.schema);return la(t,s,e)?CR(t,r):!1},Lx=()=>({state:n,dispatch:e})=>VE(n,e),Fx=n=>({state:e,dispatch:t})=>{const r=ct(n,e.schema);return BR(r)(e,t)},Bx=()=>({state:n,dispatch:e})=>NE(n,e);function Xc(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function ly(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const Ux=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Xc(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=ct(n,r.schema)),a==="mark"&&(o=ys(n,r.schema)),s&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,h)=>{i&&i===c.type&&t.setNodeMarkup(h,void 0,ly(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(f=>{o===f.type&&t.addMark(h,h+c.nodeSize,o.create(ly(f.attrs,e)))})})}),!0):!1},$x=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),zx=()=>({tr:n,dispatch:e})=>{if(e){const t=new an(n.doc);n.setSelection(t)}return!0},jx=()=>({state:n,dispatch:e})=>xE(n,e),Hx=()=>({state:n,dispatch:e})=>OE(n,e),qx=()=>({state:n,dispatch:e})=>PR(n,e),Wx=()=>({state:n,dispatch:e})=>NR(n,e),Kx=()=>({state:n,dispatch:e})=>OR(n,e);function nf(n,e,t={},r={}){return Zl(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const Gx=(n,e=!1,t={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,c;const{doc:h}=i;if(t.preserveWhitespace!=="full"){const f=nf(n,s.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return o&&i.replaceWith(0,h.content.size,f).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:h.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function GE(n,e){const t=ys(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function Jx(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Qx(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function wd(n){return e=>Qx(e.$from,n)}function Yx(n,e){const t={from:0,to:n.content.size};return $E(n,t,e)}function Xx(n,e){const t=ct(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function Zx(n,e){const t=Xc(typeof e=="string"?e:e.name,n.schema);return t==="node"?Xx(n,e):t==="mark"?GE(n,e):{}}function JE(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n),o=Ed(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function Tl(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function rf(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?ys(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>i?i.name===f.type.name:!0).find(f=>Xl(f.attrs,t,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:f,$to:d})=>{const m=f.pos,y=d.pos;n.doc.nodesBetween(m,y,(_,E)=>{if(!_.isText&&!_.marks.length)return;const k=Math.max(m,E),O=Math.min(y,E+_.nodeSize),D=O-k;o+=D,a.push(..._.marks.map(U=>({mark:U,from:k,to:O})))})}),o===0)return!1;const l=a.filter(f=>i?i.name===f.mark.type.name:!0).filter(f=>Xl(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),c=a.filter(f=>i?f.mark.type!==i&&f.mark.type.excludes(i):!0).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+c:l)>=o}function eP(n,e,t={}){if(!e)return la(n,null,t)||rf(n,null,t);const r=Xc(e,n.schema);return r==="node"?la(n,e,t):r==="mark"?rf(n,e,t):!1}function cy(n,e){const{nodeExtensions:t}=Jc(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=Te(re(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function bd(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let s=!0;return n.content.forEach(i=>{s!==!1&&(bd(i,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function tP(n){return n instanceof le}function nP(n,e,t){var r;const{selection:s}=e;let i=null;if(HE(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(h,f,d)=>{if(c)return!1;if(h.isInline){const m=!d||d.type.allowsMarkType(t),y=!!t.isInSet(h.marks)||!h.marks.some(_=>_.type.excludes(t));c=m&&y}return!c}),c})}const rP=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=ys(n,r.schema);if(s)if(o){const c=GE(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const h=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(h,f,(d,m)=>{const y=Math.max(m,h),_=Math.min(m+d.nodeSize,f);d.marks.find(k=>k.type===l)?d.marks.forEach(k=>{l===k.type&&t.addMark(y,_,l.create({...k.attrs,...e}))}):t.addMark(y,_,l.create(e))})});return nP(r,t,l)},sP=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),iP=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=ct(n,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>ry(i,{...o,...e})(t)?!0:a.clearNodes()).command(({state:a})=>ry(i,{...o,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},oP=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=xs(n,0,r.content.size),i=le.create(r,s);e.setSelection(i)}return!0},aP=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=ge.atStart(r).from,a=ge.atEnd(r).to,l=xs(s,o,a),c=xs(i,o,a),h=ge.create(r,l,c);e.setSelection(h)}return!0},lP=n=>({state:e,dispatch:t})=>{const r=ct(n,e.schema);return zR(r)(e,t)};function uy(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const cP=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,h=Tl(c,a.node().type.name,a.node().attrs);if(i instanceof le&&i.node.isBlock)return!a.parentOffset||!cr(o,a.pos)?!1:(r&&(n&&uy(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,d=a.depth===0?void 0:Jx(a.node(-1).contentMatchAt(a.indexAfter(-1)));let m=f&&d?[{type:d,attrs:h}]:void 0,y=cr(e.doc,e.mapping.map(a.pos),1,m);if(!m&&!y&&cr(e.doc,e.mapping.map(a.pos),1,d?[{type:d}]:void 0)&&(y=!0,m=d?[{type:d,attrs:h}]:void 0),r){if(y&&(i instanceof ge&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,m),d&&!f&&!a.parentOffset&&a.parent.type!==d)){const _=e.mapping.map(a.before()),E=e.doc.resolve(_);a.node(-1).canReplaceWith(E.index(),E.index()+1,d)&&e.setNodeMarkup(e.mapping.map(a.before()),d)}n&&uy(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return y},uP=(n,e={})=>({tr:t,state:r,dispatch:s,editor:i})=>{var o;const a=ct(n,r.schema),{$from:l,$to:c}=r.selection,h=r.selection.node;if(h&&h.isBlock||l.depth<2||!l.sameParent(c))return!1;const f=l.node(-1);if(f.type!==a)return!1;const d=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let k=j.empty;const O=l.index(-1)?1:l.index(-2)?2:3;for(let T=l.depth-O;T>=l.depth-3;T-=1)k=j.from(l.node(T).copy(k));const D=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,U={...Tl(d,l.node().type.name,l.node().attrs),...e},X=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(U))||void 0;k=k.append(j.from(a.createAndFill(null,X)||void 0));const Z=l.before(l.depth-(O-1));t.replace(Z,l.after(-D),new Y(k,4-O,0));let A=-1;t.doc.nodesBetween(Z,t.doc.content.size,(T,w)=>{if(A>-1)return!1;T.isTextblock&&T.content.size===0&&(A=w+1)}),A>-1&&t.setSelection(ge.near(t.doc.resolve(A))),t.scrollIntoView()}return!0}const m=c.pos===l.end()?f.contentMatchAt(0).defaultType:null,y={...Tl(d,f.type.name,f.attrs),...e},_={...Tl(d,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const E=m?[{type:a,attrs:y},{type:m,attrs:_}]:[{type:a,attrs:y}];if(!cr(t.doc,l.pos,2))return!1;if(s){const{selection:k,storedMarks:O}=r,{splittableMarks:D}=i.extensionManager,U=O||k.$to.parentOffset&&k.$from.marks();if(t.split(l.pos,2,E).scrollIntoView(),!U||!s)return!0;const X=U.filter(Z=>D.includes(Z.type.name));t.ensureMarks(X)}return!0},lh=(n,e)=>{const t=wd(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&ms(n.doc,t.pos)&&n.join(t.pos),!0},ch=(n,e)=>{const t=wd(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&ms(n.doc,r)&&n.join(r),!0},hP=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:h})=>{const{extensions:f,splittableMarks:d}=s.extensionManager,m=ct(n,o.schema),y=ct(e,o.schema),{selection:_,storedMarks:E}=o,{$from:k,$to:O}=_,D=k.blockRange(O),U=E||_.$to.parentOffset&&_.$from.marks();if(!D)return!1;const X=wd(Z=>cy(Z.type.name,f))(_);if(D.depth>=1&&X&&D.depth-X.depth<=1){if(X.node.type===m)return c.liftListItem(y);if(cy(X.node.type.name,f)&&m.validContent(X.node.content)&&a)return l().command(()=>(i.setNodeMarkup(X.pos,m),!0)).command(()=>lh(i,m)).command(()=>ch(i,m)).run()}return!t||!U||!a?l().command(()=>h().wrapInList(m,r)?!0:c.clearNodes()).wrapInList(m,r).command(()=>lh(i,m)).command(()=>ch(i,m)).run():l().command(()=>{const Z=h().wrapInList(m,r),A=U.filter(T=>d.includes(T.type.name));return i.ensureMarks(A),Z?!0:c.clearNodes()}).wrapInList(m,r).command(()=>lh(i,m)).command(()=>ch(i,m)).run()},fP=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=ys(n,r.schema);return rf(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},dP=(n,e,t={})=>({state:r,commands:s})=>{const i=ct(n,r.schema),o=ct(e,r.schema),a=la(r,i,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...t})},pP=(n,e={})=>({state:t,commands:r})=>{const s=ct(n,t.schema);return la(t,s,e)?r.lift(s):r.wrapIn(s,e)},mP=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},gP=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},yP=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=ys(n,r.schema),{$from:c,empty:h,ranges:f}=a;if(!s)return!0;if(h&&o){let{from:d,to:m}=a;const y=(i=c.marks().find(E=>E.type===l))===null||i===void 0?void 0:i.attrs,_=Ed(c,l,y);_&&(d=_.from,m=_.to),t.removeMark(d,m,l)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,l)});return t.removeStoredMark(l),!0},_P=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Xc(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=ct(n,r.schema)),a==="mark"&&(o=ys(n,r.schema)),s&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,h=l.$to.pos;let f,d,m,y;t.selection.empty?r.doc.nodesBetween(c,h,(_,E)=>{i&&i===_.type&&(m=Math.max(E,c),y=Math.min(E+_.nodeSize,h),f=E,d=_)}):r.doc.nodesBetween(c,h,(_,E)=>{E<c&&i&&i===_.type&&(m=Math.max(E,c),y=Math.min(E+_.nodeSize,h),f=E,d=_),E>=c&&E<=h&&(i&&i===_.type&&t.setNodeMarkup(E,void 0,{..._.attrs,...e}),o&&_.marks.length&&_.marks.forEach(k=>{if(o===k.type){const O=Math.max(E,c),D=Math.min(E+_.nodeSize,h);t.addMark(O,D,o.create({...k.attrs,...e}))}}))}),d&&(f!==void 0&&t.setNodeMarkup(f,void 0,{...d.attrs,...e}),o&&d.marks.length&&d.marks.forEach(_=>{o===_.type&&t.addMark(m,y,o.create({..._.attrs,...e}))}))}),!0):!1},vP=(n,e={})=>({state:t,dispatch:r})=>{const s=ct(n,t.schema);return DR(s,e)(t,r)},EP=(n,e={})=>({state:t,dispatch:r})=>{const s=ct(n,t.schema);return VR(s,e)(t,r)};var TP=Object.freeze({__proto__:null,blur:ix,clearContent:ox,clearNodes:ax,command:lx,createParagraphNear:cx,cut:ux,deleteCurrentNode:hx,deleteNode:fx,deleteRange:dx,deleteSelection:px,enter:mx,exitCode:gx,extendMarkRange:yx,first:_x,focus:Ex,forEach:Tx,insertContent:wx,insertContentAt:Sx,joinBackward:kx,joinDown:Cx,joinForward:Rx,joinItemBackward:xx,joinItemForward:Px,joinTextblockBackward:Mx,joinTextblockForward:Ox,joinUp:Ax,keyboardShortcut:Dx,lift:Vx,liftEmptyBlock:Lx,liftListItem:Fx,newlineInCode:Bx,resetAttributes:Ux,scrollIntoView:$x,selectAll:zx,selectNodeBackward:jx,selectNodeForward:Hx,selectParentNode:qx,selectTextblockEnd:Wx,selectTextblockStart:Kx,setContent:Gx,setMark:rP,setMeta:sP,setNode:iP,setNodeSelection:oP,setTextSelection:aP,sinkListItem:lP,splitBlock:cP,splitListItem:uP,toggleList:hP,toggleMark:fP,toggleNode:dP,toggleWrap:pP,undoInputRule:mP,unsetAllMarks:gP,unsetMark:yP,updateAttributes:_P,wrapIn:vP,wrapInList:EP});const wP=jt.create({name:"commands",addCommands(){return{...TP}}}),bP=jt.create({name:"drop",addProseMirrorPlugins(){return[new en({key:new Qn("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),IP=jt.create({name:"editable",addProseMirrorPlugins(){return[new en({key:new Qn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),SP=new Qn("focusEvents"),AP=jt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new en({key:SP,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),CP=jt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:h,$anchor:f}=l,{pos:d,parent:m}=f,y=f.parent.isTextblock&&d>0?a.doc.resolve(d-1):f,_=y.parent.type.spec.isolating,E=f.pos-f.parentOffset,k=_&&y.parent.childCount===1?E===f.pos:Ee.atStart(c).from===d;return!h||!m.type.isTextblock||m.textContent.length||!k||k&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Td()||KE()?i:s},addProseMirrorPlugins(){return[new en({key:new Qn("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(_=>_.getMeta("composition")))return;const r=n.some(_=>_.docChanged)&&!e.doc.eq(t.doc),s=n.some(_=>_.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=e.selection,l=Ee.atStart(e.doc).from,c=Ee.atEnd(e.doc).to;if(i||!(o===l&&a===c)||!bd(t.doc))return;const d=t.tr,m=Kc({state:t,transaction:d}),{commands:y}=new Gc({editor:this.editor,state:m});if(y.clearNodes(),!!d.steps.length)return d}})]}}),kP=jt.create({name:"paste",addProseMirrorPlugins(){return[new en({key:new Qn("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),RP=jt.create({name:"tabindex",addProseMirrorPlugins(){return[new en({key:new Qn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Cs{get name(){return this.node.type.name}constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Cs(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Cs(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Cs(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+r+(i?0:1),a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new Cs(a,this.editor,s,s?t:null);s&&(l.actualDepth=this.depth+1),e.push(new Cs(a,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(t);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>t[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,t,r))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const xP=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function PP(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}let MP=class extends jR{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:s})=>this.options.onDrop(t,r,s)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=PP(xP,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=UE(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(o))}),t.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[IP,sx.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),wP,AP,CP,RP,bP,kP].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new _i(s,this)}createCommandManager(){this.commandManager=new Gc({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=nf(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=nf(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=qE(t,this.options.autofocus);this.view=new fR(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:yi.create({doc:t,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Zx(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return eP(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return _d(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Yx(this.state.doc,{blockSeparator:t,textSerializers:{...zE(this.schema),...r}})}get isEmpty(){return bd(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Cs(t,this)}get $doc(){return this.$pos(0)}};function Bi(n){return new Qc({find:n.find,handler:({state:e,range:t,match:r})=>{const s=Te(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),h=c+o.length;if(JE(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(_=>_===n.type&&_!==m.mark.type)).filter(m=>m.to>c).length)return null;h<t.to&&i.delete(h,t.to),c>t.from&&i.delete(t.from+l,c);const d=t.from+l+o.length;i.addMark(t.from+l,d,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function OP(n){return new Qc({find:n.find,handler:({state:e,range:t,match:r})=>{const s=Te(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let h=o+c;h>a?h=a:a=h+r[1].length;const f=r[0][r[0].length-1];i.insertText(f,o+r[0].length-1),i.replaceWith(h,a,l)}else if(r[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function sf(n){return new Qc({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=Te(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function ca(n){return new Qc({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=Te(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&nd(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:f,storedMarks:d}=e,{splittableMarks:m}=n.editor.extensionManager,y=d||f.$to.parentOffset&&f.$from.marks();if(y){const _=y.filter(E=>m.includes(E.type.name));o.ensureMarks(_)}}if(n.keepAttributes){const f=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(f,i).run()}const h=o.doc.resolve(t.from-1).nodeBefore;h&&h.type===n.type&&ms(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,h))&&o.join(t.from-1)}})}class Zt{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Te(re(this,"addOptions",{name:this.name}))),this.storage=Te(re(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Zt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Yc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Zt(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=Te(re(t,"addOptions",{name:t.name})),t.storage=Te(re(t,"addStorage",{name:t.name,options:t.options})),t}}function Ui(n){return new XR({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=Te(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const h=l.search(/\S/),f=t.from+l.indexOf(a),d=f+a.length;if(JE(t.from,t.to,e.doc).filter(y=>y.mark.type.excluded.find(E=>E===n.type&&E!==y.mark.type)).filter(y=>y.to>f).length)return null;d<t.to&&o.delete(d,t.to),f>t.from&&o.delete(t.from+h,f),c=t.from+h+a.length,o.addMark(t.from+h,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function hy(n){return D1((e,t)=>({get(){return e(),n},set(r){n=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}}))}let NP=class extends MP{constructor(e={}){return super(e),this.contentComponent=null,this.appContext=null,this.reactiveState=hy(this.view.state),this.reactiveExtensionStorage=hy(this.extensionStorage),this.on("beforeTransaction",({nextState:t})=>{this.reactiveState.value=t,this.reactiveExtensionStorage.value=this.extensionStorage}),v0(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,t){const r=super.registerPlugin(e,t);return this.reactiveState&&(this.reactiveState.value=r),r}unregisterPlugin(e){const t=super.unregisterPlugin(e);return this.reactiveState&&t&&(this.reactiveState.value=t),t}};const DP=Pc({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const e=Qt(),t=UI();return II(()=>{const r=n.editor;r&&r.options.element&&e.value&&jf(()=>{if(!e.value||!r.options.element.firstChild)return;const s=$n(e.value);e.value.append(...r.options.element.childNodes),r.contentComponent=t.ctx._,t&&(r.appContext={...t.appContext,provides:t.provides}),r.setOptions({element:s}),r.createNodeViews()})}),Nc(()=>{const r=n.editor;r&&(r.contentComponent=null,r.appContext=null)}),{rootEl:e}},render(){return Yf("div",{ref:n=>{this.rootEl=n}})}}),VP=(n={})=>{const e=E0();return Oc(()=>{e.value=new NP(n)}),Nc(()=>{var t,r,s;const i=(t=e.value)===null||t===void 0?void 0:t.options.element,o=i==null?void 0:i.cloneNode(!0);(r=i==null?void 0:i.parentNode)===null||r===void 0||r.replaceChild(o,i),(s=e.value)===null||s===void 0||s.destroy()}),e},LP=/^\s*>\s$/,FP=Zt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[ca({find:LP,type:this.type})]}}),BP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,UP=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,$P=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,zP=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,jP=is.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Bi({find:BP,type:this.type}),Bi({find:$P,type:this.type})]},addPasteRules(){return[Ui({find:UP,type:this.type}),Ui({find:zP,type:this.type})]}}),HP="listItem",fy="textStyle",dy=/^\s*([-+*])\s$/,qP=Zt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(HP,this.editor.getAttributes(fy)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=ca({find:dy,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=ca({find:dy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(fy),editor:this.editor})),[n]}}),WP=/(^|[^`])`([^`]+)`(?!`)/,KP=/(^|[^`])`([^`]+)`(?!`)/g,GP=is.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Bi({find:WP,type:this.type})]},addPasteRules(){return[Ui({find:KP,type:this.type})]}}),JP=/^```([a-z]+)?[\s\n]$/,QP=/^~~~([a-z]+)?[\s\n]$/,YP=Zt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",zt(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(Ee.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[sf({find:JP,type:this.type,getAttributes:n=>({language:n[1]})}),sf({find:QP,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new en({key:new Qn("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!t||!i)return!1;const{tr:o,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(ge.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),XP=Zt.create({name:"doc",topNode:!0,content:"block+"});function ZP(n={}){return new en({view(e){return new eM(e,n)}})}class eM{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,a=i.height/s.offsetHeight;if(t){let f=e.nodeBefore,d=e.nodeAfter;if(f||d){let m=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(m){let y=m.getBoundingClientRect(),_=f?y.bottom:y.top;f&&d&&(_=(_+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let E=this.width/2*a;r={left:y.left,right:y.right,top:_-E,bottom:_+E}}}}if(!r){let f=this.editorView.coordsAtPos(this.cursorPos),d=this.width/2*o;r={left:f.left-d,right:f.left+d,top:f.top,bottom:f.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,h;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,h=-pageYOffset;else{let f=l.getBoundingClientRect(),d=f.width/l.offsetWidth,m=f.height/l.offsetHeight;c=f.left-l.scrollLeft*d,h=f.top-l.scrollTop*m}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-h)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Uv(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const tM=jt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[ZP(this.options)]}});class Je extends Ee{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Je.valid(r)?new Je(r):Ee.near(r)}content(){return Y.empty}eq(e){return e instanceof Je&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Je(e.resolve(t.pos))}getBookmark(){return new Id(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!nM(e)||!rM(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Je.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let l=e.doc.resolve(s);if(Je.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!le.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let a=e.doc.resolve(s);if(Je.valid(a))return a}return null}}}Je.prototype.visible=!1;Je.findFrom=Je.findGapCursorFrom;Ee.jsonID("gapcursor",Je);class Id{constructor(e){this.pos=e}map(e){return new Id(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Je.valid(t)?new Je(t):Ee.near(t)}}function nM(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function rM(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function sM(){return new en({props:{decorations:lM,createSelectionBetween(n,e,t){return e.pos==t.pos&&Je.valid(t)?new Je(t):null},handleClick:oM,handleKeyDown:iM,handleDOMEvents:{beforeinput:aM}}})}const iM=AE({ArrowLeft:al("horiz",-1),ArrowRight:al("horiz",1),ArrowUp:al("vert",-1),ArrowDown:al("vert",1)});function al(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ge){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Je.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new Je(c))),!0):!1}}function oM(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Je.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&le.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Je(r))),!0)}function aM(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Je))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=j.empty;for(let o=r.length-1;o>=0;o--)s=j.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new Y(s,0,0));return i.setSelection(ge.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function lM(n){if(!(n.selection instanceof Je))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",nt.create(n.doc,[gn.widget(n.selection.head,e,{key:"gapcursor"})])}const cM=jt.create({name:"gapCursor",addProseMirrorPlugins(){return[sM()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=Te(re(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),uM=Zt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",zt(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:h})=>{if(h&&l&&o){const f=l.filter(d=>a.includes(d.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),hM=Zt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,zt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>sf({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var ec=200,lt=function(){};lt.prototype.append=function(e){return e.length?(e=lt.from(e),!this.length&&e||e.length<ec&&this.leafAppend(e)||this.length<ec&&e.leafPrepend(this)||this.appendInner(e)):this};lt.prototype.prepend=function(e){return e.length?lt.from(e).append(this):this};lt.prototype.appendInner=function(e){return new fM(this,e)};lt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?lt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};lt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};lt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};lt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};lt.from=function(e){return e instanceof lt?e:e&&e.length?new QE(e):lt.empty};var QE=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=ec)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=ec)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(lt);lt.empty=new QE([]);var fM=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(lt);const dM=500;class wn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],h=[];return this.items.forEach((f,d)=>{if(!f.step){s||(s=this.remapping(r,d+1),i=s.maps.length),i--,h.push(f);return}if(s){h.push(new Vn(f.map));let m=f.step.map(s.slice(i)),y;m&&o.maybeStep(m).doc&&(y=o.mapping.maps[o.mapping.maps.length-1],c.push(new Vn(y,void 0,void 0,c.length+h.length))),i--,y&&s.appendMap(y,i)}else o.maybeStep(f.step);if(f.selection)return a=s?f.selection.map(s.slice(i)):f.selection,l=new wn(this.items.slice(0,r).append(h.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let h=0;h<e.steps.length;h++){let f=e.steps[h].invert(e.docs[h]),d=new Vn(e.mapping.maps[h],f,t),m;(m=l&&l.merge(d))&&(d=m,h?i.pop():a=a.slice(0,a.length-1)),i.push(d),t&&(o++,t=void 0),s||(l=d)}let c=o-r.depth;return c>mM&&(a=pM(a,c),o-=c),new wn(a.append(i),o)}remapping(e,t){let r=new ra;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new wn(this.items.append(e.map(t=>new Vn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(d=>{d.selection&&a--},s);let l=t;this.items.forEach(d=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let y=i.maps[m];if(d.step){let _=e.steps[m].invert(e.docs[m]),E=d.selection&&d.selection.map(i.slice(l+1,m));E&&a++,r.push(new Vn(y,_,E))}else r.push(new Vn(y))},s);let c=[];for(let d=t;d<o;d++)c.push(new Vn(i.maps[d]));let h=this.items.slice(0,s).append(c).append(r),f=new wn(h,a);return f.emptyItemCount()>dM&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let h=o.selection&&o.selection.map(t.slice(r));h&&i++;let f=new Vn(c.invert(),l,h),d,m=s.length-1;(d=s.length&&s[m].merge(f))?s[m]=d:s.push(f)}}else o.map&&r--},this.items.length,0),new wn(lt.from(s.reverse()),i)}}wn.empty=new wn(lt.empty,0);function pM(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class Vn{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Vn(t.getMap().invert(),t,this.selection)}}}class Or{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const mM=20;function gM(n,e,t,r){let s=t.getMeta(Ls),i;if(s)return s.historyState;t.getMeta(vM)&&(n=new Or(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Ls))return o.getMeta(Ls).redo?new Or(n.done.addTransform(t,void 0,r,wl(e)),n.undone,py(t.mapping.maps),n.prevTime,n.prevComposition):new Or(n.done,n.undone.addTransform(t,void 0,r,wl(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!yM(t,n.prevRanges)),c=o?uh(n.prevRanges,t.mapping):py(t.mapping.maps);return new Or(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,wl(e)),wn.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Or(n.done.rebased(t,i),n.undone.rebased(t,i),uh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Or(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),uh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function yM(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function py(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,o)=>e.push(i,o));return e}function uh(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function _M(n,e,t){let r=wl(e),s=Ls.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new Or(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(Ls,{redo:t,historyState:l})}let hh=!1,my=null;function wl(n){let e=n.plugins;if(my!=e){hh=!1,my=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){hh=!0;break}}return hh}const Ls=new Qn("history"),vM=new Qn("closeHistory");function EM(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new en({key:Ls,state:{init(){return new Or(wn.empty,wn.empty,null,0,-1)},apply(e,t,r){return gM(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?XE:r=="historyRedo"?ZE:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function YE(n,e){return(t,r)=>{let s=Ls.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=_M(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const XE=YE(!1,!0),ZE=YE(!0,!0),TM=jt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>XE(n,e),redo:()=>({state:n,dispatch:e})=>ZE(n,e)}},addProseMirrorPlugins(){return[EM(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),wM=Zt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",zt(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{selection:t}=e,{$from:r,$to:s}=t,i=n();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):tP(t)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:c}=o.selection,h=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(ge.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(le.create(o.doc,c.pos)):o.setSelection(ge.create(o.doc,c.pos));else{const f=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();f&&(o.insert(h,f),o.setSelection(ge.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[OP({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),bM=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,IM=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,SM=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,AM=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,CM=is.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Bi({find:bM,type:this.type}),Bi({find:SM,type:this.type})]},addPasteRules(){return[Ui({find:IM,type:this.type}),Ui({find:AM,type:this.type})]}}),kM=Zt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",zt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),RM="listItem",gy="textStyle",yy=/^(\d+)\.\s$/,xM=Zt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",zt(this.options.HTMLAttributes,t),0]:["ol",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(RM,this.editor.getAttributes(gy)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=ca({find:yy,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=ca({find:yy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(gy)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),PM=Zt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),MM=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,OM=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,NM=is.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Bi({find:MM,type:this.type})]},addPasteRules(){return[Ui({find:OM,type:this.type})]}}),DM=Zt.create({name:"text",group:"inline"}),VM=jt.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(jP.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(FP.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(qP.configure(this.options.bulletList)),this.options.code!==!1&&n.push(GP.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(YP.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(XP.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(tM.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(cM.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(uM.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(hM.configure(this.options.heading)),this.options.history!==!1&&n.push(TM.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(wM.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(CM.configure(this.options.italic)),this.options.listItem!==!1&&n.push(kM.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(xM.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(PM.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(NM.configure(this.options.strike)),this.options.text!==!1&&n.push(DM.configure(this.options.text)),n}}),LM={class:"rich-editor-wrap"},FM={class:"toolbar"},BM=["title","onClick","innerHTML"],UM={__name:"Editor",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,r=e,s=VP({content:t.modelValue,extensions:[VM],onUpdate:({editor:a})=>{r("update:modelValue",a.getHTML())}});Nc(()=>{var a,l;return(l=(a=s.value)==null?void 0:a.destroy)==null?void 0:l.call(a)});const i={bold:'<svg  viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 2.5C5.17157 2.5 4.5 3.17157 4.5 4V20C4.5 20.8284 5.17157 21.5 6 21.5H15C16.4587 21.5 17.8576 20.9205 18.8891 19.8891C19.9205 18.8576 20.5 17.4587 20.5 16C20.5 14.5413 19.9205 13.1424 18.8891 12.1109C18.6781 11.9 18.4518 11.7079 18.2128 11.5359C19.041 10.5492 19.5 9.29829 19.5 8C19.5 6.54131 18.9205 5.14236 17.8891 4.11091C16.8576 3.07946 15.4587 2.5 14 2.5H6ZM14 10.5C14.663 10.5 15.2989 10.2366 15.7678 9.76777C16.2366 9.29893 16.5 8.66304 16.5 8C16.5 7.33696 16.2366 6.70107 15.7678 6.23223C15.2989 5.76339 14.663 5.5 14 5.5H7.5V10.5H14ZM7.5 18.5V13.5H15C15.663 13.5 16.2989 13.7634 16.7678 14.2322C17.2366 14.7011 17.5 15.337 17.5 16C17.5 16.663 17.2366 17.2989 16.7678 17.7678C16.2989 18.2366 15.663 18.5 15 18.5H7.5Z" fill="currentColor"></path></svg>',italic:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.0222 3H19C19.5523 3 20 3.44772 20 4C20 4.55228 19.5523 5 19 5H15.693L10.443 19H14C14.5523 19 15 19.4477 15 20C15 20.5523 14.5523 21 14 21H9.02418C9.00802 21.0004 8.99181 21.0004 8.97557 21H5C4.44772 21 4 20.5523 4 20C4 19.4477 4.44772 19 5 19H8.30704L13.557 5H10C9.44772 5 9 4.55228 9 4C9 3.44772 9.44772 3 10 3H14.9782C14.9928 2.99968 15.0075 2.99967 15.0222 3Z" fill="currentColor"></path></svg>',heading1:'<svg viewBox="0 0 24 24" stroke="currentColor"><path d="M4 6v12M4 12h8M12 6v12M17 12h3M20 12v6" /></svg>',heading2:'<svg viewBox="0 0 24 24" stroke="currentColor"><path d="M4 6v12M4 12h8M12 6v12M17 10c0-1.1.9-2 2-2s2 .9 2 2c0 1.1-2 1.5-2 3h2m-2 3h2" /></svg>',paragraph:'<svg viewBox="0 0 24 24" stroke="currentColor"><path d="M6 4h12M6 8h12M6 12h8m-8 4h6" /></svg>',ul:'<svg viewBox="0 0 24 24" stroke="currentColor"><circle cx="4" cy="6" r="1.5"/><circle cx="4" cy="12" r="1.5"/><circle cx="4" cy="18" r="1.5"/><line x1="8" y1="6" x2="20" y2="6"/><line x1="8" y1="12" x2="20" y2="12"/><line x1="8" y1="18" x2="20" y2="18"/></svg>',ol:'<svg viewBox="0 0 24 24" stroke="currentColor"><text x="2" y="7" font-size="6">1.</text><text x="2" y="13" font-size="6">2.</text><text x="2" y="19" font-size="6">3.</text><line x1="8" y1="6" x2="20" y2="6"/><line x1="8" y1="12" x2="20" y2="12"/><line x1="8" y1="18" x2="20" y2="18"/></svg>'},o=Jt(()=>s.value?[[{name:"bold",svg:i.bold,tooltip:"Bold",action:()=>s.value.chain().focus().toggleBold().run(),isActive:()=>s.value.isActive("bold")},{name:"italic",svg:i.italic,tooltip:"Italic",action:()=>s.value.chain().focus().toggleItalic().run(),isActive:()=>s.value.isActive("italic")}],[{name:"heading1",svg:i.heading1,tooltip:"Heading 1",action:()=>s.value.chain().focus().toggleHeading({level:1}).run(),isActive:()=>s.value.isActive("heading",{level:1})},{name:"heading2",svg:i.heading2,tooltip:"Heading 2",action:()=>s.value.chain().focus().toggleHeading({level:2}).run(),isActive:()=>s.value.isActive("heading",{level:2})},{name:"paragraph",svg:i.paragraph,tooltip:"Paragraph",action:()=>s.value.chain().focus().setParagraph().run(),isActive:()=>s.value.isActive("paragraph")}],[{name:"ul",svg:i.ul,tooltip:"Bullet List",action:()=>s.value.chain().focus().toggleBulletList().run(),isActive:()=>s.value.isActive("bulletList")},{name:"ol",svg:i.ol,tooltip:"Ordered List",action:()=>s.value.chain().focus().toggleOrderedList().run(),isActive:()=>s.value.isActive("orderedList")}]]:[]);return(a,l)=>(De(),ze("div",LM,[fe("div",FM,[(De(!0),ze(Gt,null,Rh(o.value,(c,h)=>(De(),ze("div",{key:h,class:"item-group"},[(De(!0),ze(Gt,null,Rh(c,f=>{var d;return De(),ze("button",{key:f.name,title:f.tooltip,onClick:f.action,innerHTML:f.svg,class:Ac(["item",(d=f.isActive)!=null&&d.call(f)?"bg-gray-200":""])},null,10,BM)}),128))]))),128))]),We($n(DP),{editor:$n(s),class:"rich-editor"},null,8,["editor"])]))}},$M=Mn(UM,[["__scopeId","data-v-724d4451"]]),zM=()=>{};var _y={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},jM=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},tT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,h=i>>2,f=(i&3)<<4|a>>4;let d=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(d=64)),r.push(t[h],t[f],t[d],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(eT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):jM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new HM;const d=i<<2|a>>4;if(r.push(d),c!==64){const m=a<<4&240|c>>2;if(r.push(m),f!==64){const y=c<<6&192|f;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class HM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qM=function(n){const e=eT(n);return tT.encodeByteArray(e,!0)},tc=function(n){return qM(n).replace(/\./g,"")},nT=function(n){try{return tT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=()=>WM().__FIREBASE_DEFAULTS__,GM=()=>{if(typeof process>"u"||typeof _y>"u")return;const n=_y.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},JM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&nT(n[1]);return e&&JSON.parse(e)},Zc=()=>{try{return zM()||KM()||GM()||JM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},rT=n=>{var e,t;return(t=(e=Zc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},QM=n=>{const e=rT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},sT=()=>{var n;return(n=Zc())===null||n===void 0?void 0:n.config},iT=n=>{var e;return(e=Zc())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(n){return n.endsWith(".cloudworkstations.dev")}async function oT(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[tc(JSON.stringify(t)),tc(JSON.stringify(o)),""].join(".")}const $o={};function ZM(){const n={prod:[],emulator:[]};for(const e of Object.keys($o))$o[e]?n.emulator.push(e):n.prod.push(e);return n}function eO(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let vy=!1;function aT(n,e){if(typeof window>"u"||typeof document>"u"||!Aa(window.location.host)||$o[n]===e||$o[n]||vy)return;$o[n]=e;function t(d){return`__firebase__banner__${d}`}const r="__firebase__banner",i=ZM().prod.length>0;function o(){const d=document.getElementById(r);d&&d.remove()}function a(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,m){d.setAttribute("width","24"),d.setAttribute("id",m),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{vy=!0,o()},d}function h(d,m){d.setAttribute("id",m),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function f(){const d=eO(r),m=t("text"),y=document.getElementById(m)||document.createElement("span"),_=t("learnmore"),E=document.getElementById(_)||document.createElement("a"),k=t("preprendIcon"),O=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const D=d.element;a(D),h(E,_);const U=c();l(O,k),D.append(O,y,E,U),document.body.appendChild(D)}i?(y.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function nO(){var n;const e=(n=Zc())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sO(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function iO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oO(){const n=Ot();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function aO(){return!nO()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lO(){try{return typeof indexedDB=="object"}catch{return!1}}function cO(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO="FirebaseError";class Er extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=uO,Object.setPrototypeOf(this,Er.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ca.prototype.create)}}class Ca{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?hO(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Er(s,a,r)}}function hO(n,e){return n.replace(fO,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const fO=/\{\$([^}]+)}/g;function dO(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function js(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Ey(i)&&Ey(o)){if(!js(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Ey(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ka(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function pO(n,e){const t=new mO(n,e);return t.subscribe.bind(t)}class mO{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");gO(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=fh),s.error===void 0&&(s.error=fh),s.complete===void 0&&(s.complete=fh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gO(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function fh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(n){return n&&n._delegate?n._delegate:n}class Hs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new YM;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vO(e))try{this.getOrInitializeService({instanceIdentifier:Ss})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ss){return this.instances.has(e)}getOptions(e=Ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:_O(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ss){return this.component?this.component.multipleInstances?e:Ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _O(n){return n===Ss?void 0:n}function vO(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yO(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ie||(Ie={}));const TO={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},wO=Ie.INFO,bO={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},IO=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=bO[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Sd{constructor(e){this.name=e,this._logLevel=wO,this._logHandler=IO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const SO=(n,e)=>e.some(t=>n instanceof t);let Ty,wy;function AO(){return Ty||(Ty=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CO(){return wy||(wy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lT=new WeakMap,of=new WeakMap,cT=new WeakMap,dh=new WeakMap,Ad=new WeakMap;function kO(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Qr(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&lT.set(t,n)}).catch(()=>{}),Ad.set(e,n),e}function RO(n){if(of.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});of.set(n,e)}let af={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return of.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function xO(n){af=n(af)}function PO(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ph(this),e,...t);return cT.set(r,e.sort?e.sort():[e]),Qr(r)}:CO().includes(n)?function(...e){return n.apply(ph(this),e),Qr(lT.get(this))}:function(...e){return Qr(n.apply(ph(this),e))}}function MO(n){return typeof n=="function"?PO(n):(n instanceof IDBTransaction&&RO(n),SO(n,AO())?new Proxy(n,af):n)}function Qr(n){if(n instanceof IDBRequest)return kO(n);if(dh.has(n))return dh.get(n);const e=MO(n);return e!==n&&(dh.set(n,e),Ad.set(e,n)),e}const ph=n=>Ad.get(n);function OO(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Qr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Qr(o.result),l.oldVersion,l.newVersion,Qr(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const NO=["get","getKey","getAll","getAllKeys","count"],DO=["put","add","delete","clear"],mh=new Map;function by(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(mh.get(e))return mh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=DO.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||NO.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return mh.set(e,i),i}xO(n=>({...n,get:(e,t,r)=>by(e,t)||n.get(e,t,r),has:(e,t)=>!!by(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(LO(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function LO(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lf="@firebase/app",Iy="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr=new Sd("@firebase/app"),FO="@firebase/app-compat",BO="@firebase/analytics-compat",UO="@firebase/analytics",$O="@firebase/app-check-compat",zO="@firebase/app-check",jO="@firebase/auth",HO="@firebase/auth-compat",qO="@firebase/database",WO="@firebase/data-connect",KO="@firebase/database-compat",GO="@firebase/functions",JO="@firebase/functions-compat",QO="@firebase/installations",YO="@firebase/installations-compat",XO="@firebase/messaging",ZO="@firebase/messaging-compat",eN="@firebase/performance",tN="@firebase/performance-compat",nN="@firebase/remote-config",rN="@firebase/remote-config-compat",sN="@firebase/storage",iN="@firebase/storage-compat",oN="@firebase/firestore",aN="@firebase/ai",lN="@firebase/firestore-compat",cN="firebase",uN="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="[DEFAULT]",hN={[lf]:"fire-core",[FO]:"fire-core-compat",[UO]:"fire-analytics",[BO]:"fire-analytics-compat",[zO]:"fire-app-check",[$O]:"fire-app-check-compat",[jO]:"fire-auth",[HO]:"fire-auth-compat",[qO]:"fire-rtdb",[WO]:"fire-data-connect",[KO]:"fire-rtdb-compat",[GO]:"fire-fn",[JO]:"fire-fn-compat",[QO]:"fire-iid",[YO]:"fire-iid-compat",[XO]:"fire-fcm",[ZO]:"fire-fcm-compat",[eN]:"fire-perf",[tN]:"fire-perf-compat",[nN]:"fire-rc",[rN]:"fire-rc-compat",[sN]:"fire-gcs",[iN]:"fire-gcs-compat",[oN]:"fire-fst",[lN]:"fire-fst-compat",[aN]:"fire-vertex","fire-js":"fire-js",[cN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc=new Map,fN=new Map,uf=new Map;function Sy(n,e){try{n.container.addComponent(e)}catch(t){pr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $i(n){const e=n.name;if(uf.has(e))return pr.debug(`There were multiple attempts to register component ${e}.`),!1;uf.set(e,n);for(const t of nc.values())Sy(t,n);for(const t of fN.values())Sy(t,n);return!0}function Cd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function bn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yr=new Ca("app","Firebase",dN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Hs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=uN;function uT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:cf,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Yr.create("bad-app-name",{appName:String(s)});if(t||(t=sT()),!t)throw Yr.create("no-options");const i=nc.get(s);if(i){if(js(t,i.options)&&js(r,i.config))return i;throw Yr.create("duplicate-app",{appName:s})}const o=new EO(s);for(const l of uf.values())o.addComponent(l);const a=new pN(t,r,o);return nc.set(s,a),a}function hT(n=cf){const e=nc.get(n);if(!e&&n===cf&&sT())return uT();if(!e)throw Yr.create("no-app",{appName:n});return e}function Xr(n,e,t){var r;let s=(r=hN[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pr.warn(a.join(" "));return}$i(new Hs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN="firebase-heartbeat-database",gN=1,ua="firebase-heartbeat-store";let gh=null;function fT(){return gh||(gh=OO(mN,gN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ua)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yr.create("idb-open",{originalErrorMessage:n.message})})),gh}async function yN(n){try{const t=(await fT()).transaction(ua),r=await t.objectStore(ua).get(dT(n));return await t.done,r}catch(e){if(e instanceof Er)pr.warn(e.message);else{const t=Yr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pr.warn(t.message)}}}async function Ay(n,e){try{const r=(await fT()).transaction(ua,"readwrite");await r.objectStore(ua).put(e,dT(n)),await r.done}catch(t){if(t instanceof Er)pr.warn(t.message);else{const r=Yr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});pr.warn(r.message)}}}function dT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=1024,vN=30;class EN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Cy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>vN){const o=bN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){pr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Cy(),{heartbeatsToSend:r,unsentEntries:s}=TN(this._heartbeatsCache.heartbeats),i=tc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return pr.warn(t),""}}}function Cy(){return new Date().toISOString().substring(0,10)}function TN(n,e=_N){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),ky(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),ky(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class wN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lO()?cO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ay(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ay(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ky(n){return tc(JSON.stringify({version:2,heartbeats:n})).length}function bN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(n){$i(new Hs("platform-logger",e=>new VO(e),"PRIVATE")),$i(new Hs("heartbeat",e=>new EN(e),"PRIVATE")),Xr(lf,Iy,n),Xr(lf,Iy,"esm2017"),Xr("fire-js","")}IN("");var SN="firebase",AN="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr(SN,AN,"app");function kd(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function pT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CN=pT,mT=new Ca("auth","Firebase",pT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rc=new Sd("@firebase/auth");function kN(n,...e){rc.logLevel<=Ie.WARN&&rc.warn(`Auth (${Qi}): ${n}`,...e)}function bl(n,...e){rc.logLevel<=Ie.ERROR&&rc.error(`Auth (${Qi}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(n,...e){throw Rd(n,...e)}function zn(n,...e){return Rd(n,...e)}function gT(n,e,t){const r=Object.assign(Object.assign({},CN()),{[e]:t});return new Ca("auth","Firebase",r).create(e,{appName:n.name})}function Zr(n){return gT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Rd(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return mT.create(n,...e)}function de(n,e,...t){if(!n)throw Rd(e,...t)}function ar(n){const e="INTERNAL ASSERTION FAILED: "+n;throw bl(e),new Error(e)}function gr(n,e){n||ar(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function RN(){return Ry()==="http:"||Ry()==="https:"}function Ry(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(RN()||sO()||"connection"in navigator)?navigator.onLine:!0}function PN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t){this.shortDelay=e,this.longDelay=t,gr(t>e,"Short delay should be less than long delay!"),this.isMobile=tO()||iO()}get(){return xN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(n,e){gr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ar("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ar("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ar("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],NN=new Ra(3e4,6e4);function eu(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Yi(n,e,t,r,s={}){return _T(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=ka(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return rO()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&Aa(n.emulatorConfig.host)&&(c.credentials="include"),yT.fetch()(await ET(n,n.config.apiHost,t,a),c)})}async function _T(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},MN),e);try{const s=new DN(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ll(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ll(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ll(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw ll(n,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw gT(n,h,c);mr(n,h)}}catch(s){if(s instanceof Er)throw s;mr(n,"network-request-failed",{message:String(s)})}}async function vT(n,e,t,r,s={}){const i=await Yi(n,e,t,r,s);return"mfaPendingCredential"in i&&mr(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function ET(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?xd(n.config,s):`${n.config.apiScheme}://${s}`;return ON.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class DN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(zn(this.auth,"network-request-failed")),NN.get())})}}function ll(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=zn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VN(n,e){return Yi(n,"POST","/v1/accounts:delete",e)}async function sc(n,e){return Yi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LN(n,e=!1){const t=Ht(n),r=await t.getIdToken(e),s=Pd(r);de(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:zo(yh(s.auth_time)),issuedAtTime:zo(yh(s.iat)),expirationTime:zo(yh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function yh(n){return Number(n)*1e3}function Pd(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return bl("JWT malformed, contained fewer than 3 sections"),null;try{const s=nT(t);return s?JSON.parse(s):(bl("Failed to decode base64 JWT payload"),null)}catch(s){return bl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function xy(n){const e=Pd(n);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ha(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Er&&FN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function FN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zo(this.lastLoginAt),this.creationTime=zo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ic(n){var e;const t=n.auth,r=await n.getIdToken(),s=await ha(n,sc(t,{idToken:r}));de(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?TT(i.providerUserInfo):[],a=$N(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),h=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ff(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function UN(n){const e=Ht(n);await ic(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $N(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function TT(n){return n.map(e=>{var{providerId:t}=e,r=kd(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zN(n,e){const t=await _T(n,{},async()=>{const r=ka({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await ET(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",yT.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function jN(n,e){return Yi(n,"POST","/v2/accounts:revokeToken",eu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){de(e.length!==0,"internal-error");const t=xy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await zN(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Ci;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ci,this.toJSON())}_performRefresh(){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(n,e){de(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class In{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=kd(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new BN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ff(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ha(this,this.stsTokenManager.getToken(this.auth,e));return de(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return LN(this,e)}reload(){return UN(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new In(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ic(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bn(this.auth.app))return Promise.reject(Zr(this.auth));const e=await this.getIdToken();return await ha(this,VN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,h;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,d=(s=t.email)!==null&&s!==void 0?s:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,_=(a=t.tenantId)!==null&&a!==void 0?a:void 0,E=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=t.createdAt)!==null&&c!==void 0?c:void 0,O=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:D,emailVerified:U,isAnonymous:X,providerData:Z,stsTokenManager:A}=t;de(D&&A,e,"internal-error");const T=Ci.fromJSON(this.name,A);de(typeof D=="string",e,"internal-error"),Cr(f,e.name),Cr(d,e.name),de(typeof U=="boolean",e,"internal-error"),de(typeof X=="boolean",e,"internal-error"),Cr(m,e.name),Cr(y,e.name),Cr(_,e.name),Cr(E,e.name),Cr(k,e.name),Cr(O,e.name);const w=new In({uid:D,auth:e,email:d,emailVerified:U,displayName:f,isAnonymous:X,photoURL:y,phoneNumber:m,tenantId:_,stsTokenManager:T,createdAt:k,lastLoginAt:O});return Z&&Array.isArray(Z)&&(w.providerData=Z.map(C=>Object.assign({},C))),E&&(w._redirectEventId=E),w}static async _fromIdTokenResponse(e,t,r=!1){const s=new Ci;s.updateFromServerResponse(t);const i=new In({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ic(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?TT(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Ci;a.updateFromIdToken(r);const l=new In({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ff(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py=new Map;function lr(n){gr(n instanceof Function,"Expected a class definition");let e=Py.get(n);return e?(gr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Py.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wT.type="NONE";const My=wT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(n,e,t){return`firebase:${n}:${e}:${t}`}class ki{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Il(this.userKey,s.apiKey,i),this.fullPersistenceKey=Il("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await sc(this.auth,{idToken:e}).catch(()=>{});return t?In._fromGetAccountInfoResponse(this.auth,t,e):null}return In._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ki(lr(My),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||lr(My);const o=Il(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const h=await c._get(o);if(h){let f;if(typeof h=="string"){const d=await sc(e,{idToken:h}).catch(()=>{});if(!d)break;f=await In._fromGetAccountInfoResponse(e,d,h)}else f=In._fromJSON(e,h);c!==i&&(a=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new ki(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new ki(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kT(e))return"Blackberry";if(RT(e))return"Webos";if(IT(e))return"Safari";if((e.includes("chrome/")||ST(e))&&!e.includes("edge/"))return"Chrome";if(CT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function bT(n=Ot()){return/firefox\//i.test(n)}function IT(n=Ot()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ST(n=Ot()){return/crios\//i.test(n)}function AT(n=Ot()){return/iemobile/i.test(n)}function CT(n=Ot()){return/android/i.test(n)}function kT(n=Ot()){return/blackberry/i.test(n)}function RT(n=Ot()){return/webos/i.test(n)}function Md(n=Ot()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function HN(n=Ot()){var e;return Md(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qN(){return oO()&&document.documentMode===10}function xT(n=Ot()){return Md(n)||CT(n)||RT(n)||kT(n)||/windows phone/i.test(n)||AT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,e=[]){let t;switch(n){case"Browser":t=Oy(Ot());break;case"Worker":t=`${Oy(Ot())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Qi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KN(n,e={}){return Yi(n,"GET","/v2/passwordPolicy",eu(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN=6;class JN{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:GN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ny(this),this.idTokenSubscription=new Ny(this),this.beforeStateQueue=new WN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=lr(t)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await ki.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await sc(this,{idToken:e}),r=await In._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(bn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ic(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bn(this.app))return Promise.reject(Zr(this));const t=e?Ht(e):null;return t&&de(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bn(this.app)?Promise.reject(Zr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bn(this.app)?Promise.reject(Zr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(lr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KN(this),t=new JN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ca("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await jN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&lr(e)||this._popupRedirectResolver;de(t,this,"argument-error"),this.redirectPersistenceManager=await ki.create(this,[lr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&kN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function tu(n){return Ht(n)}class Ny{constructor(e){this.auth=e,this.observer=null,this.addObserver=pO(t=>this.observer=t)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Od={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YN(n){Od=n}function XN(n){return Od.loadJS(n)}function ZN(){return Od.gapiScript}function eD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(n,e){const t=Cd(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(js(i,e??{}))return s;mr(s,"already-initialized")}return t.initialize({options:e})}function nD(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(lr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function rD(n,e,t){const r=tu(n);de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=MT(e),{host:o,port:a}=sD(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){de(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),de(js(c,r.config.emulator)&&js(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Aa(o)?(oT(`${i}//${o}${l}`),aT("Auth",!0)):iD()}function MT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function sD(n){const e=MT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Dy(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Dy(o)}}}function Dy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function iD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ar("not implemented")}_getIdTokenResponse(e){return ar("not implemented")}_linkToIdToken(e,t){return ar("not implemented")}_getReauthenticationResolver(e){return ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ri(n,e){return vT(n,"POST","/v1/accounts:signInWithIdp",eu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD="http://localhost";class qs extends OT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):mr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=kd(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new qs(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ri(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ri(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ri(e,t)}buildRequest(){const e={requestUri:oD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ka(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends NT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends xa{constructor(){super("facebook.com")}static credential(e){return qs._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dr.credential(e.oauthAccessToken)}catch{return null}}}Dr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Dr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr extends xa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qs._fromParams({providerId:Vr.PROVIDER_ID,signInMethod:Vr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Vr.credentialFromTaggedObject(e)}static credentialFromError(e){return Vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Vr.credential(t,r)}catch{return null}}}Vr.GOOGLE_SIGN_IN_METHOD="google.com";Vr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr extends xa{constructor(){super("github.com")}static credential(e){return qs._fromParams({providerId:Lr.PROVIDER_ID,signInMethod:Lr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lr.credentialFromTaggedObject(e)}static credentialFromError(e){return Lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lr.credential(e.oauthAccessToken)}catch{return null}}}Lr.GITHUB_SIGN_IN_METHOD="github.com";Lr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends xa{constructor(){super("twitter.com")}static credential(e,t){return qs._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Fr.credential(t,r)}catch{return null}}}Fr.TWITTER_SIGN_IN_METHOD="twitter.com";Fr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aD(n,e){return vT(n,"POST","/v1/accounts:signUp",eu(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await In._fromIdTokenResponse(e,r,s),o=Vy(r);return new as({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Vy(r);return new as({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Vy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DT(n){var e;if(bn(n.app))return Promise.reject(Zr(n));const t=tu(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new as({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await aD(t,{returnSecureToken:!0}),s=await as._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc extends Er{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,oc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new oc(e,t,r,s)}}function VT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?oc._fromErrorAndOperation(n,i,e,r):i})}async function lD(n,e,t=!1){const r=await ha(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return as._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cD(n,e,t=!1){const{auth:r}=n;if(bn(r.app))return Promise.reject(Zr(r));const s="reauthenticate";try{const i=await ha(n,VT(r,s,e,n),t);de(i.idToken,r,"internal-error");const o=Pd(i.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(n.uid===a,r,"user-mismatch"),as._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&mr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uD(n,e,t=!1){if(bn(n.app))return Promise.reject(Zr(n));const r="signIn",s=await VT(n,r,e),i=await as._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function hD(n,e,t,r){return Ht(n).onIdTokenChanged(e,t,r)}function fD(n,e,t){return Ht(n).beforeAuthStateChanged(e,t)}function dD(n,e,t,r){return Ht(n).onAuthStateChanged(e,t,r)}function pD(n){return Ht(n).signOut()}const ac="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ac,"1"),this.storage.removeItem(ac),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD=1e3,gD=10;class FT extends LT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);qN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,gD):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},mD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}FT.type="LOCAL";const yD=FT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT extends LT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}BT.type="SESSION";const UT=BT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new nu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await _D(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=Nd("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const d=f;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(){return window}function ED(n){jn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(){return typeof jn().WorkerGlobalScope<"u"&&typeof jn().importScripts=="function"}async function TD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wD(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function bD(){return $T()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="firebaseLocalStorageDb",ID=1,lc="firebaseLocalStorage",jT="fbase_key";class Pa{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ru(n,e){return n.transaction([lc],e?"readwrite":"readonly").objectStore(lc)}function SD(){const n=indexedDB.deleteDatabase(zT);return new Pa(n).toPromise()}function df(){const n=indexedDB.open(zT,ID);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(lc,{keyPath:jT})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(lc)?e(r):(r.close(),await SD(),e(await df()))})})}async function Ly(n,e,t){const r=ru(n,!0).put({[jT]:e,value:t});return new Pa(r).toPromise()}async function AD(n,e){const t=ru(n,!1).get(e),r=await new Pa(t).toPromise();return r===void 0?null:r.value}function Fy(n,e){const t=ru(n,!0).delete(e);return new Pa(t).toPromise()}const CD=800,kD=3;class HT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await df(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>kD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $T()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nu._getInstance(bD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await TD(),!this.activeServiceWorker)return;this.sender=new vD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await df();return await Ly(e,ac,"1"),await Fy(e,ac),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ly(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>AD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Fy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=ru(s,!1).getAll();return new Pa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),CD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}HT.type="LOCAL";const RD=HT;new Ra(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(n,e){return e?lr(e):(de(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd extends OT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ri(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ri(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ri(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function PD(n){return uD(n.auth,new Dd(n),n.bypassAuthState)}function MD(n){const{auth:e,user:t}=n;return de(t,e,"internal-error"),cD(t,new Dd(n),n.bypassAuthState)}async function OD(n){const{auth:e,user:t}=n;return de(t,e,"internal-error"),lD(t,new Dd(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return PD;case"linkViaPopup":case"linkViaRedirect":return OD;case"reauthViaPopup":case"reauthViaRedirect":return MD;default:mr(this.auth,"internal-error")}}resolve(e){gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=new Ra(2e3,1e4);class vi extends qT{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,vi.currentPopupAction&&vi.currentPopupAction.cancel(),vi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){gr(this.filter.length===1,"Popup operations only handle one event");const e=Nd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ND.get())};e()}}vi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD="pendingRedirect",Sl=new Map;class VD extends qT{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Sl.get(this.auth._key());if(!e){try{const r=await LD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Sl.set(this.auth._key(),e)}return this.bypassAuthState||Sl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LD(n,e){const t=UD(e),r=BD(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function FD(n,e){Sl.set(n._key(),e)}function BD(n){return lr(n._redirectPersistence)}function UD(n){return Il(DD,n.config.apiKey,n.name)}async function $D(n,e,t=!1){if(bn(n.app))return Promise.reject(Zr(n));const r=tu(n),s=xD(r,e),o=await new VD(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD=10*60*1e3;class jD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!WT(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(zn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zD&&this.cachedEventUids.clear(),this.cachedEventUids.has(By(e))}saveEventToCache(e){this.cachedEventUids.add(By(e)),this.lastProcessedEventTime=Date.now()}}function By(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function WT({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function HD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(n,e={}){return Yi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KD=/^https?/;async function GD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await qD(n);for(const t of e)try{if(JD(t))return}catch{}mr(n,"unauthorized-domain")}function JD(n){const e=hf(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!KD.test(t))return!1;if(WD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD=new Ra(3e4,6e4);function Uy(){const n=jn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function YD(n){return new Promise((e,t)=>{var r,s,i;function o(){Uy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Uy(),t(zn(n,"network-request-failed"))},timeout:QD.get()})}if(!((s=(r=jn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=jn().gapi)===null||i===void 0)&&i.load)o();else{const a=eD("iframefcb");return jn()[a]=()=>{gapi.load?o():t(zn(n,"network-request-failed"))},XN(`${ZN()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Al=null,e})}let Al=null;function XD(n){return Al=Al||YD(n),Al}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD=new Ra(5e3,15e3),e2="__/auth/iframe",t2="emulator/auth/iframe",n2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s2(n){const e=n.config;de(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?xd(e,t2):`https://${n.config.authDomain}/${e2}`,r={apiKey:e.apiKey,appName:n.name,v:Qi},s=r2.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${ka(r).slice(1)}`}async function i2(n){const e=await XD(n),t=jn().gapi;return de(t,n,"internal-error"),e.open({where:document.body,url:s2(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:n2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=zn(n,"network-request-failed"),a=jn().setTimeout(()=>{i(o)},ZD.get());function l(){jn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},a2=500,l2=600,c2="_blank",u2="http://localhost";class $y{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function h2(n,e,t,r=a2,s=l2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},o2),{width:r.toString(),height:s.toString(),top:i,left:o}),c=Ot().toLowerCase();t&&(a=ST(c)?c2:t),bT(c)&&(e=e||u2,l.scrollbars="yes");const h=Object.entries(l).reduce((d,[m,y])=>`${d}${m}=${y},`,"");if(HN(c)&&a!=="_self")return f2(e||"",a),new $y(null);const f=window.open(e||"",a,h);de(f,n,"popup-blocked");try{f.focus()}catch{}return new $y(f)}function f2(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="__/auth/handler",p2="emulator/auth/handler",m2=encodeURIComponent("fac");async function zy(n,e,t,r,s,i){de(n.config.authDomain,n,"auth-domain-config-required"),de(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Qi,eventId:s};if(e instanceof NT){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",dO(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof xa){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${m2}=${encodeURIComponent(l)}`:"";return`${g2(n)}?${ka(a).slice(1)}${c}`}function g2({config:n}){return n.emulator?xd(n,p2):`https://${n.authDomain}/${d2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="webStorageSupport";class y2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UT,this._completeRedirectFn=$D,this._overrideRedirectResult=FD}async _openPopup(e,t,r,s){var i;gr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await zy(e,t,r,hf(),s);return h2(e,o,Nd())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await zy(e,t,r,hf(),s);return ED(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(gr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await i2(e),r=new jD(e);return t.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(_h,{type:_h},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[_h];o!==void 0&&t(!!o),mr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=GD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xT()||IT()||Md()}}const _2=y2;var jy="@firebase/auth",Hy="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function T2(n){$i(new Hs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PT(n)},c=new QN(r,s,i,l);return nD(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),$i(new Hs("auth-internal",e=>{const t=tu(e.getProvider("auth").getImmediate());return(r=>new v2(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xr(jy,Hy,E2(n)),Xr(jy,Hy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=5*60,b2=iT("authIdTokenMaxAge")||w2;let qy=null;const I2=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>b2)return;const s=t==null?void 0:t.token;qy!==s&&(qy=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function S2(n=hT()){const e=Cd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=tD(n,{popupRedirectResolver:_2,persistence:[RD,yD,UT]}),r=iT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=I2(i.toString());fD(t,o,()=>o(t.currentUser)),hD(t,a=>o(a))}}const s=rT("auth");return s&&rD(t,`http://${s}`),t}function A2(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}YN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=zn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",A2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});T2("Browser");var Wy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var es,KT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,T){function w(){}w.prototype=T.prototype,A.D=T.prototype,A.prototype=new w,A.prototype.constructor=A,A.C=function(C,R,P){for(var S=Array(arguments.length-2),Dt=2;Dt<arguments.length;Dt++)S[Dt-2]=arguments[Dt];return T.prototype[R].apply(C,S)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,T,w){w||(w=0);var C=Array(16);if(typeof T=="string")for(var R=0;16>R;++R)C[R]=T.charCodeAt(w++)|T.charCodeAt(w++)<<8|T.charCodeAt(w++)<<16|T.charCodeAt(w++)<<24;else for(R=0;16>R;++R)C[R]=T[w++]|T[w++]<<8|T[w++]<<16|T[w++]<<24;T=A.g[0],w=A.g[1],R=A.g[2];var P=A.g[3],S=T+(P^w&(R^P))+C[0]+3614090360&4294967295;T=w+(S<<7&4294967295|S>>>25),S=P+(R^T&(w^R))+C[1]+3905402710&4294967295,P=T+(S<<12&4294967295|S>>>20),S=R+(w^P&(T^w))+C[2]+606105819&4294967295,R=P+(S<<17&4294967295|S>>>15),S=w+(T^R&(P^T))+C[3]+3250441966&4294967295,w=R+(S<<22&4294967295|S>>>10),S=T+(P^w&(R^P))+C[4]+4118548399&4294967295,T=w+(S<<7&4294967295|S>>>25),S=P+(R^T&(w^R))+C[5]+1200080426&4294967295,P=T+(S<<12&4294967295|S>>>20),S=R+(w^P&(T^w))+C[6]+2821735955&4294967295,R=P+(S<<17&4294967295|S>>>15),S=w+(T^R&(P^T))+C[7]+4249261313&4294967295,w=R+(S<<22&4294967295|S>>>10),S=T+(P^w&(R^P))+C[8]+1770035416&4294967295,T=w+(S<<7&4294967295|S>>>25),S=P+(R^T&(w^R))+C[9]+2336552879&4294967295,P=T+(S<<12&4294967295|S>>>20),S=R+(w^P&(T^w))+C[10]+4294925233&4294967295,R=P+(S<<17&4294967295|S>>>15),S=w+(T^R&(P^T))+C[11]+2304563134&4294967295,w=R+(S<<22&4294967295|S>>>10),S=T+(P^w&(R^P))+C[12]+1804603682&4294967295,T=w+(S<<7&4294967295|S>>>25),S=P+(R^T&(w^R))+C[13]+4254626195&4294967295,P=T+(S<<12&4294967295|S>>>20),S=R+(w^P&(T^w))+C[14]+2792965006&4294967295,R=P+(S<<17&4294967295|S>>>15),S=w+(T^R&(P^T))+C[15]+1236535329&4294967295,w=R+(S<<22&4294967295|S>>>10),S=T+(R^P&(w^R))+C[1]+4129170786&4294967295,T=w+(S<<5&4294967295|S>>>27),S=P+(w^R&(T^w))+C[6]+3225465664&4294967295,P=T+(S<<9&4294967295|S>>>23),S=R+(T^w&(P^T))+C[11]+643717713&4294967295,R=P+(S<<14&4294967295|S>>>18),S=w+(P^T&(R^P))+C[0]+3921069994&4294967295,w=R+(S<<20&4294967295|S>>>12),S=T+(R^P&(w^R))+C[5]+3593408605&4294967295,T=w+(S<<5&4294967295|S>>>27),S=P+(w^R&(T^w))+C[10]+38016083&4294967295,P=T+(S<<9&4294967295|S>>>23),S=R+(T^w&(P^T))+C[15]+3634488961&4294967295,R=P+(S<<14&4294967295|S>>>18),S=w+(P^T&(R^P))+C[4]+3889429448&4294967295,w=R+(S<<20&4294967295|S>>>12),S=T+(R^P&(w^R))+C[9]+568446438&4294967295,T=w+(S<<5&4294967295|S>>>27),S=P+(w^R&(T^w))+C[14]+3275163606&4294967295,P=T+(S<<9&4294967295|S>>>23),S=R+(T^w&(P^T))+C[3]+4107603335&4294967295,R=P+(S<<14&4294967295|S>>>18),S=w+(P^T&(R^P))+C[8]+1163531501&4294967295,w=R+(S<<20&4294967295|S>>>12),S=T+(R^P&(w^R))+C[13]+2850285829&4294967295,T=w+(S<<5&4294967295|S>>>27),S=P+(w^R&(T^w))+C[2]+4243563512&4294967295,P=T+(S<<9&4294967295|S>>>23),S=R+(T^w&(P^T))+C[7]+1735328473&4294967295,R=P+(S<<14&4294967295|S>>>18),S=w+(P^T&(R^P))+C[12]+2368359562&4294967295,w=R+(S<<20&4294967295|S>>>12),S=T+(w^R^P)+C[5]+4294588738&4294967295,T=w+(S<<4&4294967295|S>>>28),S=P+(T^w^R)+C[8]+2272392833&4294967295,P=T+(S<<11&4294967295|S>>>21),S=R+(P^T^w)+C[11]+1839030562&4294967295,R=P+(S<<16&4294967295|S>>>16),S=w+(R^P^T)+C[14]+4259657740&4294967295,w=R+(S<<23&4294967295|S>>>9),S=T+(w^R^P)+C[1]+2763975236&4294967295,T=w+(S<<4&4294967295|S>>>28),S=P+(T^w^R)+C[4]+1272893353&4294967295,P=T+(S<<11&4294967295|S>>>21),S=R+(P^T^w)+C[7]+4139469664&4294967295,R=P+(S<<16&4294967295|S>>>16),S=w+(R^P^T)+C[10]+3200236656&4294967295,w=R+(S<<23&4294967295|S>>>9),S=T+(w^R^P)+C[13]+681279174&4294967295,T=w+(S<<4&4294967295|S>>>28),S=P+(T^w^R)+C[0]+3936430074&4294967295,P=T+(S<<11&4294967295|S>>>21),S=R+(P^T^w)+C[3]+3572445317&4294967295,R=P+(S<<16&4294967295|S>>>16),S=w+(R^P^T)+C[6]+76029189&4294967295,w=R+(S<<23&4294967295|S>>>9),S=T+(w^R^P)+C[9]+3654602809&4294967295,T=w+(S<<4&4294967295|S>>>28),S=P+(T^w^R)+C[12]+3873151461&4294967295,P=T+(S<<11&4294967295|S>>>21),S=R+(P^T^w)+C[15]+530742520&4294967295,R=P+(S<<16&4294967295|S>>>16),S=w+(R^P^T)+C[2]+3299628645&4294967295,w=R+(S<<23&4294967295|S>>>9),S=T+(R^(w|~P))+C[0]+4096336452&4294967295,T=w+(S<<6&4294967295|S>>>26),S=P+(w^(T|~R))+C[7]+1126891415&4294967295,P=T+(S<<10&4294967295|S>>>22),S=R+(T^(P|~w))+C[14]+2878612391&4294967295,R=P+(S<<15&4294967295|S>>>17),S=w+(P^(R|~T))+C[5]+4237533241&4294967295,w=R+(S<<21&4294967295|S>>>11),S=T+(R^(w|~P))+C[12]+1700485571&4294967295,T=w+(S<<6&4294967295|S>>>26),S=P+(w^(T|~R))+C[3]+2399980690&4294967295,P=T+(S<<10&4294967295|S>>>22),S=R+(T^(P|~w))+C[10]+4293915773&4294967295,R=P+(S<<15&4294967295|S>>>17),S=w+(P^(R|~T))+C[1]+2240044497&4294967295,w=R+(S<<21&4294967295|S>>>11),S=T+(R^(w|~P))+C[8]+1873313359&4294967295,T=w+(S<<6&4294967295|S>>>26),S=P+(w^(T|~R))+C[15]+4264355552&4294967295,P=T+(S<<10&4294967295|S>>>22),S=R+(T^(P|~w))+C[6]+2734768916&4294967295,R=P+(S<<15&4294967295|S>>>17),S=w+(P^(R|~T))+C[13]+1309151649&4294967295,w=R+(S<<21&4294967295|S>>>11),S=T+(R^(w|~P))+C[4]+4149444226&4294967295,T=w+(S<<6&4294967295|S>>>26),S=P+(w^(T|~R))+C[11]+3174756917&4294967295,P=T+(S<<10&4294967295|S>>>22),S=R+(T^(P|~w))+C[2]+718787259&4294967295,R=P+(S<<15&4294967295|S>>>17),S=w+(P^(R|~T))+C[9]+3951481745&4294967295,A.g[0]=A.g[0]+T&4294967295,A.g[1]=A.g[1]+(R+(S<<21&4294967295|S>>>11))&4294967295,A.g[2]=A.g[2]+R&4294967295,A.g[3]=A.g[3]+P&4294967295}r.prototype.u=function(A,T){T===void 0&&(T=A.length);for(var w=T-this.blockSize,C=this.B,R=this.h,P=0;P<T;){if(R==0)for(;P<=w;)s(this,A,P),P+=this.blockSize;if(typeof A=="string"){for(;P<T;)if(C[R++]=A.charCodeAt(P++),R==this.blockSize){s(this,C),R=0;break}}else for(;P<T;)if(C[R++]=A[P++],R==this.blockSize){s(this,C),R=0;break}}this.h=R,this.o+=T},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var T=1;T<A.length-8;++T)A[T]=0;var w=8*this.o;for(T=A.length-8;T<A.length;++T)A[T]=w&255,w/=256;for(this.u(A),A=Array(16),T=w=0;4>T;++T)for(var C=0;32>C;C+=8)A[w++]=this.g[T]>>>C&255;return A};function i(A,T){var w=a;return Object.prototype.hasOwnProperty.call(w,A)?w[A]:w[A]=T(A)}function o(A,T){this.h=T;for(var w=[],C=!0,R=A.length-1;0<=R;R--){var P=A[R]|0;C&&P==T||(w[R]=P,C=!1)}this.g=w}var a={};function l(A){return-128<=A&&128>A?i(A,function(T){return new o([T|0],0>T?-1:0)}):new o([A|0],0>A?-1:0)}function c(A){if(isNaN(A)||!isFinite(A))return f;if(0>A)return E(c(-A));for(var T=[],w=1,C=0;A>=w;C++)T[C]=A/w|0,w*=4294967296;return new o(T,0)}function h(A,T){if(A.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(A.charAt(0)=="-")return E(h(A.substring(1),T));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(T,8)),C=f,R=0;R<A.length;R+=8){var P=Math.min(8,A.length-R),S=parseInt(A.substring(R,R+P),T);8>P?(P=c(Math.pow(T,P)),C=C.j(P).add(c(S))):(C=C.j(w),C=C.add(c(S)))}return C}var f=l(0),d=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(_(this))return-E(this).m();for(var A=0,T=1,w=0;w<this.g.length;w++){var C=this.i(w);A+=(0<=C?C:4294967296+C)*T,T*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(y(this))return"0";if(_(this))return"-"+E(this).toString(A);for(var T=c(Math.pow(A,6)),w=this,C="";;){var R=U(w,T).g;w=k(w,R.j(T));var P=((0<w.g.length?w.g[0]:w.h)>>>0).toString(A);if(w=R,y(w))return P+C;for(;6>P.length;)P="0"+P;C=P+C}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function y(A){if(A.h!=0)return!1;for(var T=0;T<A.g.length;T++)if(A.g[T]!=0)return!1;return!0}function _(A){return A.h==-1}n.l=function(A){return A=k(this,A),_(A)?-1:y(A)?0:1};function E(A){for(var T=A.g.length,w=[],C=0;C<T;C++)w[C]=~A.g[C];return new o(w,~A.h).add(d)}n.abs=function(){return _(this)?E(this):this},n.add=function(A){for(var T=Math.max(this.g.length,A.g.length),w=[],C=0,R=0;R<=T;R++){var P=C+(this.i(R)&65535)+(A.i(R)&65535),S=(P>>>16)+(this.i(R)>>>16)+(A.i(R)>>>16);C=S>>>16,P&=65535,S&=65535,w[R]=S<<16|P}return new o(w,w[w.length-1]&-2147483648?-1:0)};function k(A,T){return A.add(E(T))}n.j=function(A){if(y(this)||y(A))return f;if(_(this))return _(A)?E(this).j(E(A)):E(E(this).j(A));if(_(A))return E(this.j(E(A)));if(0>this.l(m)&&0>A.l(m))return c(this.m()*A.m());for(var T=this.g.length+A.g.length,w=[],C=0;C<2*T;C++)w[C]=0;for(C=0;C<this.g.length;C++)for(var R=0;R<A.g.length;R++){var P=this.i(C)>>>16,S=this.i(C)&65535,Dt=A.i(R)>>>16,cn=A.i(R)&65535;w[2*C+2*R]+=S*cn,O(w,2*C+2*R),w[2*C+2*R+1]+=P*cn,O(w,2*C+2*R+1),w[2*C+2*R+1]+=S*Dt,O(w,2*C+2*R+1),w[2*C+2*R+2]+=P*Dt,O(w,2*C+2*R+2)}for(C=0;C<T;C++)w[C]=w[2*C+1]<<16|w[2*C];for(C=T;C<2*T;C++)w[C]=0;return new o(w,0)};function O(A,T){for(;(A[T]&65535)!=A[T];)A[T+1]+=A[T]>>>16,A[T]&=65535,T++}function D(A,T){this.g=A,this.h=T}function U(A,T){if(y(T))throw Error("division by zero");if(y(A))return new D(f,f);if(_(A))return T=U(E(A),T),new D(E(T.g),E(T.h));if(_(T))return T=U(A,E(T)),new D(E(T.g),T.h);if(30<A.g.length){if(_(A)||_(T))throw Error("slowDivide_ only works with positive integers.");for(var w=d,C=T;0>=C.l(A);)w=X(w),C=X(C);var R=Z(w,1),P=Z(C,1);for(C=Z(C,2),w=Z(w,2);!y(C);){var S=P.add(C);0>=S.l(A)&&(R=R.add(w),P=S),C=Z(C,1),w=Z(w,1)}return T=k(A,R.j(T)),new D(R,T)}for(R=f;0<=A.l(T);){for(w=Math.max(1,Math.floor(A.m()/T.m())),C=Math.ceil(Math.log(w)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),P=c(w),S=P.j(T);_(S)||0<S.l(A);)w-=C,P=c(w),S=P.j(T);y(P)&&(P=d),R=R.add(P),A=k(A,S)}return new D(R,A)}n.A=function(A){return U(this,A).h},n.and=function(A){for(var T=Math.max(this.g.length,A.g.length),w=[],C=0;C<T;C++)w[C]=this.i(C)&A.i(C);return new o(w,this.h&A.h)},n.or=function(A){for(var T=Math.max(this.g.length,A.g.length),w=[],C=0;C<T;C++)w[C]=this.i(C)|A.i(C);return new o(w,this.h|A.h)},n.xor=function(A){for(var T=Math.max(this.g.length,A.g.length),w=[],C=0;C<T;C++)w[C]=this.i(C)^A.i(C);return new o(w,this.h^A.h)};function X(A){for(var T=A.g.length+1,w=[],C=0;C<T;C++)w[C]=A.i(C)<<1|A.i(C-1)>>>31;return new o(w,A.h)}function Z(A,T){var w=T>>5;T%=32;for(var C=A.g.length-w,R=[],P=0;P<C;P++)R[P]=0<T?A.i(P+w)>>>T|A.i(P+w+1)<<32-T:A.i(P+w);return new o(R,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,KT=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,es=o}).apply(typeof Wy<"u"?Wy:typeof self<"u"?self:typeof window<"u"?window:{});var cl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var GT,So,JT,Cl,pf,QT,YT,XT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,g){return u==Array.prototype||u==Object.prototype||(u[p]=g.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof cl=="object"&&cl];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=t(this);function s(u,p){if(p)e:{var g=r;u=u.split(".");for(var v=0;v<u.length-1;v++){var M=u[v];if(!(M in g))break e;g=g[M]}u=u[u.length-1],v=g[u],p=p(v),p!=v&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var g=0,v=!1,M={next:function(){if(!v&&g<u.length){var N=g++;return{value:p(N,u[N]),done:!1}}return v=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,g){return u.call.apply(u.bind,arguments)}function f(u,p,g){if(!u)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,v),u.apply(p,M)}}return function(){return u.apply(p,arguments)}}function d(u,p,g){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,d.apply(null,arguments)}function m(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var v=g.slice();return v.push.apply(v,arguments),u.apply(this,v)}}function y(u,p){function g(){}g.prototype=p.prototype,u.aa=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Qb=function(v,M,N){for(var K=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)K[Ve-2]=arguments[Ve];return p.prototype[M].apply(v,K)}}function _(u){const p=u.length;if(0<p){const g=Array(p);for(let v=0;v<p;v++)g[v]=u[v];return g}return[]}function E(u,p){for(let g=1;g<arguments.length;g++){const v=arguments[g];if(l(v)){const M=u.length||0,N=v.length||0;u.length=M+N;for(let K=0;K<N;K++)u[M+K]=v[K]}else u.push(v)}}class k{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function O(u){return/^[\s\xa0]*$/.test(u)}function D(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function U(u){return U[" "](u),u}U[" "]=function(){};var X=D().indexOf("Gecko")!=-1&&!(D().toLowerCase().indexOf("webkit")!=-1&&D().indexOf("Edge")==-1)&&!(D().indexOf("Trident")!=-1||D().indexOf("MSIE")!=-1)&&D().indexOf("Edge")==-1;function Z(u,p,g){for(const v in u)p.call(g,u[v],v,u)}function A(u,p){for(const g in u)p.call(void 0,u[g],g,u)}function T(u){const p={};for(const g in u)p[g]=u[g];return p}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let g,v;for(let M=1;M<arguments.length;M++){v=arguments[M];for(g in v)u[g]=v[g];for(let N=0;N<w.length;N++)g=w[N],Object.prototype.hasOwnProperty.call(v,g)&&(u[g]=v[g])}}function R(u){var p=1;u=u.split(":");const g=[];for(;0<p&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function P(u){a.setTimeout(()=>{throw u},0)}function S(){var u=tn;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Dt{constructor(){this.h=this.g=null}add(p,g){const v=cn.get();v.set(p,g),this.h?this.h.next=v:this.g=v,this.h=v}}var cn=new k(()=>new Ye,u=>u.reset());class Ye{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,be=!1,tn=new Dt,En=()=>{const u=a.Promise.resolve(void 0);Ae=()=>{u.then(un)}};var un=()=>{for(var u;u=S();){try{u.h.call(u.g)}catch(g){P(g)}var p=cn;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}be=!1};function He(){this.s=this.s,this.C=this.C}He.prototype.s=!1,He.prototype.ma=function(){this.s||(this.s=!0,this.N())},He.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function qe(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}qe.prototype.h=function(){this.defaultPrevented=!0};var Tr=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};a.addEventListener("test",g,p),a.removeEventListener("test",g,p)}catch{}return u}();function On(u,p){if(qe.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var g=this.type=u.type,v=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(X){e:{try{U(p.nodeName);var M=!0;break e}catch{}M=!1}M||(p=null)}}else g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement);this.relatedTarget=p,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:qt[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&On.aa.h.call(this)}}y(On,qe);var qt={2:"touch",3:"pen",4:"mouse"};On.prototype.h=function(){On.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var V="closure_listenable_"+(1e6*Math.random()|0),ee=0;function Q(u,p,g,v,M){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!v,this.ha=M,this.key=++ee,this.da=this.fa=!1}function se(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Re(u){this.src=u,this.g={},this.h=0}Re.prototype.add=function(u,p,g,v,M){var N=u.toString();u=this.g[N],u||(u=this.g[N]=[],this.h++);var K=I(u,p,v,M);return-1<K?(p=u[K],g||(p.fa=!1)):(p=new Q(p,this.src,N,!!v,M),p.fa=g,u.push(p)),p};function b(u,p){var g=p.type;if(g in u.g){var v=u.g[g],M=Array.prototype.indexOf.call(v,p,void 0),N;(N=0<=M)&&Array.prototype.splice.call(v,M,1),N&&(se(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function I(u,p,g,v){for(var M=0;M<u.length;++M){var N=u[M];if(!N.da&&N.listener==p&&N.capture==!!g&&N.ha==v)return M}return-1}var x="closure_lm_"+(1e6*Math.random()|0),L={};function $(u,p,g,v,M){if(Array.isArray(p)){for(var N=0;N<p.length;N++)$(u,p[N],g,v,M);return null}return g=he(g),u&&u[V]?u.K(p,g,c(v)?!!v.capture:!1,M):F(u,p,g,!1,v,M)}function F(u,p,g,v,M,N){if(!p)throw Error("Invalid event type");var K=c(M)?!!M.capture:!!M,Ve=G(u);if(Ve||(u[x]=Ve=new Re(u)),g=Ve.add(p,g,v,K,N),g.proxy)return g;if(v=J(),g.proxy=v,v.src=u,v.listener=g,u.addEventListener)Tr||(M=K),M===void 0&&(M=!1),u.addEventListener(p.toString(),v,M);else if(u.attachEvent)u.attachEvent(H(p.toString()),v);else if(u.addListener&&u.removeListener)u.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return g}function J(){function u(g){return p.call(u.src,u.listener,g)}const p=oe;return u}function W(u,p,g,v,M){if(Array.isArray(p))for(var N=0;N<p.length;N++)W(u,p[N],g,v,M);else v=c(v)?!!v.capture:!!v,g=he(g),u&&u[V]?(u=u.i,p=String(p).toString(),p in u.g&&(N=u.g[p],g=I(N,g,v,M),-1<g&&(se(N[g]),Array.prototype.splice.call(N,g,1),N.length==0&&(delete u.g[p],u.h--)))):u&&(u=G(u))&&(p=u.g[p.toString()],u=-1,p&&(u=I(p,g,v,M)),(g=-1<u?p[u]:null)&&q(g))}function q(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[V])b(p.i,u);else{var g=u.type,v=u.proxy;p.removeEventListener?p.removeEventListener(g,v,u.capture):p.detachEvent?p.detachEvent(H(g),v):p.addListener&&p.removeListener&&p.removeListener(v),(g=G(p))?(b(g,u),g.h==0&&(g.src=null,p[x]=null)):se(u)}}}function H(u){return u in L?L[u]:L[u]="on"+u}function oe(u,p){if(u.da)u=!0;else{p=new On(p,this);var g=u.listener,v=u.ha||u.src;u.fa&&q(u),u=g.call(v,p)}return u}function G(u){return u=u[x],u instanceof Re?u:null}var ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function he(u){return typeof u=="function"?u:(u[ie]||(u[ie]=function(p){return u.handleEvent(p)}),u[ie])}function ce(){He.call(this),this.i=new Re(this),this.M=this,this.F=null}y(ce,He),ce.prototype[V]=!0,ce.prototype.removeEventListener=function(u,p,g,v){W(this,u,p,g,v)};function ve(u,p){var g,v=u.F;if(v)for(g=[];v;v=v.F)g.push(v);if(u=u.M,v=p.type||p,typeof p=="string")p=new qe(p,u);else if(p instanceof qe)p.target=p.target||u;else{var M=p;p=new qe(v,u),C(p,M)}if(M=!0,g)for(var N=g.length-1;0<=N;N--){var K=p.g=g[N];M=Ce(K,v,!0,p)&&M}if(K=p.g=u,M=Ce(K,v,!0,p)&&M,M=Ce(K,v,!1,p)&&M,g)for(N=0;N<g.length;N++)K=p.g=g[N],M=Ce(K,v,!1,p)&&M}ce.prototype.N=function(){if(ce.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var g=u.g[p],v=0;v<g.length;v++)se(g[v]);delete u.g[p],u.h--}}this.F=null},ce.prototype.K=function(u,p,g,v){return this.i.add(String(u),p,!1,g,v)},ce.prototype.L=function(u,p,g,v){return this.i.add(String(u),p,!0,g,v)};function Ce(u,p,g,v){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var M=!0,N=0;N<p.length;++N){var K=p[N];if(K&&!K.da&&K.capture==g){var Ve=K.listener,ft=K.ha||K.src;K.fa&&b(u.i,K),M=Ve.call(ft,v)!==!1&&M}}return M&&!v.defaultPrevented}function Tt(u,p,g){if(typeof u=="function")g&&(u=d(u,g));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function ut(u){u.g=Tt(()=>{u.g=null,u.i&&(u.i=!1,ut(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class hn extends He{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ut(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wt(u){He.call(this),this.h=u,this.g={}}y(wt,He);var wr=[];function ro(u){Z(u.g,function(p,g){this.g.hasOwnProperty(g)&&q(p)},u),u.g={}}wt.prototype.N=function(){wt.aa.N.call(this),ro(this)},wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ht=a.JSON.stringify,fn=a.JSON.parse,Va=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function yu(){}yu.prototype.h=null;function yp(u){return u.h||(u.h=u.i())}function _p(){}var so={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _u(){qe.call(this,"d")}y(_u,qe);function vu(){qe.call(this,"c")}y(vu,qe);var _s={},vp=null;function La(){return vp=vp||new ce}_s.La="serverreachability";function Ep(u){qe.call(this,_s.La,u)}y(Ep,qe);function io(u){const p=La();ve(p,new Ep(p))}_s.STAT_EVENT="statevent";function Tp(u,p){qe.call(this,_s.STAT_EVENT,u),this.stat=p}y(Tp,qe);function Vt(u){const p=La();ve(p,new Tp(p,u))}_s.Ma="timingevent";function wp(u,p){qe.call(this,_s.Ma,u),this.size=p}y(wp,qe);function oo(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function ao(){this.g=!0}ao.prototype.xa=function(){this.g=!1};function Mb(u,p,g,v,M,N){u.info(function(){if(u.g)if(N)for(var K="",Ve=N.split("&"),ft=0;ft<Ve.length;ft++){var xe=Ve[ft].split("=");if(1<xe.length){var bt=xe[0];xe=xe[1];var It=bt.split("_");K=2<=It.length&&It[1]=="type"?K+(bt+"="+xe+"&"):K+(bt+"=redacted&")}}else K=null;else K=N;return"XMLHTTP REQ ("+v+") [attempt "+M+"]: "+p+`
`+g+`
`+K})}function Ob(u,p,g,v,M,N,K){u.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+M+"]: "+p+`
`+g+`
`+N+" "+K})}function ti(u,p,g,v){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+Db(u,g)+(v?" "+v:"")})}function Nb(u,p){u.info(function(){return"TIMEOUT: "+p})}ao.prototype.info=function(){};function Db(u,p){if(!u.g)return p;if(!p)return null;try{var g=JSON.parse(p);if(g){for(u=0;u<g.length;u++)if(Array.isArray(g[u])){var v=g[u];if(!(2>v.length)){var M=v[1];if(Array.isArray(M)&&!(1>M.length)){var N=M[0];if(N!="noop"&&N!="stop"&&N!="close")for(var K=1;K<M.length;K++)M[K]=""}}}}return ht(g)}catch{return p}}var Fa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Eu;function Ba(){}y(Ba,yu),Ba.prototype.g=function(){return new XMLHttpRequest},Ba.prototype.i=function(){return{}},Eu=new Ba;function br(u,p,g,v){this.j=u,this.i=p,this.l=g,this.R=v||1,this.U=new wt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ip}function Ip(){this.i=null,this.g="",this.h=!1}var Sp={},Tu={};function wu(u,p,g){u.L=1,u.v=ja(Yn(p)),u.m=g,u.P=!0,Ap(u,null)}function Ap(u,p){u.F=Date.now(),Ua(u),u.A=Yn(u.v);var g=u.A,v=u.R;Array.isArray(v)||(v=[String(v)]),Up(g.i,"t",v),u.C=0,g=u.j.J,u.h=new Ip,u.g=sm(u.j,g?p:null,!u.m),0<u.O&&(u.M=new hn(d(u.Y,u,u.g),u.O)),p=u.U,g=u.g,v=u.ca;var M="readystatechange";Array.isArray(M)||(M&&(wr[0]=M.toString()),M=wr);for(var N=0;N<M.length;N++){var K=$(g,M[N],v||p.handleEvent,!1,p.h||p);if(!K)break;p.g[K.key]=K}p=u.H?T(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),io(),Mb(u.i,u.u,u.A,u.l,u.R,u.m)}br.prototype.ca=function(u){u=u.target;const p=this.M;p&&Xn(u)==3?p.j():this.Y(u)},br.prototype.Y=function(u){try{if(u==this.g)e:{const It=Xn(this.g);var p=this.g.Ba();const si=this.g.Z();if(!(3>It)&&(It!=3||this.g&&(this.h.h||this.g.oa()||Kp(this.g)))){this.J||It!=4||p==7||(p==8||0>=si?io(3):io(2)),bu(this);var g=this.g.Z();this.X=g;t:if(Cp(this)){var v=Kp(this.g);u="";var M=v.length,N=Xn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){vs(this),lo(this);var K="";break t}this.h.i=new a.TextDecoder}for(p=0;p<M;p++)this.h.h=!0,u+=this.h.i.decode(v[p],{stream:!(N&&p==M-1)});v.length=0,this.h.g+=u,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=g==200,Ob(this.i,this.u,this.A,this.l,this.R,It,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ve,ft=this.g;if((Ve=ft.g?ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(Ve)){var xe=Ve;break t}}xe=null}if(g=xe)ti(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Iu(this,g);else{this.o=!1,this.s=3,Vt(12),vs(this),lo(this);break e}}if(this.P){g=!0;let Tn;for(;!this.J&&this.C<K.length;)if(Tn=Vb(this,K),Tn==Tu){It==4&&(this.s=4,Vt(14),g=!1),ti(this.i,this.l,null,"[Incomplete Response]");break}else if(Tn==Sp){this.s=4,Vt(15),ti(this.i,this.l,K,"[Invalid Chunk]"),g=!1;break}else ti(this.i,this.l,Tn,null),Iu(this,Tn);if(Cp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),It!=4||K.length!=0||this.h.h||(this.s=1,Vt(16),g=!1),this.o=this.o&&g,!g)ti(this.i,this.l,K,"[Invalid Chunked Response]"),vs(this),lo(this);else if(0<K.length&&!this.W){this.W=!0;var bt=this.j;bt.g==this&&bt.ba&&!bt.M&&(bt.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),xu(bt),bt.M=!0,Vt(11))}}else ti(this.i,this.l,K,null),Iu(this,K);It==4&&vs(this),this.o&&!this.J&&(It==4?em(this.j,this):(this.o=!1,Ua(this)))}else Zb(this.g),g==400&&0<K.indexOf("Unknown SID")?(this.s=3,Vt(12)):(this.s=0,Vt(13)),vs(this),lo(this)}}}catch{}finally{}};function Cp(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Vb(u,p){var g=u.C,v=p.indexOf(`
`,g);return v==-1?Tu:(g=Number(p.substring(g,v)),isNaN(g)?Sp:(v+=1,v+g>p.length?Tu:(p=p.slice(v,v+g),u.C=v+g,p)))}br.prototype.cancel=function(){this.J=!0,vs(this)};function Ua(u){u.S=Date.now()+u.I,kp(u,u.I)}function kp(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=oo(d(u.ba,u),p)}function bu(u){u.B&&(a.clearTimeout(u.B),u.B=null)}br.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Nb(this.i,this.A),this.L!=2&&(io(),Vt(17)),vs(this),this.s=2,lo(this)):kp(this,this.S-u)};function lo(u){u.j.G==0||u.J||em(u.j,u)}function vs(u){bu(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,ro(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Iu(u,p){try{var g=u.j;if(g.G!=0&&(g.g==u||Su(g.h,u))){if(!u.K&&Su(g.h,u)&&g.G==3){try{var v=g.Da.g.parse(p)}catch{v=null}if(Array.isArray(v)&&v.length==3){var M=v;if(M[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<u.F)Ja(g),Ka(g);else break e;Ru(g),Vt(18)}}else g.za=M[1],0<g.za-g.T&&37500>M[2]&&g.F&&g.v==0&&!g.C&&(g.C=oo(d(g.Za,g),6e3));if(1>=Pp(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Ts(g,11)}else if((u.K||g.g==u)&&Ja(g),!O(p))for(M=g.Da.g.parse(p),p=0;p<M.length;p++){let xe=M[p];if(g.T=xe[0],xe=xe[1],g.G==2)if(xe[0]=="c"){g.K=xe[1],g.ia=xe[2];const bt=xe[3];bt!=null&&(g.la=bt,g.j.info("VER="+g.la));const It=xe[4];It!=null&&(g.Aa=It,g.j.info("SVER="+g.Aa));const si=xe[5];si!=null&&typeof si=="number"&&0<si&&(v=1.5*si,g.L=v,g.j.info("backChannelRequestTimeoutMs_="+v)),v=g;const Tn=u.g;if(Tn){const Ya=Tn.g?Tn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ya){var N=v.h;N.g||Ya.indexOf("spdy")==-1&&Ya.indexOf("quic")==-1&&Ya.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Au(N,N.h),N.h=null))}if(v.D){const Pu=Tn.g?Tn.g.getResponseHeader("X-HTTP-Session-Id"):null;Pu&&(v.ya=Pu,Ue(v.I,v.D,Pu))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-u.F,g.j.info("Handshake RTT: "+g.R+"ms")),v=g;var K=u;if(v.qa=rm(v,v.J?v.ia:null,v.W),K.K){Mp(v.h,K);var Ve=K,ft=v.L;ft&&(Ve.I=ft),Ve.B&&(bu(Ve),Ua(Ve)),v.g=K}else Xp(v);0<g.i.length&&Ga(g)}else xe[0]!="stop"&&xe[0]!="close"||Ts(g,7);else g.G==3&&(xe[0]=="stop"||xe[0]=="close"?xe[0]=="stop"?Ts(g,7):ku(g):xe[0]!="noop"&&g.l&&g.l.ta(xe),g.v=0)}}io(4)}catch{}}var Lb=class{constructor(u,p){this.g=u,this.map=p}};function Rp(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xp(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Pp(u){return u.h?1:u.g?u.g.size:0}function Su(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Au(u,p){u.g?u.g.add(p):u.h=p}function Mp(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Rp.prototype.cancel=function(){if(this.i=Op(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Op(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const g of u.g.values())p=p.concat(g.D);return p}return _(u.i)}function Fb(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],g=u.length,v=0;v<g;v++)p.push(u[v]);return p}p=[],g=0;for(v in u)p[g++]=u[v];return p}function Bb(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var g=0;g<u;g++)p.push(g);return p}p=[],g=0;for(const v in u)p[g++]=v;return p}}}function Np(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var g=Bb(u),v=Fb(u),M=v.length,N=0;N<M;N++)p.call(void 0,v[N],g&&g[N],u)}var Dp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ub(u,p){if(u){u=u.split("&");for(var g=0;g<u.length;g++){var v=u[g].indexOf("="),M=null;if(0<=v){var N=u[g].substring(0,v);M=u[g].substring(v+1)}else N=u[g];p(N,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Es(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Es){this.h=u.h,$a(this,u.j),this.o=u.o,this.g=u.g,za(this,u.s),this.l=u.l;var p=u.i,g=new ho;g.i=p.i,p.g&&(g.g=new Map(p.g),g.h=p.h),Vp(this,g),this.m=u.m}else u&&(p=String(u).match(Dp))?(this.h=!1,$a(this,p[1]||"",!0),this.o=co(p[2]||""),this.g=co(p[3]||"",!0),za(this,p[4]),this.l=co(p[5]||"",!0),Vp(this,p[6]||"",!0),this.m=co(p[7]||"")):(this.h=!1,this.i=new ho(null,this.h))}Es.prototype.toString=function(){var u=[],p=this.j;p&&u.push(uo(p,Lp,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(uo(p,Lp,!0),"@"),u.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&u.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(uo(g,g.charAt(0)=="/"?jb:zb,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",uo(g,qb)),u.join("")};function Yn(u){return new Es(u)}function $a(u,p,g){u.j=g?co(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function za(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Vp(u,p,g){p instanceof ho?(u.i=p,Wb(u.i,u.h)):(g||(p=uo(p,Hb)),u.i=new ho(p,u.h))}function Ue(u,p,g){u.i.set(p,g)}function ja(u){return Ue(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function co(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function uo(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,$b),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function $b(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Lp=/[#\/\?@]/g,zb=/[#\?:]/g,jb=/[#\?]/g,Hb=/[#\?@]/g,qb=/#/g;function ho(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ir(u){u.g||(u.g=new Map,u.h=0,u.i&&Ub(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}n=ho.prototype,n.add=function(u,p){Ir(this),this.i=null,u=ni(this,u);var g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function Fp(u,p){Ir(u),p=ni(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function Bp(u,p){return Ir(u),p=ni(u,p),u.g.has(p)}n.forEach=function(u,p){Ir(this),this.g.forEach(function(g,v){g.forEach(function(M){u.call(p,M,v,this)},this)},this)},n.na=function(){Ir(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),g=[];for(let v=0;v<p.length;v++){const M=u[v];for(let N=0;N<M.length;N++)g.push(p[v])}return g},n.V=function(u){Ir(this);let p=[];if(typeof u=="string")Bp(this,u)&&(p=p.concat(this.g.get(ni(this,u))));else{u=Array.from(this.g.values());for(let g=0;g<u.length;g++)p=p.concat(u[g])}return p},n.set=function(u,p){return Ir(this),this.i=null,u=ni(this,u),Bp(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Up(u,p,g){Fp(u,p),0<g.length&&(u.i=null,u.g.set(ni(u,p),_(g)),u.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var g=0;g<p.length;g++){var v=p[g];const N=encodeURIComponent(String(v)),K=this.V(v);for(v=0;v<K.length;v++){var M=N;K[v]!==""&&(M+="="+encodeURIComponent(String(K[v]))),u.push(M)}}return this.i=u.join("&")};function ni(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function Wb(u,p){p&&!u.j&&(Ir(u),u.i=null,u.g.forEach(function(g,v){var M=v.toLowerCase();v!=M&&(Fp(this,v),Up(this,M,g))},u)),u.j=p}function Kb(u,p){const g=new ao;if(a.Image){const v=new Image;v.onload=m(Sr,g,"TestLoadImage: loaded",!0,p,v),v.onerror=m(Sr,g,"TestLoadImage: error",!1,p,v),v.onabort=m(Sr,g,"TestLoadImage: abort",!1,p,v),v.ontimeout=m(Sr,g,"TestLoadImage: timeout",!1,p,v),a.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=u}else p(!1)}function Gb(u,p){const g=new ao,v=new AbortController,M=setTimeout(()=>{v.abort(),Sr(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:v.signal}).then(N=>{clearTimeout(M),N.ok?Sr(g,"TestPingServer: ok",!0,p):Sr(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(M),Sr(g,"TestPingServer: error",!1,p)})}function Sr(u,p,g,v,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),v(g)}catch{}}function Jb(){this.g=new Va}function Qb(u,p,g){const v=g||"";try{Np(u,function(M,N){let K=M;c(M)&&(K=ht(M)),p.push(v+N+"="+encodeURIComponent(K))})}catch(M){throw p.push(v+"type="+encodeURIComponent("_badmap")),M}}function Ha(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Ha,yu),Ha.prototype.g=function(){return new qa(this.l,this.j)},Ha.prototype.i=function(u){return function(){return u}}({});function qa(u,p){ce.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(qa,ce),n=qa.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,po(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fo(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,po(this)),this.g&&(this.readyState=3,po(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$p(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function $p(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?fo(this):po(this),this.readyState==3&&$p(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,fo(this))},n.Qa=function(u){this.g&&(this.response=u,fo(this))},n.ga=function(){this.g&&fo(this)};function fo(u){u.readyState=4,u.l=null,u.j=null,u.v=null,po(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function po(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(qa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function zp(u){let p="";return Z(u,function(g,v){p+=v,p+=":",p+=g,p+=`\r
`}),p}function Cu(u,p,g){e:{for(v in g){var v=!1;break e}v=!0}v||(g=zp(g),typeof u=="string"?g!=null&&encodeURIComponent(String(g)):Ue(u,p,g))}function Ge(u){ce.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Ge,ce);var Yb=/^https?$/i,Xb=["POST","PUT"];n=Ge.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,g,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Eu.g(),this.v=this.o?yp(this.o):yp(Eu),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(N){jp(this,N);return}if(u=g||"",g=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var M in v)g.set(M,v[M]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const N of v.keys())g.set(N,v.get(N));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(g.keys()).find(N=>N.toLowerCase()=="content-type"),M=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Xb,p,void 0))||v||M||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[N,K]of g)this.g.setRequestHeader(N,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wp(this),this.u=!0,this.g.send(u),this.u=!1}catch(N){jp(this,N)}};function jp(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,Hp(u),Wa(u)}function Hp(u){u.A||(u.A=!0,ve(u,"complete"),ve(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ve(this,"complete"),ve(this,"abort"),Wa(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wa(this,!0)),Ge.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?qp(this):this.bb())},n.bb=function(){qp(this)};function qp(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Xn(u)!=4||u.Z()!=2)){if(u.u&&Xn(u)==4)Tt(u.Ea,0,u);else if(ve(u,"readystatechange"),Xn(u)==4){u.h=!1;try{const K=u.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var v;if(v=K===0){var M=String(u.D).match(Dp)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),v=!Yb.test(M?M.toLowerCase():"")}g=v}if(g)ve(u,"complete"),ve(u,"success");else{u.m=6;try{var N=2<Xn(u)?u.g.statusText:""}catch{N=""}u.l=N+" ["+u.Z()+"]",Hp(u)}}finally{Wa(u)}}}}function Wa(u,p){if(u.g){Wp(u);const g=u.g,v=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||ve(u,"ready");try{g.onreadystatechange=v}catch{}}}function Wp(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Xn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Xn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),fn(p)}};function Kp(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Zb(u){const p={};u=(u.g&&2<=Xn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<u.length;v++){if(O(u[v]))continue;var g=R(u[v]);const M=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const N=p[M]||[];p[M]=N,N.push(g)}A(p,function(v){return v.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function mo(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function Gp(u){this.Aa=0,this.i=[],this.j=new ao,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=mo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=mo("baseRetryDelayMs",5e3,u),this.cb=mo("retryDelaySeedMs",1e4,u),this.Wa=mo("forwardChannelMaxRetries",2,u),this.wa=mo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Rp(u&&u.concurrentRequestLimit),this.Da=new Jb,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Gp.prototype,n.la=8,n.G=1,n.connect=function(u,p,g,v){Vt(0),this.W=u,this.H=p||{},g&&v!==void 0&&(this.H.OSID=g,this.H.OAID=v),this.F=this.X,this.I=rm(this,null,this.W),Ga(this)};function ku(u){if(Jp(u),u.G==3){var p=u.U++,g=Yn(u.I);if(Ue(g,"SID",u.K),Ue(g,"RID",p),Ue(g,"TYPE","terminate"),go(u,g),p=new br(u,u.j,p),p.L=2,p.v=ja(Yn(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=p.v,g=!0),g||(p.g=sm(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Ua(p)}nm(u)}function Ka(u){u.g&&(xu(u),u.g.cancel(),u.g=null)}function Jp(u){Ka(u),u.u&&(a.clearTimeout(u.u),u.u=null),Ja(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Ga(u){if(!xp(u.h)&&!u.s){u.s=!0;var p=u.Ga;Ae||En(),be||(Ae(),be=!0),tn.add(p,u),u.B=0}}function e1(u,p){return Pp(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=oo(d(u.Ga,u,p),tm(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const M=new br(this,this.j,u);let N=this.o;if(this.S&&(N?(N=T(N),C(N,this.S)):N=this.S),this.m!==null||this.O||(M.H=N,N=null),this.P)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var v=this.i[g];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(p+=v,4096<p){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=Yp(this,M,p),g=Yn(this.I),Ue(g,"RID",u),Ue(g,"CVER",22),this.D&&Ue(g,"X-HTTP-Session-Id",this.D),go(this,g),N&&(this.O?p="headers="+encodeURIComponent(String(zp(N)))+"&"+p:this.m&&Cu(g,this.m,N)),Au(this.h,M),this.Ua&&Ue(g,"TYPE","init"),this.P?(Ue(g,"$req",p),Ue(g,"SID","null"),M.T=!0,wu(M,g,null)):wu(M,g,p),this.G=2}}else this.G==3&&(u?Qp(this,u):this.i.length==0||xp(this.h)||Qp(this))};function Qp(u,p){var g;p?g=p.l:g=u.U++;const v=Yn(u.I);Ue(v,"SID",u.K),Ue(v,"RID",g),Ue(v,"AID",u.T),go(u,v),u.m&&u.o&&Cu(v,u.m,u.o),g=new br(u,u.j,g,u.B+1),u.m===null&&(g.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Yp(u,g,1e3),g.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Au(u.h,g),wu(g,v,p)}function go(u,p){u.H&&Z(u.H,function(g,v){Ue(p,v,g)}),u.l&&Np({},function(g,v){Ue(p,v,g)})}function Yp(u,p,g){g=Math.min(u.i.length,g);var v=u.l?d(u.l.Na,u.l,u):null;e:{var M=u.i;let N=-1;for(;;){const K=["count="+g];N==-1?0<g?(N=M[0].g,K.push("ofs="+N)):N=0:K.push("ofs="+N);let Ve=!0;for(let ft=0;ft<g;ft++){let xe=M[ft].g;const bt=M[ft].map;if(xe-=N,0>xe)N=Math.max(0,M[ft].g-100),Ve=!1;else try{Qb(bt,K,"req"+xe+"_")}catch{v&&v(bt)}}if(Ve){v=K.join("&");break e}}}return u=u.i.splice(0,g),p.D=u,v}function Xp(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;Ae||En(),be||(Ae(),be=!0),tn.add(p,u),u.v=0}}function Ru(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=oo(d(u.Fa,u),tm(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Zp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=oo(d(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vt(10),Ka(this),Zp(this))};function xu(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Zp(u){u.g=new br(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=Yn(u.qa);Ue(p,"RID","rpc"),Ue(p,"SID",u.K),Ue(p,"AID",u.T),Ue(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ue(p,"TO",u.ja),Ue(p,"TYPE","xmlhttp"),go(u,p),u.m&&u.o&&Cu(p,u.m,u.o),u.L&&(u.g.I=u.L);var g=u.g;u=u.ia,g.L=1,g.v=ja(Yn(p)),g.m=null,g.P=!0,Ap(g,u)}n.Za=function(){this.C!=null&&(this.C=null,Ka(this),Ru(this),Vt(19))};function Ja(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function em(u,p){var g=null;if(u.g==p){Ja(u),xu(u),u.g=null;var v=2}else if(Su(u.h,p))g=p.D,Mp(u.h,p),v=1;else return;if(u.G!=0){if(p.o)if(v==1){g=p.m?p.m.length:0,p=Date.now()-p.F;var M=u.B;v=La(),ve(v,new wp(v,g)),Ga(u)}else Xp(u);else if(M=p.s,M==3||M==0&&0<p.X||!(v==1&&e1(u,p)||v==2&&Ru(u)))switch(g&&0<g.length&&(p=u.h,p.i=p.i.concat(g)),M){case 1:Ts(u,5);break;case 4:Ts(u,10);break;case 3:Ts(u,6);break;default:Ts(u,2)}}}function tm(u,p){let g=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(g*=2),g*p}function Ts(u,p){if(u.j.info("Error code "+p),p==2){var g=d(u.fb,u),v=u.Xa;const M=!v;v=new Es(v||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||$a(v,"https"),ja(v),M?Kb(v.toString(),g):Gb(v.toString(),g)}else Vt(2);u.G=0,u.l&&u.l.sa(p),nm(u),Jp(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function nm(u){if(u.G=0,u.ka=[],u.l){const p=Op(u.h);(p.length!=0||u.i.length!=0)&&(E(u.ka,p),E(u.ka,u.i),u.h.i.length=0,_(u.i),u.i.length=0),u.l.ra()}}function rm(u,p,g){var v=g instanceof Es?Yn(g):new Es(g);if(v.g!="")p&&(v.g=p+"."+v.g),za(v,v.s);else{var M=a.location;v=M.protocol,p=p?p+"."+M.hostname:M.hostname,M=+M.port;var N=new Es(null);v&&$a(N,v),p&&(N.g=p),M&&za(N,M),g&&(N.l=g),v=N}return g=u.D,p=u.ya,g&&p&&Ue(v,g,p),Ue(v,"VER",u.la),go(u,v),v}function sm(u,p,g){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Ge(new Ha({eb:g})):new Ge(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function im(){}n=im.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Qa(){}Qa.prototype.g=function(u,p){return new nn(u,p)};function nn(u,p){ce.call(this),this.g=new Gp(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!O(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!O(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new ri(this)}y(nn,ce),nn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},nn.prototype.close=function(){ku(this.g)},nn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.u&&(g={},g.__data__=ht(u),u=g);p.i.push(new Lb(p.Ya++,u)),p.G==3&&Ga(p)},nn.prototype.N=function(){this.g.l=null,delete this.j,ku(this.g),delete this.g,nn.aa.N.call(this)};function om(u){_u.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}y(om,_u);function am(){vu.call(this),this.status=1}y(am,vu);function ri(u){this.g=u}y(ri,im),ri.prototype.ua=function(){ve(this.g,"a")},ri.prototype.ta=function(u){ve(this.g,new om(u))},ri.prototype.sa=function(u){ve(this.g,new am)},ri.prototype.ra=function(){ve(this.g,"b")},Qa.prototype.createWebChannel=Qa.prototype.g,nn.prototype.send=nn.prototype.o,nn.prototype.open=nn.prototype.m,nn.prototype.close=nn.prototype.close,XT=function(){return new Qa},YT=function(){return La()},QT=_s,pf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fa.NO_ERROR=0,Fa.TIMEOUT=8,Fa.HTTP_ERROR=6,Cl=Fa,bp.COMPLETE="complete",JT=bp,_p.EventType=so,so.OPEN="a",so.CLOSE="b",so.ERROR="c",so.MESSAGE="d",ce.prototype.listen=ce.prototype.K,So=_p,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,GT=Ge}).apply(typeof cl<"u"?cl:typeof self<"u"?self:typeof window<"u"?window:{});const Ky="@firebase/firestore",Gy="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ct.UNAUTHENTICATED=new Ct(null),Ct.GOOGLE_CREDENTIALS=new Ct("google-credentials-uid"),Ct.FIRST_PARTY=new Ct("first-party-uid"),Ct.MOCK_USER=new Ct("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xi="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=new Sd("@firebase/firestore");function di(){return Ws.logLevel}function te(n,...e){if(Ws.logLevel<=Ie.DEBUG){const t=e.map(Vd);Ws.debug(`Firestore (${Xi}): ${n}`,...t)}}function yr(n,...e){if(Ws.logLevel<=Ie.ERROR){const t=e.map(Vd);Ws.error(`Firestore (${Xi}): ${n}`,...t)}}function zi(n,...e){if(Ws.logLevel<=Ie.WARN){const t=e.map(Vd);Ws.warn(`Firestore (${Xi}): ${n}`,...t)}}function Vd(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ZT(n,r,t)}function ZT(n,e,t){let r=`FIRESTORE (${Xi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw yr(r),new Error(r)}function Ne(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||ZT(e,s,r)}function ye(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends Er{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ct.UNAUTHENTICATED))}shutdown(){}}class k2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class R2{constructor(e){this.t=e,this.currentUser=Ct.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ne(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Fs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Fs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Fs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ne(typeof r.accessToken=="string",31837,{l:r}),new ew(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new Ct(e)}}class x2{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ct.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class P2{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new x2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ct.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Jy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ne(this.o===void 0,3512);const r=i=>{i.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Jy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Jy(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=O2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function we(n,e){return n<e?-1:n>e?1:0}function mf(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return we(r,s);{const i=tw(),o=N2(i.encode(Qy(n,t)),i.encode(Qy(e,t)));return o!==0?o:we(r,s)}}t+=r>65535?2:1}return we(n.length,e.length)}function Qy(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function N2(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return we(n[t],e[t]);return we(n.length,e.length)}function ji(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy=-62135596800,Xy=1e6;class rt{static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Xy);return new rt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ne(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ne(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Yy)throw new ne(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Xy}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Yy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{static fromTimestamp(e){return new me(e)}static min(){return new me(new rt(0,0))}static max(){return new me(new rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy="__name__";class Ln{constructor(e,t,r){t===void 0?t=0:t>e.length&&ue(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ue(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ln.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ln?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=Ln.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return we(e.length,t.length)}static compareSegments(e,t){const r=Ln.isNumericId(e),s=Ln.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Ln.extractNumericId(e).compare(Ln.extractNumericId(t)):mf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return es.fromString(e.substring(4,e.length-2))}}class $e extends Ln{construct(e,t,r){return new $e(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new $e(t)}static emptyPath(){return new $e([])}}const D2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends Ln{construct(e,t,r){return new vt(e,t,r)}static isValidIdentifier(e){return D2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Zy}static keyField(){return new vt([Zy])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ne(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ne(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ne(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ne(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(t)}static emptyPath(){return new vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae($e.fromString(e))}static fromName(e){return new ae($e.fromString(e).popFirst(5))}static empty(){return new ae($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $e.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new $e(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=-1;function V2(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=me.fromTimestamp(r===1e9?new rt(t+1,0):new rt(t,r));return new ls(s,ae.empty(),e)}function L2(n){return new ls(n.readTime,n.key,fa)}class ls{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ls(me.min(),ae.empty(),fa)}static max(){return new ls(me.max(),ae.empty(),fa)}}function F2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ae.comparator(n.documentKey,e.documentKey),t!==0?t:we(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class U2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zi(n){if(n.code!==z.FAILED_PRECONDITION||n.message!==B2)throw n;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new B((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof B?t:B.resolve(t)}catch(t){return B.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):B.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):B.reject(t)}static resolve(e){return new B((t,r)=>{t(e)})}static reject(e){return new B((t,r)=>{r(e)})}static waitFor(e){return new B((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=B.resolve(!1);for(const r of e)t=t.next(s=>s?B.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new B((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,t){return new B((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function $2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function eo(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>t.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}su.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=-1;function iu(n){return n==null}function cc(n){return n===0&&1/n==-1/0}function z2(n){return typeof n=="number"&&Number.isInteger(n)&&!cc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw="";function j2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=e_(e)),e=H2(n.get(t),e);return e_(e)}function H2(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case rw:t+="";break;default:t+=i}}return t}function e_(n){return n+rw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function sw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,t){this.comparator=e,this.root=t||pt.EMPTY}insert(e,t){return new Ke(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pt.BLACK,null,null))}remove(e){return new Ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ul(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ul(this.root,e,this.comparator,!1)}getReverseIterator(){return new ul(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ul(this.root,e,this.comparator,!0)}}class ul{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??pt.RED,this.left=s??pt.EMPTY,this.right=i??pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new pt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return pt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}pt.EMPTY=null,pt.RED=!0,pt.BLACK=!1;pt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new pt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new n_(this.data.getIterator())}getIteratorFrom(e){return new n_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new st(this.comparator);return t.data=e,t}}class n_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new Sn([])}unionWith(e){let t=new st(vt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Sn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ji(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new iw("Invalid base64 string: "+i):i}}(e);return new Et(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Et(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const q2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cs(n){if(Ne(!!n,39018),typeof n=="string"){let e=0;const t=q2.exec(n);if(Ne(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(n.seconds),nanos:Qe(n.nanos)}}function Qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function us(n){return typeof n=="string"?Et.fromBase64String(n):Et.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="server_timestamp",aw="__type__",lw="__previous_value__",cw="__local_write_time__";function Fd(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[aw])===null||t===void 0?void 0:t.stringValue)===ow}function ou(n){const e=n.mapValue.fields[lw];return Fd(e)?ou(e):e}function da(n){const e=cs(n.mapValue.fields[cw].timestampValue);return new rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e,t,r,s,i,o,a,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const uc="(default)";class pa{constructor(e,t){this.projectId=e,this.database=t||uc}static empty(){return new pa("","")}get isDefaultDatabase(){return this.database===uc}isEqual(e){return e instanceof pa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw="__type__",K2="__max__",hl={mapValue:{}},hw="__vector__",hc="value";function hs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fd(n)?4:J2(n)?9007199254740991:G2(n)?10:11:ue(28295,{value:n})}function Jn(n,e){if(n===e)return!0;const t=hs(n);if(t!==hs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return da(n).isEqual(da(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=cs(s.timestampValue),a=cs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return us(s.bytesValue).isEqual(us(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Qe(s.geoPointValue.latitude)===Qe(i.geoPointValue.latitude)&&Qe(s.geoPointValue.longitude)===Qe(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Qe(s.integerValue)===Qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Qe(s.doubleValue),a=Qe(i.doubleValue);return o===a?cc(o)===cc(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ji(n.arrayValue.values||[],e.arrayValue.values||[],Jn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(t_(o)!==t_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Jn(o[l],a[l])))return!1;return!0}(n,e);default:return ue(52216,{left:n})}}function ma(n,e){return(n.values||[]).find(t=>Jn(t,e))!==void 0}function Hi(n,e){if(n===e)return 0;const t=hs(n),r=hs(e);if(t!==r)return we(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return we(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Qe(i.integerValue||i.doubleValue),l=Qe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return r_(n.timestampValue,e.timestampValue);case 4:return r_(da(n),da(e));case 5:return mf(n.stringValue,e.stringValue);case 6:return function(i,o){const a=us(i),l=us(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=we(a[c],l[c]);if(h!==0)return h}return we(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=we(Qe(i.latitude),Qe(o.latitude));return a!==0?a:we(Qe(i.longitude),Qe(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return s_(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,h;const f=i.fields||{},d=o.fields||{},m=(a=f[hc])===null||a===void 0?void 0:a.arrayValue,y=(l=d[hc])===null||l===void 0?void 0:l.arrayValue,_=we(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((h=y==null?void 0:y.values)===null||h===void 0?void 0:h.length)||0);return _!==0?_:s_(m,y)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===hl.mapValue&&o===hl.mapValue)return 0;if(i===hl.mapValue)return 1;if(o===hl.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const d=mf(l[f],h[f]);if(d!==0)return d;const m=Hi(a[l[f]],c[h[f]]);if(m!==0)return m}return we(l.length,h.length)}(n.mapValue,e.mapValue);default:throw ue(23264,{Pe:t})}}function r_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return we(n,e);const t=cs(n),r=cs(e),s=we(t.seconds,r.seconds);return s!==0?s:we(t.nanos,r.nanos)}function s_(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Hi(t[s],r[s]);if(i)return i}return we(t.length,r.length)}function qi(n){return gf(n)}function gf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=cs(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return us(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ae.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=gf(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${gf(t.fields[o])}`;return s+"}"}(n.mapValue):ue(61005,{value:n})}function kl(n){switch(hs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ou(n);return e?16+kl(e):16;case 5:return 2*n.stringValue.length;case 6:return us(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+kl(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Qs(r.fields,(i,o)=>{s+=i.length+kl(o)}),s}(n.mapValue);default:throw ue(13486,{value:n})}}function i_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yf(n){return!!n&&"integerValue"in n}function Bd(n){return!!n&&"arrayValue"in n}function o_(n){return!!n&&"nullValue"in n}function a_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Rl(n){return!!n&&"mapValue"in n}function G2(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[uw])===null||t===void 0?void 0:t.stringValue)===hw}function jo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Qs(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=jo(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=jo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function J2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===K2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.value=e}static empty(){return new mn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Rl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=jo(t)}setAll(e){let t=vt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=jo(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Rl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Jn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Rl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Qs(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new mn(jo(this.value))}}function fw(n){const e=[];return Qs(n.fields,(t,r)=>{const s=new vt([t]);if(Rl(r)){const i=fw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Sn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Rt(e,0,me.min(),me.min(),me.min(),mn.empty(),0)}static newFoundDocument(e,t,r,s){return new Rt(e,1,t,me.min(),r,s,0)}static newNoDocument(e,t){return new Rt(e,2,t,me.min(),me.min(),mn.empty(),0)}static newUnknownDocument(e,t){return new Rt(e,3,t,me.min(),me.min(),mn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e,t){this.position=e,this.inclusive=t}}function l_(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),t.key):r=Hi(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function c_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Jn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,t="asc"){this.field=e,this.dir=t}}function Q2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{}class Ze extends dw{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new X2(e,t,r):t==="array-contains"?new tV(e,r):t==="in"?new nV(e,r):t==="not-in"?new rV(e,r):t==="array-contains-any"?new sV(e,r):new Ze(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Z2(e,r):new eV(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Hi(t,this.value)):t!==null&&hs(this.value)===hs(t)&&this.matchesComparison(Hi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pn extends dw{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Pn(e,t)}matches(e){return pw(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function pw(n){return n.op==="and"}function mw(n){return Y2(n)&&pw(n)}function Y2(n){for(const e of n.filters)if(e instanceof Pn)return!1;return!0}function _f(n){if(n instanceof Ze)return n.field.canonicalString()+n.op.toString()+qi(n.value);if(mw(n))return n.filters.map(e=>_f(e)).join(",");{const e=n.filters.map(t=>_f(t)).join(",");return`${n.op}(${e})`}}function gw(n,e){return n instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.field.isEqual(s.field)&&Jn(r.value,s.value)}(n,e):n instanceof Pn?function(r,s){return s instanceof Pn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&gw(o,s.filters[a]),!0):!1}(n,e):void ue(19439)}function yw(n){return n instanceof Ze?function(t){return`${t.field.canonicalString()} ${t.op} ${qi(t.value)}`}(n):n instanceof Pn?function(t){return t.op.toString()+" {"+t.getFilters().map(yw).join(" ,")+"}"}(n):"Filter"}class X2 extends Ze{constructor(e,t,r){super(e,t,r),this.key=ae.fromName(r.referenceValue)}matches(e){const t=ae.comparator(e.key,this.key);return this.matchesComparison(t)}}class Z2 extends Ze{constructor(e,t){super(e,"in",t),this.keys=_w("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class eV extends Ze{constructor(e,t){super(e,"not-in",t),this.keys=_w("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _w(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ae.fromName(r.referenceValue))}class tV extends Ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Bd(t)&&ma(t.arrayValue,this.value)}}class nV extends Ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ma(this.value.arrayValue,t)}}class rV extends Ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(ma(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ma(this.value.arrayValue,t)}}class sV extends Ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Bd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ma(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Ie=null}}function u_(n,e=null,t=[],r=[],s=null,i=null,o=null){return new iV(n,e,t,r,s,i,o)}function Ud(n){const e=ye(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_f(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),iu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qi(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qi(r)).join(",")),e.Ie=t}return e.Ie}function $d(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Q2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!c_(n.startAt,e.startAt)&&c_(n.endAt,e.endAt)}function vf(n){return ae.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function oV(n,e,t,r,s,i,o,a){return new to(n,e,t,r,s,i,o,a)}function zd(n){return new to(n)}function h_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function vw(n){return n.collectionGroup!==null}function Ho(n){const e=ye(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new st(vt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new ga(i,r))}),t.has(vt.keyField().canonicalString())||e.Ee.push(new ga(vt.keyField(),r))}return e.Ee}function Hn(n){const e=ye(n);return e.de||(e.de=aV(e,Ho(n))),e.de}function aV(n,e){if(n.limitType==="F")return u_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ga(s.field,i)});const t=n.endAt?new fc(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new fc(n.startAt.position,n.startAt.inclusive):null;return u_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ef(n,e){const t=n.filters.concat([e]);return new to(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Tf(n,e,t){return new to(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function au(n,e){return $d(Hn(n),Hn(e))&&n.limitType===e.limitType}function Ew(n){return`${Ud(Hn(n))}|lt:${n.limitType}`}function pi(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>yw(s)).join(", ")}]`),iu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>qi(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>qi(s)).join(",")),`Target(${r})`}(Hn(n))}; limitType=${n.limitType})`}function lu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Ho(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=l_(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Ho(r),s)||r.endAt&&!function(o,a,l){const c=l_(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Ho(r),s))}(n,e)}function lV(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Tw(n){return(e,t)=>{let r=!1;for(const s of Ho(n)){const i=cV(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function cV(n,e,t){const r=n.field.isKeyField()?ae.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Hi(l,c):ue(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ue(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Qs(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return sw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uV=new Ke(ae.comparator);function _r(){return uV}const ww=new Ke(ae.comparator);function Ao(...n){let e=ww;for(const t of n)e=e.insert(t.key,t);return e}function bw(n){let e=ww;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ps(){return qo()}function Iw(){return qo()}function qo(){return new Ys(n=>n.toString(),(n,e)=>n.isEqual(e))}const hV=new Ke(ae.comparator),fV=new st(ae.comparator);function Se(...n){let e=fV;for(const t of n)e=e.add(t);return e}const dV=new st(we);function pV(){return dV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cc(e)?"-0":e}}function Sw(n){return{integerValue:""+n}}function mV(n,e){return z2(e)?Sw(e):jd(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(){this._=void 0}}function gV(n,e,t){return n instanceof dc?function(s,i){const o={fields:{[aw]:{stringValue:ow},[cw]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Fd(i)&&(i=ou(i)),i&&(o.fields[lw]=i),{mapValue:o}}(t,e):n instanceof ya?Cw(n,e):n instanceof _a?kw(n,e):function(s,i){const o=Aw(s,i),a=f_(o)+f_(s.Re);return yf(o)&&yf(s.Re)?Sw(a):jd(s.serializer,a)}(n,e)}function yV(n,e,t){return n instanceof ya?Cw(n,e):n instanceof _a?kw(n,e):t}function Aw(n,e){return n instanceof pc?function(r){return yf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class dc extends cu{}class ya extends cu{constructor(e){super(),this.elements=e}}function Cw(n,e){const t=Rw(e);for(const r of n.elements)t.some(s=>Jn(s,r))||t.push(r);return{arrayValue:{values:t}}}class _a extends cu{constructor(e){super(),this.elements=e}}function kw(n,e){let t=Rw(e);for(const r of n.elements)t=t.filter(s=>!Jn(s,r));return{arrayValue:{values:t}}}class pc extends cu{constructor(e,t){super(),this.serializer=e,this.Re=t}}function f_(n){return Qe(n.integerValue||n.doubleValue)}function Rw(n){return Bd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function _V(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof ya&&s instanceof ya||r instanceof _a&&s instanceof _a?ji(r.elements,s.elements,Jn):r instanceof pc&&s instanceof pc?Jn(r.Re,s.Re):r instanceof dc&&s instanceof dc}(n.transform,e.transform)}class vV{constructor(e,t){this.version=e,this.transformResults=t}}class hr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hr}static exists(e){return new hr(void 0,e)}static updateTime(e){return new hr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class uu{}function xw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Mw(n.key,hr.none()):new Ma(n.key,n.data,hr.none());{const t=n.data,r=mn.empty();let s=new st(vt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Xs(n.key,r,new Sn(s.toArray()),hr.none())}}function EV(n,e,t){n instanceof Ma?function(s,i,o){const a=s.value.clone(),l=p_(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Xs?function(s,i,o){if(!xl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=p_(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Pw(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wo(n,e,t,r){return n instanceof Ma?function(i,o,a,l){if(!xl(i.precondition,o))return a;const c=i.value.clone(),h=m_(i.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Xs?function(i,o,a,l){if(!xl(i.precondition,o))return a;const c=m_(i.fieldTransforms,l,o),h=o.data;return h.setAll(Pw(i)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return xl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function TV(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Aw(r.transform,s||null);i!=null&&(t===null&&(t=mn.empty()),t.set(r.field,i))}return t||null}function d_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ji(r,s,(i,o)=>_V(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ma extends uu{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Xs extends uu{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Pw(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function p_(n,e,t){const r=new Map;Ne(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,yV(o,a,t[s]))}return r}function m_(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,gV(i,o,e))}return r}class Mw extends uu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wV extends uu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&EV(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Wo(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Wo(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Iw();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=xw(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(me.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Se())}isEqual(e){return this.batchId===e.batchId&&ji(this.mutations,e.mutations,(t,r)=>d_(t,r))&&ji(this.baseMutations,e.baseMutations,(t,r)=>d_(t,r))}}class Hd{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ne(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return hV}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Hd(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,ke;function AV(n){switch(n){case z.OK:return ue(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return ue(15467,{code:n})}}function Ow(n){if(n===void 0)return yr("GRPC error has no .code"),z.UNKNOWN;switch(n){case Xe.OK:return z.OK;case Xe.CANCELLED:return z.CANCELLED;case Xe.UNKNOWN:return z.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return z.INTERNAL;case Xe.UNAVAILABLE:return z.UNAVAILABLE;case Xe.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Xe.NOT_FOUND:return z.NOT_FOUND;case Xe.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Xe.ABORTED:return z.ABORTED;case Xe.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Xe.DATA_LOSS:return z.DATA_LOSS;default:return ue(39323,{code:n})}}(ke=Xe||(Xe={}))[ke.OK=0]="OK",ke[ke.CANCELLED=1]="CANCELLED",ke[ke.UNKNOWN=2]="UNKNOWN",ke[ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ke[ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ke[ke.NOT_FOUND=5]="NOT_FOUND",ke[ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",ke[ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",ke[ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",ke[ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ke[ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ke[ke.ABORTED=10]="ABORTED",ke[ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",ke[ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",ke[ke.INTERNAL=13]="INTERNAL",ke[ke.UNAVAILABLE=14]="UNAVAILABLE",ke[ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV=new es([4294967295,4294967295],0);function g_(n){const e=tw().encode(n),t=new KT;return t.update(e),new Uint8Array(t.digest())}function y_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new es([t,r],0),new es([s,i],0)]}class qd{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Co(`Invalid padding: ${t}`);if(r<0)throw new Co(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Co(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Co(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=es.fromNumber(this.pe)}we(e,t,r){let s=e.add(t.multiply(es.fromNumber(r)));return s.compare(CV)===1&&(s=new es([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=g_(e),[r,s]=y_(t);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new qd(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.pe===0)return;const t=g_(e),[r,s]=y_(t);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Co extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Oa.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new hu(me.min(),s,new Ke(we),_r(),Se())}}class Oa{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Oa(r,t,Se(),Se(),Se())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,t,r,s){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=s}}class Nw{constructor(e,t){this.targetId=e,this.Ce=t}}class Dw{constructor(e,t,r=Et.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class __{constructor(){this.Fe=0,this.Me=v_(),this.xe=Et.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Se(),t=Se(),r=Se();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:ue(38017,{changeType:i})}}),new Oa(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=v_()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ne(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class kV{constructor(e){this.ze=e,this.je=new Map,this.He=_r(),this.Je=fl(),this.Ye=fl(),this.Ze=new Ke(we)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,s)=>{this.it(s)&&t(s)})}ot(e){const t=e.targetId,r=e.Ce.count,s=this._t(t);if(s){const i=s.target;if(vf(i))if(r===0){const o=new ae(i.path);this.tt(t,o,Rt.newNoDocument(o,me.min()))}else Ne(r===1,20013,{expectedCount:r});else{const o=this.ut(t);if(o!==r){const a=this.ct(e),l=a?this.lt(a,e,o):1;if(l!==0){this.st(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,c)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=us(r).toUint8Array()}catch(l){if(l instanceof iw)return zi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new qd(o,s,i)}catch(l){return zi(l instanceof Co?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.pe===0?null:a}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){const r=this.ze.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.tt(t,i,null),s++)}),s}It(e){const t=new Map;this.je.forEach((i,o)=>{const a=this._t(o);if(a){if(i.current&&vf(a.target)){const l=new ae(a.target.path);this.Et(l).has(o)||this.dt(o,l)||this.tt(o,l,Rt.newNoDocument(l,e))}i.Le&&(t.set(o,i.qe()),i.Qe())}});let r=Se();this.Ye.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this._t(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new hu(e,t,this.Ze,this.He,r);return this.He=_r(),this.Je=fl(),this.Ye=fl(),this.Ze=new Ke(we),s}et(e,t){if(!this.it(e))return;const r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,t)?s.$e(t,1):s.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new __,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new st(we),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new st(we),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||te("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new __),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function fl(){return new Ke(ae.comparator)}function v_(){return new Ke(ae.comparator)}const RV={asc:"ASCENDING",desc:"DESCENDING"},xV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PV={and:"AND",or:"OR"};class MV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wf(n,e){return n.useProto3Json||iu(e)?e:{value:e}}function mc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function OV(n,e){return mc(n,e.toTimestamp())}function qn(n){return Ne(!!n,49232),me.fromTimestamp(function(t){const r=cs(t);return new rt(r.seconds,r.nanos)}(n))}function Wd(n,e){return bf(n,e).canonicalString()}function bf(n,e){const t=function(s){return new $e(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Lw(n){const e=$e.fromString(n);return Ne(zw(e),10190,{key:e.toString()}),e}function If(n,e){return Wd(n.databaseId,e.path)}function vh(n,e){const t=Lw(e);if(t.get(1)!==n.databaseId.projectId)throw new ne(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ne(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ae(Bw(t))}function Fw(n,e){return Wd(n.databaseId,e)}function NV(n){const e=Lw(n);return e.length===4?$e.emptyPath():Bw(e)}function Sf(n){return new $e(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Bw(n){return Ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function E_(n,e,t){return{name:If(n,e),fields:t.value.mapValue.fields}}function DV(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ue(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,h){return c.useProto3Json?(Ne(h===void 0||typeof h=="string",58123),Et.fromBase64String(h||"")):(Ne(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Et.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?z.UNKNOWN:Ow(c.code);return new ne(h,c.message||"")}(o);t=new Dw(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=vh(n,r.document.name),i=qn(r.document.updateTime),o=r.document.createTime?qn(r.document.createTime):me.min(),a=new mn({mapValue:{fields:r.document.fields}}),l=Rt.newFoundDocument(s,i,o,a),c=r.targetIds||[],h=r.removedTargetIds||[];t=new Pl(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=vh(n,r.document),i=r.readTime?qn(r.readTime):me.min(),o=Rt.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Pl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=vh(n,r.document),i=r.removedTargetIds||[];t=new Pl([],i,s,null)}else{if(!("filter"in e))return ue(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new SV(s,i),a=r.targetId;t=new Nw(a,o)}}return t}function VV(n,e){let t;if(e instanceof Ma)t={update:E_(n,e.key,e.value)};else if(e instanceof Mw)t={delete:If(n,e.key)};else if(e instanceof Xs)t={update:E_(n,e.key,e.data),updateMask:qV(e.fieldMask)};else{if(!(e instanceof wV))return ue(16599,{ft:e.type});t={verify:If(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof dc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ya)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof _a)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof pc)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw ue(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:OV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ue(27497)}(n,e.precondition)),t}function LV(n,e){return n&&n.length>0?(Ne(e!==void 0,14353),n.map(t=>function(s,i){let o=s.updateTime?qn(s.updateTime):qn(i);return o.isEqual(me.min())&&(o=qn(i)),new vV(o,s.transformResults||[])}(t,e))):[]}function FV(n,e){return{documents:[Fw(n,e.path)]}}function BV(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Fw(n,s);const i=function(c){if(c.length!==0)return $w(Pn.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(h=>function(d){return{field:mi(d.field),direction:zV(d.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=wf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{gt:t,parent:s}}function UV(n){let e=NV(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ne(r===1,65062);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=function(f){const d=Uw(f);return d instanceof Pn&&mw(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(d=>function(y){return new ga(gi(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(d))}(t.orderBy));let a=null;t.limit&&(a=function(f){let d;return d=typeof f=="object"?f.value:f,iu(d)?null:d}(t.limit));let l=null;t.startAt&&(l=function(f){const d=!!f.before,m=f.values||[];return new fc(m,d)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const d=!f.before,m=f.values||[];return new fc(m,d)}(t.endAt)),oV(e,s,o,i,a,"F",l,c)}function $V(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Uw(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=gi(t.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=gi(t.unaryFilter.field);return Ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=gi(t.unaryFilter.field);return Ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=gi(t.unaryFilter.field);return Ze.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(n):n.fieldFilter!==void 0?function(t){return Ze.create(gi(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Pn.create(t.compositeFilter.filters.map(r=>Uw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(t.compositeFilter.op))}(n):ue(30097,{filter:n})}function zV(n){return RV[n]}function jV(n){return xV[n]}function HV(n){return PV[n]}function mi(n){return{fieldPath:n.canonicalString()}}function gi(n){return vt.fromServerFormat(n.fieldPath)}function $w(n){return n instanceof Ze?function(t){if(t.op==="=="){if(a_(t.value))return{unaryFilter:{field:mi(t.field),op:"IS_NAN"}};if(o_(t.value))return{unaryFilter:{field:mi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(a_(t.value))return{unaryFilter:{field:mi(t.field),op:"IS_NOT_NAN"}};if(o_(t.value))return{unaryFilter:{field:mi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mi(t.field),op:jV(t.op),value:t.value}}}(n):n instanceof Pn?function(t){const r=t.getFilters().map(s=>$w(s));return r.length===1?r[0]:{compositeFilter:{op:HV(t.op),filters:r}}}(n):ue(54877,{filter:n})}function qV(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function zw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,t,r,s,i=me.min(),o=me.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e){this.wt=e}}function KV(n){const e=UV({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Tf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this.Cn=new JV}addToCollectionParentIndex(e,t){return this.Cn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(ls.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(ls.min())}updateCollectionGroup(e,t,r){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}}class JV{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new st($e.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new st($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jw=41943040;class Kt{static withCacheSize(e){return new Kt(e,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kt.DEFAULT_COLLECTION_PERCENTILE=10,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kt.DEFAULT=new Kt(jw,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kt.DISABLED=new Kt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Wi(0)}static lr(){return new Wi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_="LruGarbageCollector",QV=1048576;function b_([n,e],[t,r]){const s=we(n,t);return s===0?we(e,r):s}class YV{constructor(e){this.Er=e,this.buffer=new st(b_),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();b_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class XV{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){te(w_,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){eo(t)?te(w_,"Ignoring IndexedDB error during garbage collection: ",t):await Zi(t)}await this.mr(3e5)})}}class ZV{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return B.resolve(su.le);const r=new YV(t);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(T_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),T_):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,s,i,o,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),di()<=Ie.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function eL(n,e){return new ZV(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(){this.changes=new Ys(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?B.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Wo(r.mutation,s,Sn.empty(),rt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Se()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Se()){const s=Ps();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Ao();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Ps();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Se()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=_r();const o=qo(),a=function(){return qo()}();return t.forEach((l,c)=>{const h=r.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof Xs)?i=i.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Wo(h.mutation,c,h.mutation.getFieldMask(),rt.now())):o.set(c.key,Sn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var f;return a.set(c,new nL(h,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=qo();let s=new Ke((o,a)=>o-a),i=Se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||Sn.empty();h=a.applyToLocalView(c,h),r.set(l,h);const f=(s.get(a.batchId)||Se()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,f=Iw();h.forEach(d=>{if(!i.has(d)){const m=xw(t.get(d),r.get(d));m!==null&&f.set(d,m),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return B.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):vw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):B.resolve(Ps());let a=fa,l=i;return o.next(c=>B.forEach(c,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(h)?B.resolve():this.remoteDocumentCache.getEntry(e,h).next(d=>{l=l.insert(h,d)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Se())).next(h=>({batchId:a,changes:bw(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ae(t)).next(r=>{let s=Ao();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Ao();return this.indexManager.getCollectionParents(e,i).next(a=>B.forEach(a,l=>{const c=function(f,d){return new to(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(h=>{h.forEach((f,d)=>{o=o.insert(f,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,Rt.newInvalidDocument(h)))});let a=Ao();return o.forEach((l,c)=>{const h=i.get(l);h!==void 0&&Wo(h.mutation,c,Sn.empty(),rt.now()),lu(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return B.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:qn(s.createTime)}}(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(s){return{name:s.name,query:KV(s.bundledQuery),readTime:qn(s.readTime)}}(t)),B.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(){this.overlays=new Ke(ae.comparator),this.Qr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ps();return B.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.bt(e,t,i)}),B.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),B.resolve()}getOverlaysForCollection(e,t,r){const s=Ps(),i=t.length+1,o=new ae(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return B.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Ke((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=i.get(c.largestBatchId);h===null&&(h=Ps(),i=i.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Ps(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=s)););return B.resolve(a)}bt(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new IV(t,r));let i=this.Qr.get(t);i===void 0&&(i=Se(),this.Qr.set(t,i)),this.Qr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(){this.$r=new st(it.Ur),this.Kr=new st(it.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const r=new it(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new it(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){const t=new ae(new $e([])),r=new it(t,e),s=new it(t,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new ae(new $e([])),r=new it(t,e),s=new it(t,e+1);let i=Se();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new it(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class it{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return ae.comparator(e.key,t.key)||we(e.Zr,t.Zr)}static Wr(e,t){return we(e.Zr,t.Zr)||ae.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new st(it.Ur)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new bV(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Xr=this.Xr.add(new it(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return B.resolve(o)}lookupMutationBatch(e,t){return B.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ti(r),i=s<0?0:s;return B.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?Ld:this.nr-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new it(t,0),s=new it(t,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const a=this.ei(o.Zr);i.push(a)}),B.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new st(we);return t.forEach(s=>{const i=new it(s,0),o=new it(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],a=>{r=r.add(a.Zr)})}),B.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const o=new it(new ae(i),0);let a=new st(we);return this.Xr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Zr)),!0)},o),B.resolve(this.ni(a))}ni(e){const t=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ne(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return B.forEach(t.mutations,s=>{const i=new it(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){const r=new it(t,0),s=this.Xr.firstAfterOrEqual(r);return B.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e){this.ii=e,this.docs=function(){return new Ke(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return B.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(t))}getEntries(e,t){let r=_r();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Rt.newInvalidDocument(s))}),B.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=_r();const o=t.path,a=new ae(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||F2(L2(h),r)<=0||(s.has(h.key)||lu(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return B.resolve(i)}getAllFromCollectionGroup(e,t,r,s){ue(9500)}si(e,t){return B.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new cL(this)}getSize(e){return B.resolve(this.size)}}class cL extends tL{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),B.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e){this.persistence=e,this.oi=new Ys(t=>Ud(t),$d),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this._i=0,this.ai=new Kd,this.targetCount=0,this.ui=Wi.cr()}forEachTarget(e,t){return this.oi.forEach((r,s)=>t(s)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),B.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Wi(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.Tr(t),B.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.oi.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),B.waitFor(i).next(()=>s)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){const r=this.oi.get(t)||null;return B.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),B.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),B.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),B.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ai.Yr(t);return B.resolve(r)}containsKey(e,t){return B.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e,t){this.ci={},this.overlays={},this.li=new su(0),this.hi=!1,this.hi=!0,this.Pi=new oL,this.referenceDelegate=e(this),this.Ti=new uL(this),this.indexManager=new GV,this.remoteDocumentCache=function(s){return new lL(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new WV(t),this.Ei=new sL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new iL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new aL(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){te("MemoryPersistence","Starting transaction:",e);const s=new hL(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,t){return B.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class hL extends U2{constructor(e){super(),this.currentSequenceNumber=e}}class Gd{constructor(e){this.persistence=e,this.Vi=new Kd,this.mi=null}static fi(e){return new Gd(e)}get gi(){if(this.mi)return this.mi;throw ue(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),B.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),B.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.gi,r=>{const s=ae.fromPath(r);return this.pi(e,s).next(i=>{i||t.removeEntry(s,me.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return B.or([()=>B.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class gc{constructor(e,t){this.persistence=e,this.yi=new Ys(r=>j2(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=eL(this,t)}static fi(e,t){return new gc(e,t)}di(){}Ai(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}Sr(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return B.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?B.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,t).next(a=>{a||(r++,i.removeEntry(o,me.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),B.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=kl(e.data.value)),t}Dr(e,t,r){return B.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.yi.get(t);return B.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.ds=r,this.As=s}static Rs(e,t){let r=Se(),s=Se();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Jd(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return aO()?8:$2(Ot())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ws(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new fL;return this.bs(e,t,o).next(a=>{if(i.result=a,this.fs)return this.Ds(e,t,o,a.size)})}).next(()=>i.result)}Ds(e,t,r,s){return r.documentReadCount<this.gs?(di()<=Ie.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",pi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),B.resolve()):(di()<=Ie.DEBUG&&te("QueryEngine","Query:",pi(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(di()<=Ie.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",pi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(t))):B.resolve())}ws(e,t){if(h_(t))return B.resolve(null);let r=Hn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Tf(t,null,"F"),r=Hn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Se(...i);return this.ys.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.vs(t,a);return this.Cs(t,c,o,l.readTime)?this.ws(e,Tf(t,null,"F")):this.Fs(e,c,t,l)}))})))}Ss(e,t,r,s){return h_(t)||s.isEqual(me.min())?B.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(t,i);return this.Cs(t,o,r,s)?B.resolve(null):(di()<=Ie.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),pi(t)),this.Fs(e,o,t,V2(s,fa)).next(a=>a))})}vs(e,t){let r=new st(Tw(e));return t.forEach((s,i)=>{lu(e,i)&&(r=r.add(i))}),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,t,r){return di()<=Ie.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",pi(t)),this.ys.getDocumentsMatchingQuery(e,t,ls.min(),r)}Fs(e,t,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="LocalStore",pL=3e8;class mL{constructor(e,t,r,s){this.persistence=e,this.Ms=t,this.serializer=s,this.xs=new Ke(we),this.Os=new Ys(i=>Ud(i),$d),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rL(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function gL(n,e,t,r){return new mL(n,e,t,r)}async function qw(n,e){const t=ye(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Se();for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(c=>({ks:c,removedBatchIds:o,addedBatchIds:a}))})})}function yL(n,e){const t=ye(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.Bs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const f=c.batch,d=f.keys();let m=B.resolve();return d.forEach(y=>{m=m.next(()=>h.getEntry(l,y)).next(_=>{const E=c.docVersions.get(y);Ne(E!==null,48541),_.version.compareTo(E)<0&&(f.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),h.addEntry(_)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Se();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function Ww(n){const e=ye(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function _L(n,e){const t=ye(n),r=e.snapshotVersion;let s=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Bs.newChangeBuffer({trackRemovals:!0});s=t.xs;const a=[];e.targetChanges.forEach((h,f)=>{const d=s.get(f);if(!d)return;a.push(t.Ti.removeMatchingKeys(i,h.removedDocuments,f).next(()=>t.Ti.addMatchingKeys(i,h.addedDocuments,f)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(Et.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),s=s.insert(f,m),function(_,E,k){return _.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=pL?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(d,m,h)&&a.push(t.Ti.updateTargetData(i,m))});let l=_r(),c=Se();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(vL(i,o,e.documentUpdates).next(h=>{l=h.qs,c=h.Qs})),!r.isEqual(me.min())){const h=t.Ti.getLastRemoteSnapshotVersion(i).next(f=>t.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return B.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.xs=s,i))}function vL(n,e,t){let r=Se(),s=Se();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=_r();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):te(Qd,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{qs:o,Qs:s}})}function EL(n,e){const t=ye(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ld),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function TL(n,e){const t=ye(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ti.getTargetData(r,e).next(i=>i?(s=i,B.resolve(s)):t.Ti.allocateTargetId(r).next(o=>(s=new zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}async function Af(n,e,t){const r=ye(n),s=r.xs.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!eo(o))throw o;te(Qd,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function I_(n,e,t){const r=ye(n);let s=me.min(),i=Se();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const f=ye(l),d=f.Os.get(h);return d!==void 0?B.resolve(f.xs.get(d)):f.Ti.getTargetData(c,h)}(r,o,Hn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,t?s:me.min(),t?i:Se())).next(a=>(wL(r,lV(e),a),{documents:a,$s:i})))}function wL(n,e,t){let r=n.Ns.get(e)||me.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ns.set(e,r)}class S_{constructor(){this.activeTargetIds=pV()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bL{constructor(){this.xo=new S_,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new S_,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="ConnectivityMonitor";class C_{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){te(A_,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){te(A_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl=null;function Cf(){return dl===null?dl=function(){return 268435456+Math.round(2147483648*Math.random())}():dl++,"0x"+dl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="RestConnection",SL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class AL{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===uc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,t,r,s,i){const o=Cf(),a=this.jo(e,t.toUriEncodedString());te(Eh,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(l,s,i);const{host:c}=new URL(a),h=Aa(c);return this.Jo(e,a,l,r,h).then(f=>(te(Eh,`Received RPC '${e}' ${o}: `,f),f),f=>{throw zi(Eh,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Yo(e,t,r,s,i,o){return this.zo(e,t,r,s,i)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,t){const r=SL[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection";class kL extends AL{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const o=Cf();return new Promise((a,l)=>{const c=new GT;c.setWithCredentials(!0),c.listenOnce(JT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Cl.NO_ERROR:const f=c.getResponseJson();te(St,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Cl.TIMEOUT:te(St,`RPC '${e}' ${o} timed out`),l(new ne(z.DEADLINE_EXCEEDED,"Request time out"));break;case Cl.HTTP_ERROR:const d=c.getStatus();if(te(St,`RPC '${e}' ${o} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const _=function(k){const O=k.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(O)>=0?O:z.UNKNOWN}(y.status);l(new ne(_,y.message))}else l(new ne(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ne(z.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{te(St,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);te(St,`RPC '${e}' ${o} sending request:`,s),c.send(t,"POST",h,r,15)})}T_(e,t,r){const s=Cf(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=XT(),a=YT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Ho(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=i.join("");te(St,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);let d=!1,m=!1;const y=new CL({Zo:E=>{m?te(St,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(d||(te(St,`Opening RPC '${e}' stream ${s} transport.`),f.open(),d=!0),te(St,`RPC '${e}' stream ${s} sending:`,E),f.send(E))},Xo:()=>f.close()}),_=(E,k,O)=>{E.listen(k,D=>{try{O(D)}catch(U){setTimeout(()=>{throw U},0)}})};return _(f,So.EventType.OPEN,()=>{m||(te(St,`RPC '${e}' stream ${s} transport opened.`),y.__())}),_(f,So.EventType.CLOSE,()=>{m||(m=!0,te(St,`RPC '${e}' stream ${s} transport closed`),y.u_())}),_(f,So.EventType.ERROR,E=>{m||(m=!0,zi(St,`RPC '${e}' stream ${s} transport errored. Name:`,E.name,"Message:",E.message),y.u_(new ne(z.UNAVAILABLE,"The operation could not be completed")))}),_(f,So.EventType.MESSAGE,E=>{var k;if(!m){const O=E.data[0];Ne(!!O,16349);const D=O,U=(D==null?void 0:D.error)||((k=D[0])===null||k===void 0?void 0:k.error);if(U){te(St,`RPC '${e}' stream ${s} received error:`,U);const X=U.status;let Z=function(w){const C=Xe[w];if(C!==void 0)return Ow(C)}(X),A=U.message;Z===void 0&&(Z=z.INTERNAL,A="Unknown error status: "+X+" with message "+U.message),m=!0,y.u_(new ne(Z,A)),f.close()}else te(St,`RPC '${e}' stream ${s} received:`,O),y.c_(O)}}),_(a,QT.STAT_EVENT,E=>{E.stat===pf.PROXY?te(St,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===pf.NOPROXY&&te(St,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.a_()},0),y}}function Th(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(n){return new MV(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,t,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=t,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const t=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,t-r);s>0&&te("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_="PersistentStream";class Gw{constructor(e,t,r,s,i,o,a,l){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new Kw(e,t)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,t){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():t&&t.code===z.RESOURCE_EXHAUSTED?(yr(t.toString()),yr("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):t&&t.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),t=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===t&&this.K_(r,s)},r=>{e(()=>{const s=new ne(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,t){const r=this.U_(this.S_);this.stream=this.G_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return te(k_,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return t=>{this.xi.enqueueAndForget(()=>this.S_===e?t():(te(k_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RL extends Gw{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}G_(e,t){return this.connection.T_("Listen",e,t)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const t=DV(this.serializer,e),r=function(i){if(!("targetChange"in i))return me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?qn(o.readTime):me.min()}(e);return this.listener.j_(t,r)}H_(e){const t={};t.database=Sf(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=vf(l)?{documents:FV(i,l)}:{query:BV(i,l).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Vw(i,o.resumeToken);const c=wf(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(me.min())>0){a.readTime=mc(i,o.snapshotVersion.toTimestamp());const c=wf(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=$V(this.serializer,e);r&&(t.labels=r),this.L_(t)}J_(e){const t={};t.database=Sf(this.serializer),t.removeTarget=e,this.L_(t)}}class xL extends Gw{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,t){return this.connection.T_("Write",e,t)}z_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const t=LV(e.writeResults,e.commitTime),r=qn(e.commitTime);return this.listener.ea(r,t)}ta(){const e={};e.database=Sf(this.serializer),this.L_(e)}Z_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>VV(this.serializer,r))};this.L_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{}class ML extends PL{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new ne(z.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,bf(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ne(z.UNKNOWN,i.toString())})}Yo(e,t,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Yo(e,bf(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(z.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class OL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(yr(t),this.oa=!1):te("OnlineStateTracker",t)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="RemoteStore";class NL{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{Zs(this)&&(te(Ks,"Restarting streams for network reachability change."),await async function(l){const c=ye(l);c.Ta.add(4),await Na(c),c.da.set("Unknown"),c.Ta.delete(4),await du(c)}(this))})}),this.da=new OL(r,s)}}async function du(n){if(Zs(n))for(const e of n.Ia)await e(!0)}async function Na(n){for(const e of n.Ia)await e(!1)}function Jw(n,e){const t=ye(n);t.Pa.has(e.targetId)||(t.Pa.set(e.targetId,e),ep(t)?Zd(t):no(t).M_()&&Xd(t,e))}function Yd(n,e){const t=ye(n),r=no(t);t.Pa.delete(e),r.M_()&&Qw(t,e),t.Pa.size===0&&(r.M_()?r.N_():Zs(t)&&t.da.set("Unknown"))}function Xd(n,e){if(n.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}no(n).H_(e)}function Qw(n,e){n.Aa.Ke(e),no(n).J_(e)}function Zd(n){n.Aa=new kV({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Pa.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),no(n).start(),n.da._a()}function ep(n){return Zs(n)&&!no(n).F_()&&n.Pa.size>0}function Zs(n){return ye(n).Ta.size===0}function Yw(n){n.Aa=void 0}async function DL(n){n.da.set("Online")}async function VL(n){n.Pa.forEach((e,t)=>{Xd(n,e)})}async function LL(n,e){Yw(n),ep(n)?(n.da.ca(e),Zd(n)):n.da.set("Unknown")}async function FL(n,e,t){if(n.da.set("Online"),e instanceof Dw&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Pa.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Pa.delete(a),s.Aa.removeTarget(a))}(n,e)}catch(r){te(Ks,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await yc(n,r)}else if(e instanceof Pl?n.Aa.Xe(e):e instanceof Nw?n.Aa.ot(e):n.Aa.nt(e),!t.isEqual(me.min()))try{const r=await Ww(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Aa.It(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Pa.get(c);h&&i.Pa.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=i.Pa.get(l);if(!h)return;i.Pa.set(l,h.withResumeToken(Et.EMPTY_BYTE_STRING,h.snapshotVersion)),Qw(i,l);const f=new zr(h.target,l,c,h.sequenceNumber);Xd(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){te(Ks,"Failed to raise snapshot:",r),await yc(n,r)}}async function yc(n,e,t){if(!eo(e))throw e;n.Ta.add(1),await Na(n),n.da.set("Offline"),t||(t=()=>Ww(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{te(Ks,"Retrying IndexedDB access"),await t(),n.Ta.delete(1),await du(n)})}function Xw(n,e){return e().catch(t=>yc(n,t,e))}async function pu(n){const e=ye(n),t=fs(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:Ld;for(;BL(e);)try{const s=await EL(e.localStore,r);if(s===null){e.ha.length===0&&t.N_();break}r=s.batchId,UL(e,s)}catch(s){await yc(e,s)}Zw(e)&&eb(e)}function BL(n){return Zs(n)&&n.ha.length<10}function UL(n,e){n.ha.push(e);const t=fs(n);t.M_()&&t.Y_&&t.Z_(e.mutations)}function Zw(n){return Zs(n)&&!fs(n).F_()&&n.ha.length>0}function eb(n){fs(n).start()}async function $L(n){fs(n).ta()}async function zL(n){const e=fs(n);for(const t of n.ha)e.Z_(t.mutations)}async function jL(n,e,t){const r=n.ha.shift(),s=Hd.from(r,e,t);await Xw(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await pu(n)}async function HL(n,e){e&&fs(n).Y_&&await async function(r,s){if(function(o){return AV(o)&&o!==z.ABORTED}(s.code)){const i=r.ha.shift();fs(r).O_(),await Xw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await pu(r)}}(n,e),Zw(n)&&eb(n)}async function R_(n,e){const t=ye(n);t.asyncQueue.verifyOperationInProgress(),te(Ks,"RemoteStore received new credentials");const r=Zs(t);t.Ta.add(3),await Na(t),r&&t.da.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ta.delete(3),await du(t)}async function qL(n,e){const t=ye(n);e?(t.Ta.delete(2),await du(t)):e||(t.Ta.add(2),await Na(t),t.da.set("Unknown"))}function no(n){return n.Ra||(n.Ra=function(t,r,s){const i=ye(t);return i.ra(),new RL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{e_:DL.bind(null,n),n_:VL.bind(null,n),i_:LL.bind(null,n),j_:FL.bind(null,n)}),n.Ia.push(async e=>{e?(n.Ra.O_(),ep(n)?Zd(n):n.da.set("Unknown")):(await n.Ra.stop(),Yw(n))})),n.Ra}function fs(n){return n.Va||(n.Va=function(t,r,s){const i=ye(t);return i.ra(),new xL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:$L.bind(null,n),i_:HL.bind(null,n),X_:zL.bind(null,n),ea:jL.bind(null,n)}),n.Ia.push(async e=>{e?(n.Va.O_(),await pu(n)):(await n.Va.stop(),n.ha.length>0&&(te(Ks,`Stopping write stream with ${n.ha.length} pending writes`),n.ha=[]))})),n.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Fs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new tp(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function np(n,e){if(yr("AsyncQueue",`${e}: ${n}`),eo(n))return new ne(z.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{static emptySet(e){return new xi(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ae.comparator(t.key,r.key):(t,r)=>ae.comparator(t.key,r.key),this.keyedMap=Ao(),this.sortedSet=new Ke(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new xi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(){this.ma=new Ke(ae.comparator)}track(e){const t=e.doc.key,r=this.ma.get(t);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(t,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(t):e.type===1&&r.type===2?this.ma=this.ma.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(t,{type:2,doc:e.doc}):ue(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(t,e)}ga(){const e=[];return this.ma.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ki{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Ki(e,t,xi.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&au(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class KL{constructor(){this.queries=P_(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(t,r){const s=ye(t),i=s.queries;s.queries=P_(),i.forEach((o,a)=>{for(const l of a.ya)l.onError(r)})})(this,new ne(z.ABORTED,"Firestore shutting down"))}}function P_(){return new Ys(n=>Ew(n),au)}async function GL(n,e){const t=ye(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new WL,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await t.onListen(s,!0);break;case 1:i.pa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=np(o,`Initialization of query '${pi(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.ya.push(e),e.Da(t.onlineState),i.pa&&e.va(i.pa)&&rp(t)}async function JL(n,e){const t=ye(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function QL(n,e){const t=ye(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.ya)a.va(s)&&(r=!0);o.pa=s}}r&&rp(t)}function YL(n,e,t){const r=ye(n),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(t);r.queries.delete(e)}function rp(n){n.ba.forEach(e=>{e.next()})}var kf,M_;(M_=kf||(kf={})).Ca="default",M_.Cache="cache";class XL{constructor(e,t,r){this.query=e,this.Fa=t,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ki(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),t=!0):this.Na(e,this.onlineState)&&(this.Ba(e),t=!0),this.xa=e,t}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let t=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),t=!0),t}Na(e,t){if(!e.fromCache||!this.Sa())return!0;const r=t!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const t=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ba(e){e=Ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==kf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e){this.key=e}}class nb{constructor(e){this.key=e}}class ZL{constructor(e,t){this.query=e,this.Ga=t,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=Se(),this.mutatedKeys=Se(),this.Ha=Tw(e),this.Ja=new xi(this.Ha)}get Ya(){return this.Ga}Za(e,t){const r=t?t.Xa:new x_,s=t?t.Ja:this.Ja;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const d=s.get(h),m=lu(this.query,f)?f:null,y=!!d&&this.mutatedKeys.has(d.key),_=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;d&&m?d.data.isEqual(m.data)?y!==_&&(r.track({type:3,doc:m}),E=!0):this.eu(d,m)||(r.track({type:2,doc:m}),E=!0,(l&&this.Ha(m,l)>0||c&&this.Ha(m,c)<0)&&(a=!0)):!d&&m?(r.track({type:0,doc:m}),E=!0):d&&!m&&(r.track({type:1,doc:d}),E=!0,(l||c)&&(a=!0)),E&&(m?(o=o.add(m),i=_?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ja:o,Xa:r,Cs:a,mutatedKeys:i}}eu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((h,f)=>function(m,y){const _=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Vt:E})}};return _(m)-_(y)}(h.type,f.type)||this.Ha(h.doc,f.doc)),this.tu(r),s=s!=null&&s;const a=t&&!s?this.nu():[],l=this.ja.size===0&&this.current&&!s?1:0,c=l!==this.za;return this.za=l,o.length!==0||c?{snapshot:new Ki(this.query,e.Ja,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:a}:{ru:a}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new x_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(t=>this.Ga=this.Ga.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ga=this.Ga.delete(t)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=Se(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const t=[];return e.forEach(r=>{this.ja.has(r)||t.push(new nb(r))}),this.ja.forEach(r=>{e.has(r)||t.push(new tb(r))}),t}su(e){this.Ga=e.$s,this.ja=Se();const t=this.Za(e.documents);return this.applyChanges(t,!0)}ou(){return Ki.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const sp="SyncEngine";class e4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class t4{constructor(e){this.key=e,this._u=!1}}class n4{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new Ys(a=>Ew(a),au),this.cu=new Map,this.lu=new Set,this.hu=new Ke(ae.comparator),this.Pu=new Map,this.Tu=new Kd,this.Iu={},this.Eu=new Map,this.du=Wi.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function r4(n,e,t=!0){const r=lb(n);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await rb(r,e,t,!0),s}async function s4(n,e){const t=lb(n);await rb(t,e,!0,!1)}async function rb(n,e,t,r){const s=await TL(n.localStore,Hn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await i4(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&Jw(n.remoteStore,s),a}async function i4(n,e,t,r,s){n.Ru=(f,d,m)=>async function(_,E,k,O){let D=E.view.Za(k);D.Cs&&(D=await I_(_.localStore,E.query,!1).then(({documents:A})=>E.view.Za(A,D)));const U=O&&O.targetChanges.get(E.targetId),X=O&&O.targetMismatches.get(E.targetId)!=null,Z=E.view.applyChanges(D,_.isPrimaryClient,U,X);return N_(_,E.targetId,Z.ru),Z.snapshot}(n,f,d,m);const i=await I_(n.localStore,e,!0),o=new ZL(e,i.$s),a=o.Za(i.documents),l=Oa.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);N_(n,t,c.ru);const h=new e4(e,t,o);return n.uu.set(e,h),n.cu.has(t)?n.cu.get(t).push(e):n.cu.set(t,[e]),c.snapshot}async function o4(n,e,t){const r=ye(n),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!au(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Af(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Yd(r.remoteStore,s.targetId),Rf(r,s.targetId)}).catch(Zi)):(Rf(r,s.targetId),await Af(r.localStore,s.targetId,!0))}async function a4(n,e){const t=ye(n),r=t.uu.get(e),s=t.cu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Yd(t.remoteStore,r.targetId))}async function l4(n,e,t){const r=m4(n);try{const s=await function(o,a){const l=ye(o),c=rt.now(),h=a.reduce((m,y)=>m.add(y.key),Se());let f,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=_r(),_=Se();return l.Bs.getEntries(m,h).next(E=>{y=E,y.forEach((k,O)=>{O.isValidDocument()||(_=_.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(E=>{f=E;const k=[];for(const O of a){const D=TV(O,f.get(O.key).overlayedDocument);D!=null&&k.push(new Xs(O.key,D,fw(D.value.mapValue),hr.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,k,a)}).next(E=>{d=E;const k=E.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(m,E.batchId,k)})}).then(()=>({batchId:d.batchId,changes:bw(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Iu[o.currentUser.toKey()];c||(c=new Ke(we)),c=c.insert(a,l),o.Iu[o.currentUser.toKey()]=c}(r,s.batchId,t),await Da(r,s.changes),await pu(r.remoteStore)}catch(s){const i=np(s,"Failed to persist write");t.reject(i)}}async function sb(n,e){const t=ye(n);try{const r=await _L(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Pu.get(i);o&&(Ne(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?Ne(o._u,14607):s.removedDocuments.size>0&&(Ne(o._u,42227),o._u=!1))}),await Da(t,r,e)}catch(r){await Zi(r)}}function O_(n,e,t){const r=ye(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.uu.forEach((i,o)=>{const a=o.view.Da(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ye(o);l.onlineState=a;let c=!1;l.queries.forEach((h,f)=>{for(const d of f.ya)d.Da(a)&&(c=!0)}),c&&rp(l)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function c4(n,e,t){const r=ye(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new Ke(ae.comparator);o=o.insert(i,Rt.newNoDocument(i,me.min()));const a=Se().add(i),l=new hu(me.min(),new Map,new Ke(we),o,a);await sb(r,l),r.hu=r.hu.remove(i),r.Pu.delete(e),ip(r)}else await Af(r.localStore,e,!1).then(()=>Rf(r,e,t)).catch(Zi)}async function u4(n,e){const t=ye(n),r=e.batch.batchId;try{const s=await yL(t.localStore,e);ob(t,r,null),ib(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Da(t,s)}catch(s){await Zi(s)}}async function h4(n,e,t){const r=ye(n);try{const s=await function(o,a){const l=ye(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Ne(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,e);ob(r,e,t),ib(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Da(r,s)}catch(s){await Zi(s)}}function ib(n,e){(n.Eu.get(e)||[]).forEach(t=>{t.resolve()}),n.Eu.delete(e)}function ob(n,e,t){const r=ye(n);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function Rf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.cu.get(e))n.uu.delete(r),t&&n.au.Vu(r,t);n.cu.delete(e),n.isPrimaryClient&&n.Tu.Hr(e).forEach(r=>{n.Tu.containsKey(r)||ab(n,r)})}function ab(n,e){n.lu.delete(e.path.canonicalString());const t=n.hu.get(e);t!==null&&(Yd(n.remoteStore,t),n.hu=n.hu.remove(e),n.Pu.delete(t),ip(n))}function N_(n,e,t){for(const r of t)r instanceof tb?(n.Tu.addReference(r.key,e),f4(n,r)):r instanceof nb?(te(sp,"Document no longer in limbo: "+r.key),n.Tu.removeReference(r.key,e),n.Tu.containsKey(r.key)||ab(n,r.key)):ue(19791,{mu:r})}function f4(n,e){const t=e.key,r=t.path.canonicalString();n.hu.get(t)||n.lu.has(r)||(te(sp,"New document in limbo: "+t),n.lu.add(r),ip(n))}function ip(n){for(;n.lu.size>0&&n.hu.size<n.maxConcurrentLimboResolutions;){const e=n.lu.values().next().value;n.lu.delete(e);const t=new ae($e.fromString(e)),r=n.du.next();n.Pu.set(r,new t4(t)),n.hu=n.hu.insert(t,r),Jw(n.remoteStore,new zr(Hn(zd(t.path)),r,"TargetPurposeLimboResolution",su.le))}}async function Da(n,e,t){const r=ye(n),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((a,l)=>{o.push(r.Ru(l,e,t).then(c=>{var h;if((c||t)&&r.isPrimaryClient){const f=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=Jd.Rs(l.targetId,c);i.push(f)}}))}),await Promise.all(o),r.au.j_(s),await async function(l,c){const h=ye(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>B.forEach(c,d=>B.forEach(d.ds,m=>h.persistence.referenceDelegate.addReference(f,d.targetId,m)).next(()=>B.forEach(d.As,m=>h.persistence.referenceDelegate.removeReference(f,d.targetId,m)))))}catch(f){if(!eo(f))throw f;te(Qd,"Failed to update sequence numbers: "+f)}for(const f of c){const d=f.targetId;if(!f.fromCache){const m=h.xs.get(d),y=m.snapshotVersion,_=m.withLastLimboFreeSnapshotVersion(y);h.xs=h.xs.insert(d,_)}}}(r.localStore,i))}async function d4(n,e){const t=ye(n);if(!t.currentUser.isEqual(e)){te(sp,"User change. New user:",e.toKey());const r=await qw(t.localStore,e);t.currentUser=e,function(i,o){i.Eu.forEach(a=>{a.forEach(l=>{l.reject(new ne(z.CANCELLED,o))})}),i.Eu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Da(t,r.ks)}}function p4(n,e){const t=ye(n),r=t.Pu.get(e);if(r&&r._u)return Se().add(r.key);{let s=Se();const i=t.cu.get(e);if(!i)return s;for(const o of i){const a=t.uu.get(o);s=s.unionWith(a.view.Ya)}return s}}function lb(n){const e=ye(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=sb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=c4.bind(null,e),e.au.j_=QL.bind(null,e.eventManager),e.au.Vu=YL.bind(null,e.eventManager),e}function m4(n){const e=ye(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=u4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=h4.bind(null,e),e}class _c{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fu(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,t){return null}bu(e,t){return null}wu(e){return gL(this.persistence,new dL,e.initialUser,this.serializer)}yu(e){return new Hw(Gd.fi,this.serializer)}pu(e){return new bL}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_c.provider={build:()=>new _c};class g4 extends _c{constructor(e){super(),this.cacheSizeBytes=e}Su(e,t){Ne(this.persistence.referenceDelegate instanceof gc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new XV(r,e.asyncQueue,t)}yu(e){const t=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new Hw(r=>gc.fi(r,t),this.serializer)}}class xf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>O_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=d4.bind(null,this.syncEngine),await qL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new KL}()}createDatastore(e){const t=fu(e.databaseInfo.databaseId),r=function(i){return new kL(i)}(e.databaseInfo);return function(i,o,a,l){return new ML(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new NL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>O_(this.syncEngine,t,0),function(){return C_.C()?new C_:new IL}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,h){const f=new n4(s,i,o,a,l,c);return h&&(f.Au=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=ye(s);te(Ks,"RemoteStore shutting down."),i.Ta.add(5),await Na(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}xf.provider={build:()=>new xf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):yr("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds="FirestoreClient";class _4{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ct.UNAUTHENTICATED,this.clientId=nw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{te(ds,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(te(ds,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=np(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function wh(n,e){n.asyncQueue.verifyOperationInProgress(),te(ds,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await qw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function D_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await v4(n);te(ds,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>R_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>R_(e.remoteStore,s)),n._onlineComponents=e}async function v4(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){te(ds,"Using user provided OfflineComponentProvider");try{await wh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;zi("Error using user provided cache. Falling back to memory cache: "+t),await wh(n,new _c)}}else te(ds,"Using default OfflineComponentProvider"),await wh(n,new g4(void 0));return n._offlineComponents}async function cb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(te(ds,"Using user provided OnlineComponentProvider"),await D_(n,n._uninitializedComponentsProvider._online)):(te(ds,"Using default OnlineComponentProvider"),await D_(n,new xf))),n._onlineComponents}function E4(n){return cb(n).then(e=>e.syncEngine)}async function V_(n){const e=await cb(n),t=e.eventManager;return t.onListen=r4.bind(null,e.syncEngine),t.onUnlisten=o4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=s4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=a4.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(n,e,t){if(!t)throw new ne(z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function T4(n,e,t,r){if(e===!0&&r===!0)throw new ne(z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function F_(n){if(!ae.isDocumentKey(n))throw new ne(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function B_(n){if(ae.isDocumentKey(n))throw new ne(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function mu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ue(12329,{type:typeof n})}function Ko(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ne(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=mu(n);throw new ne(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb="firestore.googleapis.com",U_=!0;class $_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ne(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fb,this.ssl=U_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:U_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QV)throw new ne(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}T4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ub((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ne(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ne(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ne(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gu{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new C2;switch(r.type){case"firstParty":return new P2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=L_.get(t);r&&(te("ComponentProvider","Removing Datastore"),L_.delete(t),r.terminate())}(this),Promise.resolve()}}function w4(n,e,t,r={}){var s;n=Ko(n,gu);const i=Aa(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;i&&(oT(`https://${l}`),aT("Firestore",!0)),o.host!==fb&&o.host!==l&&zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:i,emulatorOptions:r});if(!js(c,a)&&(n._setSettings(c),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Ct.MOCK_USER;else{h=XM(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ne(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ct(d)}n._authCredentials=new k2(new ew(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ei(this.firestore,e,this._query)}}class ln{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ts(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ln(this.firestore,e,this._key)}}class ts extends ei{constructor(e,t,r){super(e,t,zd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ln(this.firestore,null,new ae(e))}withConverter(e){return new ts(this.firestore,e,this._path)}}function db(n,e,...t){if(n=Ht(n),hb("collection","path",e),n instanceof gu){const r=$e.fromString(e,...t);return B_(r),new ts(n,null,r)}{if(!(n instanceof ln||n instanceof ts))throw new ne(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child($e.fromString(e,...t));return B_(r),new ts(n.firestore,null,r)}}function b4(n,e,...t){if(n=Ht(n),arguments.length===1&&(e=nw.newId()),hb("doc","path",e),n instanceof gu){const r=$e.fromString(e,...t);return F_(r),new ln(n,null,new ae(r))}{if(!(n instanceof ln||n instanceof ts))throw new ne(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child($e.fromString(e,...t));return F_(r),new ln(n.firestore,n instanceof ts?n.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_="AsyncQueue";class j_{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new Kw(this,"async_queue_retry"),this.ec=()=>{const r=Th();r&&te(z_,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const t=Th();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const t=Th();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const t=new Fs;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!eo(e))throw e;te(z_,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const t=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,yr("INTERNAL UNHANDLED ERROR: ",H_(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=t,t}enqueueAfterDelay(e,t,r){this.nc(),this.Xu.indexOf(e)>-1&&(t=0);const s=tp.createAndSchedule(this,e,t,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&ue(47125,{_c:H_(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const t of this.Hu)if(t.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Hu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const t=this.Hu.indexOf(e);this.Hu.splice(t,1)}}function H_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class vc extends gu{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new j_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new j_(e),this._firestoreClient=void 0,await e}}}function I4(n,e){const t=typeof n=="object"?n:hT(),r=typeof n=="string"?n:uc,s=Cd(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=QM("firestore");i&&w4(s,...i)}return s}function pb(n){if(n._terminated)throw new ne(z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||S4(n),n._firestoreClient}function S4(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,h){return new W2(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,ub(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new _4(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gi(Et.fromBase64String(e))}catch(t){throw new ne(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gi(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ne(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ne(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ne(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4=/^__.*__$/;class C4{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Xs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ma(e,this.data,t,this.fieldTransforms)}}function gb(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{hc:n})}}class cp{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new cp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return Ec(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(gb(this.hc)&&A4.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class k4{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||fu(e)}gc(e,t,r,s=!1){return new cp({hc:e,methodName:t,fc:r,path:vt.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yb(n){const e=n._freezeSettings(),t=fu(n._databaseId);return new k4(n._databaseId,!!e.ignoreUndefinedProperties,t)}function R4(n,e,t,r,s,i={}){const o=n.gc(i.merge||i.mergeFields?2:0,e,t,s);Eb("Data must be an object, but it was:",o,r);const a=_b(r,o);let l,c;if(i.merge)l=new Sn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const d=P4(e,f,t);if(!o.contains(d))throw new ne(z.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);O4(h,d)||h.push(d)}l=new Sn(h),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new C4(new mn(a),l,c)}function x4(n,e,t,r=!1){return up(t,n.gc(r?4:3,e))}function up(n,e){if(vb(n=Ht(n)))return Eb("Unsupported field value:",e,n),_b(n,e);if(n instanceof mb)return function(r,s){if(!gb(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=up(a,s.Rc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Ht(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return mV(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=rt.fromDate(r);return{timestampValue:mc(s.serializer,i)}}if(r instanceof rt){const i=new rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mc(s.serializer,i)}}if(r instanceof ap)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gi)return{bytesValue:Vw(s.serializer,r._byteString)};if(r instanceof ln){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Wd(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof lp)return function(o,a){return{mapValue:{fields:{[uw]:{stringValue:hw},[hc]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Vc("VectorValues must only contain numeric values.");return jd(a.serializer,c)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${mu(r)}`)}(n,e)}function _b(n,e){const t={};return sw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qs(n,(r,s)=>{const i=up(s,e.Ic(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function vb(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof rt||n instanceof ap||n instanceof Gi||n instanceof ln||n instanceof mb||n instanceof lp)}function Eb(n,e,t){if(!vb(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=mu(t);throw r==="an object"?e.Vc(n+" a custom object"):e.Vc(n+" "+r)}}function P4(n,e,t){if((e=Ht(e))instanceof op)return e._internalPath;if(typeof e=="string")return Tb(n,e);throw Ec("Field path arguments must be of type string or ",n,!1,void 0,t)}const M4=new RegExp("[~\\*/\\[\\]]");function Tb(n,e,t){if(e.search(M4)>=0)throw Ec(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new op(...e.split("."))._internalPath}catch{throw Ec(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ec(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new ne(z.INVALID_ARGUMENT,a+n+l)}function O4(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ln(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new N4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class N4 extends wb{data(){return super.data()}}function hp(n,e){return typeof e=="string"?Tb(n,e):e instanceof op?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ne(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fp{}class bb extends fp{}function V4(n,e,...t){let r=[];e instanceof fp&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof pp).length,a=i.filter(l=>l instanceof dp).length;if(o>1||o>0&&a>0)throw new ne(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class dp extends bb{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new dp(e,t,r)}_apply(e){const t=this._parse(e);return Ib(e._query,t),new ei(e.firestore,e.converter,Ef(e._query,t))}_parse(e){const t=yb(e.firestore);return function(i,o,a,l,c,h,f){let d;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ne(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){K_(f,h);const y=[];for(const _ of f)y.push(W_(l,i,_));d={arrayValue:{values:y}}}else d=W_(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||K_(f,h),d=x4(a,o,f,h==="in"||h==="not-in");return Ze.create(c,h,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class pp extends fp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pp(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Pn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)Ib(o,l),o=Ef(o,l)}(e._query,t),new ei(e.firestore,e.converter,Ef(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mp extends bb{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mp(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new ne(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ne(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ga(i,o)}(e._query,this._field,this._direction);return new ei(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new to(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function L4(n,e="asc"){const t=e,r=hp("orderBy",n);return mp._create(r,t)}function W_(n,e,t){if(typeof(t=Ht(t))=="string"){if(t==="")throw new ne(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vw(e)&&t.indexOf("/")!==-1)throw new ne(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child($e.fromString(t));if(!ae.isDocumentKey(r))throw new ne(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return i_(n,new ae(r))}if(t instanceof ln)return i_(n,t._key);throw new ne(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mu(t)}.`)}function K_(n,e){if(!Array.isArray(n)||n.length===0)throw new ne(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ib(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ne(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ne(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class F4{convertValue(e,t="none"){switch(hs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Qs(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[hc].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Qe(o.doubleValue));return new lp(i)}convertGeoPoint(e){return new ap(Qe(e.latitude),Qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ou(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(da(e));default:return null}}convertTimestamp(e){const t=cs(e);return new rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=$e.fromString(e);Ne(zw(r),9688,{name:e});const s=new pa(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(t)||yr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(n,e,t){let r;return r=n?n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Sb extends wb{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ml(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(hp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Ml extends Sb{data(e={}){return super.data(e)}}class U4{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new ko(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ml(this._firestore,this._userDataWriter,r.key,r,new ko(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ne(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Ml(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ko(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Ml(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ko(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:$4(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function $4(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:n})}}class Ab extends F4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ln(this.firestore,null,t)}}function z4(n,e){const t=Ko(n.firestore,vc),r=b4(n),s=B4(n.converter,e);return H4(t,[R4(yb(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,hr.exists(!1))]).then(()=>r)}function j4(n,...e){var t,r,s;n=Ht(n);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||q_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(q_(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,h;if(n instanceof ln)c=Ko(n.firestore,vc),h=zd(n._key.path),l={next:f=>{e[o]&&e[o](q4(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Ko(n,ei);c=Ko(f.firestore,vc),h=f._query;const d=new Ab(c);l={next:m=>{e[o]&&e[o](new U4(c,d,f,m))},error:e[o+1],complete:e[o+2]},D4(n._query)}return function(d,m,y,_){const E=new y4(_),k=new XL(m,E,y);return d.asyncQueue.enqueueAndForget(async()=>GL(await V_(d),k)),()=>{E.Cu(),d.asyncQueue.enqueueAndForget(async()=>JL(await V_(d),k))}}(pb(c),h,a,l)}function H4(n,e){return function(r,s){const i=new Fs;return r.asyncQueue.enqueueAndForget(async()=>l4(await E4(r),s,i)),i.promise}(pb(n),e)}function q4(n,e,t){const r=t.docs.get(e._key),s=new Ab(n);return new Sb(n,s,e._key,r,new ko(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Xi=s})(Qi),$i(new Hs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new vc(new R2(r.getProvider("auth-internal")),new M2(o,r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ne(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pa(c.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Xr(Ky,Gy,e),Xr(Ky,Gy,"esm2017")})();const W4={apiKey:"AIzaSyDWJDMyP6_D179wtsKuHFEjAwoxJSvAfpA",authDomain:"shout-01433.firebaseapp.com",projectId:"shout-01433",storageBucket:"shout-01433.firebasestorage.app",messagingSenderId:"20457265330",appId:"1:20457265330:web:80e9afd476768bc71d11ab",measurementId:"G-5S6Z0C32DV"},Cb=uT(W4),kb=I4(Cb),va=S2(Cb),Rb=Qt(null);dD(va,n=>{Rb.value=n});function gp(){return{currentUser:Rb,signInAnonymously:()=>DT(va),logout:()=>pD(va)}}const K4={class:"shout-add-form"},G4={__name:"Add",setup(n){const{currentUser:e,signInAnonymously:t}=gp(),r=fv(),s=Qt(!1),i=Qt("");Oc(async()=>{if(!e.value){s.value=!0;try{await t()}catch(h){i.value=h.message.replace("Firebase: ","")}finally{s.value=!1}}});const o=Qt(""),a=()=>{r.back()};function l(){o.value.trim()&&(c(o.value.trim()),o.value="",a())}function c(h){e.value&&z4(db(kb,"shouts"),{text:h,timestamp:new Date,userId:e.value.uid})}return(h,f)=>(De(),ze("section",null,[fe("div",K4,[We($M,{modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=d=>o.value=d)},null,8,["modelValue"]),fe("div",{class:"footer"},[fe("button",{type:"button",onClick:a,class:"button-secondary"},f[1]||(f[1]=[fe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},[fe("path",{fill:"currentColor",d:"M16 3C8.832 3 3 8.832 3 16s5.832 13 13 13s13-5.832 13-13S23.168 3 16 3m0 2c6.087 0 11 4.913 11 11s-4.913 11-11 11S5 22.087 5 16S9.913 5 16 5m-3.78 5.78l-1.44 1.44L14.564 16l-3.782 3.78l1.44 1.44L16 17.437l3.78 3.78l1.44-1.437L17.437 16l3.78-3.78l-1.437-1.44L16 14.564l-3.78-3.782z"})],-1),kn(" Cancel ")])),fe("button",{onClick:l,class:"button-primary"},f[2]||(f[2]=[fe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[fe("path",{fill:"currentColor",d:"M3 20v-6l8-2l-8-2V4l19 8z"})],-1),kn(" Send ")]))])])]))}},J4={key:0},Q4={key:1},Y4={type:"submit"},X4={key:2,style:{color:"red"}},Z4={__name:"AuthPage",setup(n){const{register:e,login:t}=gp(),r=fv(),s=dv(),i=Qt(""),o=Qt(""),a=Qt(!1),l=Qt(""),c=async()=>{l.value="";try{a.value?await e(i.value,o.value):await t(i.value,o.value);const h=s.query.returnUrl||"/";r.replace(h)}catch(h){l.value=h.message.replace("Firebase: ","")}};return(h,f)=>(De(),ze("form",{onSubmit:Bm(c,["prevent"]),style:{"max-width":"300px",margin:"30px auto"}},[a.value?(De(),ze("h2",J4,"Register")):(De(),ze("h2",Q4,"Login")),fe("div",null,[fm(fe("input",{"onUpdate:modelValue":f[0]||(f[0]=d=>i.value=d),type:"email",required:"",placeholder:"Email"},null,512),[[Fm,i.value]])]),fe("div",null,[fm(fe("input",{"onUpdate:modelValue":f[1]||(f[1]=d=>o.value=d),type:"password",required:"",placeholder:"Password"},null,512),[[Fm,o.value]])]),fe("div",null,[fe("button",Y4,Hr(a.value?"Register":"Login"),1)]),l.value?(De(),ze("div",X4,Hr(l.value),1)):Q0("",!0),fe("div",null,[fe("small",null,[fe("a",{href:"#",onClick:f[2]||(f[2]=Bm(d=>a.value=!a.value,["prevent"]))},Hr(a.value?"Already have an account? Login.":"No account? Register"),1)])])],32))}};var eF=["second","minute","hour","day","week","month","year"];function tF(n,e){if(e===0)return["just now","right now"];var t=eF[Math.floor(e/2)];return n>1&&(t+="s"),[n+" "+t+" ago","in "+n+" "+t]}var nF=["","","","","","",""];function rF(n,e){if(e===0)return["",""];var t=nF[~~(e/2)];return[n+" "+t+"",n+" "+t+""]}var Pf={},xb=function(n,e){Pf[n]=e},sF=function(n){return Pf[n]||Pf.en_US},bh=[60,60,24,7,365/7/12,12];function G_(n){return n instanceof Date?n:!isNaN(n)||/^\d+$/.test(n)?new Date(parseInt(n)):(n=(n||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(n))}function iF(n,e){var t=n<0?1:0;n=Math.abs(n);for(var r=n,s=0;n>=bh[s]&&s<bh.length;s++)n/=bh[s];return n=Math.floor(n),s*=2,n>(s===0?9:1)&&(s+=1),e(n,s,r)[t].replace("%s",n.toString())}function oF(n,e){var t=e?G_(e):new Date;return(+t-+G_(n))/1e3}var aF=function(n,e,t){var r=oF(n,t&&t.relativeDate);return iF(r,sF(e))};xb("en_US",tF);xb("zh_CN",rF);const lF={},cF={class:"loader"};function uF(n,e){return De(),ze("div",cF)}const hF=Mn(lF,[["render",uF]]),fF={key:1,class:"masonry"},dF={class:"card"},pF={class:"head"},mF=["innerHTML"],gF={__name:"HomePage",setup(n){const e=dv(),t=Qt(!1),r=Qt([]),s=async()=>{t.value=!0;const i=V4(db(kb,"shouts"),L4("timestamp","desc"));j4(i,o=>{r.value=o.docs.map(a=>({id:a.id,...a.data()})),t.value=!1})};return Oc(s),No(()=>e.fullPath,s),(i,o)=>{const a=Ta("router-link");return De(),ze(Gt,null,[t.value?(De(),Jf(hF,{key:0})):(De(),ze("div",fF,[(De(!0),ze(Gt,null,Rh(r.value,l=>(De(),ze("div",{key:l.id,class:"masonry-item"},[fe("div",dF,[fe("div",pF,[kn(Hr(l.user)+" ",1),fe("span",null,Hr($n(aF)(new Date(l.timestamp.seconds*1e3))),1)]),fe("div",{innerHTML:l.text},null,8,mF)])]))),128))])),We(a,{to:"/add"},{default:Pi(()=>o[0]||(o[0]=[fe("button",{class:"button-primary shout-add-btn"},[fe("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 1024 1024"},[fe("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})])],-1)])),_:1,__:[0]})],64)}}},yF=Mn(gF,[["__scopeId","data-v-c6fc8400"]]),_F={};function vF(n,e){return De(),ze("section",null,e[0]||(e[0]=[fe("h2",null,"Privacy Policy",-1),fe("p",null,"Privacy Policy content goes here...",-1)]))}const EF=Mn(_F,[["render",vF]]),TF={};function wF(n,e){return De(),ze("section",null,e[0]||(e[0]=[fe("h2",null,"Terms and Conditions",-1),fe("p",null,"Terms and Conditions content goes here...",-1)]))}const bF=Mn(TF,[["render",wF]]),IF={class:"container"},SF={key:0,class:"identity"},AF={class:"signin"},CF=["disabled"],kF=["disabled"],RF=Pc({__name:"UserPage",setup(n){const{currentUser:e}=gp();console.log(e.value);const t=Jt(()=>{var l;return(l=e.value)==null?void 0:l.uid}),r=Jt(()=>{var l;return((l=t.value)==null?void 0:l.slice(-4))??""}),s=Qt(!1),i=Qt(!1),o=async()=>{s.value=!0;try{const l=await DT(va);s.value=!1}catch(l){console.error("Anonymous sign-in error:",l),alert("Failed to sign in: "+l.message)}},a=async()=>{i.value=!0;try{await va.signOut(),i.value=!1}catch(l){console.error("Sign-out error:",l),alert("Failed to sign out: "+l.message)}};return(l,c)=>(De(),ze("section",IF,[c[1]||(c[1]=fe("h2",null,"About you",-1)),t.value?(De(),ze("div",SF,[kn(" Guest "+Hr(r.value),1),c[0]||(c[0]=fe("br",null,null,-1)),kn("ID: "+Hr(t.value),1)])):Q0("",!0),c[2]||(c[2]=fe("p",{class:"desc"}," Youre an anonymous user created by Firebase Authentication. When you first opened the app, Firebase gave you a unique, private IDno email or password needed. This lets the app save your progress without knowing who you are. Later, if you decide to sign up using email and password (which Ive enabled), your anonymous account can be upgraded and linked to your new identityso none of your data is lost. Your privacy stays intact the whole time; nothing personal is shared until you choose to provide it. Just remember, if you uninstall before signing up, your anonymous data might be lost. ",-1)),fe("div",AF,[t.value?(De(),ze("button",{key:1,onClick:a,class:"btn ml-2",disabled:i.value}," Sign out ",8,kF)):(De(),ze("button",{key:0,onClick:o,class:"button-primary",disabled:s.value}," Sign in as Guest ",8,CF))])]))}}),xF=Mn(RF,[["__scopeId","data-v-83d413a0"]]),PF=[{path:"/",component:NA,children:[{path:"",name:"home",component:yF},{path:"about",name:"about",component:LA},{path:"add",name:"add",component:G4},{path:"auth",name:"auth",component:Z4},{path:"terms",name:"terms",component:bF},{path:"privacy",name:"privacy",component:EF},{path:"user",name:"UserPage",component:xF}]}],MF=SA({history:eA("/"),routes:PF}),Pb=_S(bS);Pb.use(MF);Pb.mount("#app");
